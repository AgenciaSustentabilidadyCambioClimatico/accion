:javascript
	$(document).ready(function(){

		$(".disabled *").prop('disabled',true);
		//Habilita el desplegar los mapa dentro de contexto sector.
		$(".fa").prop('disabled',false);
		observacion_obligatoria();
		htmlErrorToTooltip('top');
		$('#manifestacion_de_interes_resultado_admisibilidad').change( function(){observacion_obligatoria()});

		function observacion_obligatoria(){
			resultado = $('#manifestacion_de_interes_resultado_admisibilidad').val()
			if(resultado=="rechazado" || resultado=="en_observación"){
				$('label[for="manifestacion_de_interes_observaciones_admisibilidad"] > abbr').show();
				$('#manifestacion_de_interes_observaciones_admisibilidad').addClass('required');
				
			}else{
				$('label[for="manifestacion_de_interes_observaciones_admisibilidad"] > abbr').hide();
				$('#manifestacion_de_interes_observaciones_admisibilidad').removeClass('required border-error').removeAttr('data-original-title');
			}
		}
		
	});

- formulario_remote = true #flag para mostrar/ocultar el botón de guardado
- titulo t(:revisar_admisibilidad)
- tabs = { "tipo-de-acuerdo": false, "datos-institucion": false, "contexto-sector": false, "datos-proyecto": false, "objetivo-acuerdo": false, "admisibilidad": true }
#tab-menu-controls.mb-0.mt-3{:role => "tabpanel"}
	%ul#manifestacion.nav.nav-tabs{:role => "tablist"}
		- tabs.each do |tab,active|
			%li.nav-item
				%a.nav-link{id: "#{tab}-tab", class: (:active if active), "aria-controls" => tab, "aria-expanded" => "true", "data-toggle" => "tab", :href => "##{tab}", :role => "tab"}
					=t(tab.to_s.gsub('-','_'))
				- if !@total_de_errores_por_tab.blank? && @total_de_errores_por_tab.has_key?(tab) && @total_de_errores_por_tab[tab].size > 0
					%small.total-error
						= @total_de_errores_por_tab[tab].size 
		- if @manifestacion_de_interes.errors.messages.size < 1
			- formulario_remote = false
= simple_form_for @manifestacion_de_interes, url: admisibilidad_manifestacion_de_interes_path(@tarea_pendiente), method: :patch, remote: false, html: { autocomplete: :off, multipart: true } do |f|
	= f.hidden_field :temporal, as: :boolean, value: formulario_remote
	= f.input :current_tab, as: :hidden, wrapper: false, input_html: { value: (f.object.current_tab.blank? ? 'tipo-de-acuerdo-tab' : f.object.current_tab) }
	= f.submit "", class: 'd-none'
	=# f.input :temporal, as: :hidden, wrapper: false, input_html: { value: true }
	= f.input :update_admisibilidad, as: :hidden, wrapper: false, input_html: { value: true }
	= render "form_manifestacion_de_interes", tabs: tabs, f: f do
		#admisibilidad.tab-pane.fade{"aria-expanded" => (tabs[:"admisibilidad"] ? 'true' : 'false'), "aria-labelledby" => "admisibilidad-tab", :role => "tabpanel", class: ("show active" if tabs[:"admisibilidad"])}
			.card
				.card-body
					.row
						.col-12.col-lg-6
							= f.label t(:observaciones)
							%br
							-if @manifestacion_de_interes.tipo_instrumento_id == 6
								- checks = tabs.map{|l,v| l.to_s != "admisibilidad" ? [I18n.t(l.to_s.gsub('-','_')), l.to_s] : nil}.compact
							-else
								- checks = tabs.map{|l,v| (l.to_s == "datos-proyecto" || l.to_s == "admisibilidad") ? nil : [I18n.t(l.to_s.gsub('-','_')), l.to_s]}.compact
							= f.collection_check_boxes :secciones_observadas_admisibilidad, checks, :last, :first, item_wrapper_tag: false, boolean_style: :inline, checked: @manifestacion_de_interes.secciones_observadas_admisibilidad do |cb|
								= cb.check_box 
								= cb.label
								%br
						.col-12.col-lg-6
							= f.input :respuesta_observaciones_admisibilidad, as: :text, input_html: {rows: 7}, disabled: true
						.col-12.col-lg-6.offset-lg-6
							= label_tag 'Archivo admisibilidad', nil, class: 'string mb-0'
							-#
								= __descargar_archivo(f.object.archivo_admisibilidad,:archivo_admisibilidad, false)
							= __descargar_archivo(f.object.archivo_admisibilidad, f.object, false)
						.col-12.col-lg-6
							= f.input :resultado_admisibilidad, collection: ManifestacionDeInteres.resultado_admisibilidades.keys.map { |w| [w.humanize, w] }, required: true, label: t(:resultado_admisibilidad)
						.col-12.col-lg-6
							= f.input :comentario_jefe_de_linea, as: :text, input_html: {rows: 3}, label: t(:comentario_jefe_de_línea), disabled: true
						.col-12
							= f.input :observaciones_admisibilidad, as: :text, input_html: {rows: 5}, required: true, label: t(:observaciones_y_comentarios)

	.float-right
		= link_to t(:back), root_path, class: 'btn btn-sm btn-warning ml-1'
		= button_tag t(:save), 'data-disable-with' => "<i class='fa fa-spinner fa-spin'></i> Guardando...".html_safe, class: "btn btn-sm btn-primary"