- todos = todos.nil? ? false : todos
:javascript
  $(document).ready(function() {
    $('table.acuerdos-pendientes').DataTable({
      order: [[5, 'asc']],
      responsive: true,
      lengthMenu: [[30], [30]],
      columnDefs: [ { targets: [-1], orderable: false } ],
      language: {
        url: "#{asset_path('spanish.json')}"
      },
      "defaultContent": "",
    });
  });
- tiene_proyectos = ((pendientes.size == 0) ? false : ((pendientes.map{|p|p unless p.flujo.proyecto_id}.compact.size == 0) ? false : true ) )
- tiene_acuerdos = ((pendientes.size == 0) ? false : ((pendientes.map{|p|p unless p.flujo.manifestacion_de_interes_id.blank?}.compact.size == 0) ? false : true ) )
- tiene_programas = ((pendientes.size == 0) ? false : ((pendientes.map{|p|p unless p.flujo.programa_proyecto_propuesta_id.blank?}.compact.size == 0) ? false : true ) )
.card
  .card-header
    %h5.no-margin
      = titulo
  .card-body
    %table.table.table-striped.acuerdos-pendientes
      %thead
        %tr
          %th=t(:flujo_id)
          - unless (Rails.env.production? && !current_user.is_admin?) #DZC 2018-10-05 11:49:52 solo muestra el id de tarea pendiente si se trata del administrador o el proyecto esta en ambiente de desarrollo
            %th=t(:tarea_pendiente_id)
          %th=t(:acuerdo_o_proyecto_o_programa)
          %th=t(:tipo_instrumento)
          %th=t(:subtipo)
          %th=t(:tarea)
          %th.dos.iconos-acciones=t(:acciones)
      %tbody
        - unless pendientes.size == 0
          - pendientes.each do |pendiente|
            - tarea = pendiente.tarea
            - flujo = pendiente.flujo
            - encuesta = tarea.encuesta
            - proyecto = pendiente.flujo.proyecto
            - acuerdo = pendiente.flujo.manifestacion_de_interes
            - programa = pendiente.flujo.ppp
            - convocatoria = pendiente.es_minuta? ? pendiente.determina_convocatoria : nil
            - tipo_instrumento = flujo.tipo_instrumento.nombre_tipo
            - subtipo_instrumento = flujo.subtipo_de_instrumento
            %tr
              %td=flujo.id
              - unless (Rails.env.production? && !current_user.is_admin?) #DZC 2018-10-05 11:49:52 solo muestra el id de tarea pendiente si se trata del administrador o el proyecto esta en ambiente de desarrollo
                %td=pendiente.id
              %td=flujo.nombre_instrumento
              %td=tipo_instrumento
              %td=subtipo_instrumento              
              %td
                -tarea_nombre = tarea.nombre
                -if pendiente.es_minuta?
                  - unless pendiente.determina_convocatoria.blank?
                    -tarea_nombre += ' para convocatoria "' + pendiente.determina_convocatoria.nombre + '"'
                -elsif pendiente.es_auditoria?
                  - unless pendiente.determina_auditoria.blank? 
                    -tarea_nombre += ' correspondiente a "' + pendiente.determina_auditoria.nombre + '"'
                -elsif tarea.codigo == Tarea::COD_APL_021
                  - unless pendiente.determina_convocatoria.blank?
                    -tarea_nombre += ' correspondiente a "' + pendiente.determina_convocatoria.nombre.gsub('Firma de Acuerdo ','') + '"'                 
                -elsif tarea.codigo == Tarea::COD_APL_037
                  - unless pendiente.determina_convocatoria.blank?
                    -tarea_nombre += ' correspondiente a "' + pendiente.determina_convocatoria.nombre.gsub('Ceremonia de Certificación ','') + '"'
                =tarea_nombre
              %td.dos.iconos-acciones
                - if pendiente.es_convocatoria?
                  = link_to tarea_pendiente_convocatorias_path(pendiente) do #DZC Común para todas las convocatorias
                    %i.fa.fa-edit
                - elsif pendiente.es_minuta? && !pendiente.data.nil? #DZC Común para todas las minutas
                  - convocatoria = pendiente.determina_convocatoria
                  = link_to edit_tarea_pendiente_convocatoria_minuta_path(pendiente, convocatoria) do
                    %i.fa.fa-edit
                - elsif tarea.es_una_encuesta && !Tarea::COD_APL_019#DZC Común para todas las encuestas, salvo APL-019
                  = link_to responder_admin_encuesta_path(pendiente,encuesta) do
                    %i.fa.fa-edit


                - elsif tarea.codigo == Tarea::COD_APL_001
                  = link_to manifestacion_de_interes_path(pendiente), method: :post do
                    %i.fa.fa-edit
                - elsif tarea.codigo == Tarea::COD_APL_002
                  = link_to revisor_manifestacion_de_interes_path(pendiente, flujo.manifestacion_de_interes) do
                    %i.fa.fa-edit
                - elsif tarea.codigo == Tarea::COD_APL_003
                  = link_to admisibilidad_manifestacion_de_interes_path(pendiente, flujo.manifestacion_de_interes) do
                    %i.fa.fa-edit
                - elsif tarea.codigo == Tarea::COD_APL_004
                  = link_to observaciones_admisibilidad_manifestacion_de_interes_path(pendiente, flujo.manifestacion_de_interes) do
                    %i.fa.fa-edit     
                - elsif tarea.codigo == Tarea::COD_APL_005
                  = link_to pertinencia_factibilidad_manifestacion_de_interes_path(pendiente, flujo.manifestacion_de_interes) do
                    %i.fa.fa-edit
                - elsif tarea.codigo == Tarea::COD_APL_006
                  = link_to responder_pertinencia_factibilidad_manifestacion_de_interes_path(pendiente, flujo.manifestacion_de_interes) do
                    %i.fa.fa-edit
                - elsif tarea.codigo == Tarea::COD_APL_007
                  = link_to tarea_pendiente_hitos_de_prensa_path(pendiente) do
                    %i.fa.fa-edit   
                - elsif tarea.codigo == Tarea::COD_APL_008
                  = link_to usuario_entregables_manifestacion_de_interes_path(pendiente, flujo.manifestacion_de_interes) do
                    %i.fa.fa-edit
                - elsif tarea.codigo == Tarea::COD_APL_009
                  = link_to actualizacion_mapa_de_actores_manifestacion_de_interes_path(pendiente, flujo.manifestacion_de_interes) do
                    %i.fa.fa-edit
                - elsif tarea.codigo == Tarea::COD_APL_010
                  = link_to revision_mapa_de_actores_manifestacion_de_interes_path(pendiente, flujo.manifestacion_de_interes) do
                    %i.fa.fa-edit
                - elsif tarea.codigo == Tarea::COD_APL_013
                  = link_to cargar_actualizar_entregable_diagnostico_manifestacion_de_interes_path(pendiente, flujo.manifestacion_de_interes) do
                    %i.fa.fa-edit
                - elsif tarea.codigo == Tarea::COD_APL_014
                  = link_to revisar_entregable_diagnostico_manifestacion_de_interes_path(pendiente, flujo.manifestacion_de_interes) do
                    %i.fa.fa-edit
                - elsif tarea.codigo == Tarea::COD_APL_018
                  = link_to acuerdo_actores_manifestacion_de_interes_path(pendiente, flujo.manifestacion_de_interes) do
                    %i.fa.fa-edit
                - elsif tarea.codigo == Tarea::COD_APL_019 #DZC Encuesta y Set de metas y acciones
                  = link_to evaluacion_negociacion_manifestacion_de_interes_path(pendiente, flujo.manifestacion_de_interes, encuesta) do
                    %i.fa.fa-edit
                - elsif tarea.codigo == Tarea::COD_APL_020
                  = link_to actualizar_acuerdos_actores_manifestacion_de_interes_path(pendiente, flujo.manifestacion_de_interes) do
                    %i.fa.fa-edit
                - elsif tarea.codigo == Tarea::COD_APL_021
                  = link_to actores_convocatorias_manifestacion_de_interes_path(pendiente, flujo.manifestacion_de_interes) do
                    %i.fa.fa-edit
                - elsif tarea.codigo == Tarea::COD_APL_023
                  = link_to actualizar_comite_acuerdos_manifestacion_de_interes_path(pendiente, flujo.manifestacion_de_interes) do
                    %i.fa.fa-edit
                - elsif tarea.codigo == Tarea::COD_APL_024
                  = link_to usuarios_cargo_entregables_manifestacion_de_interes_path(pendiente) do
                    %i.fa.fa-edit 
                - elsif tarea.codigo == Tarea::COD_APL_025
                  = link_to actualizar_adhesion_path(pendiente) do
                    %i.fa.fa-edit           
                - elsif tarea.codigo == Tarea::COD_APL_028
                  = link_to revisar_adhesion_path(pendiente) do
                    %i.fa.fa-edit
                - elsif tarea.codigo == Tarea::COD_APL_029
                  = link_to dato_productivo_elemento_adheridos_path(pendiente) do
                    %i.fa.fa-edit
                - elsif tarea.codigo == Tarea::COD_APL_032
                  - unless flujo.adhesion_elementos.blank?
                    = link_to actualizar_auditorias_manifestacion_de_interes_path(pendiente, flujo.manifestacion_de_interes) do
                      %i.fa.fa-edit
                  - else
                    = link_to tarea_pendiente_auditoria_sin_elementos_adheridos_path(pendiente) do
                      %i.fa.fa-exclamation-triangle{'data-toggle'=>"tooltip", 'title'=>"APL sin elementos adheridos"}
                - elsif tarea.codigo == Tarea::COD_APL_033
                  = link_to revisar_auditorias_manifestacion_de_interes_path(pendiente, flujo.manifestacion_de_interes) do
                    %i.fa.fa-edit                   
                - elsif tarea.codigo == Tarea::COD_APL_034
                  = link_to validar_auditorias_manifestacion_de_interes_path(pendiente, flujo.manifestacion_de_interes) do
                    %i.fa.fa-edit                   
                - elsif tarea.codigo == Tarea::COD_APL_037
                  = link_to ceremonia_certificaciones_path(pendiente) do
                    %i.fa.fa-edit               
                - elsif tarea.codigo == Tarea::COD_APL_041
                  = link_to informe_impactos_path(pendiente) do
                    %i.fa.fa-edit
                - elsif tarea.codigo == Tarea::COD_APL_042
                  = link_to informe_impacto_revisar_manifestacion_de_interes_path(pendiente) do
                    %i.fa.fa-edit               

                - elsif ! encuesta.blank? 
                  = link_to responder_admin_encuesta_path(pendiente,encuesta) do
                    %i.fa.fa-book
                - elsif tarea.codigo == Tarea::COD_PPF_001
                  = link_to edit_ppf_tarea_pendiente_programa_proyecto_propuesta_path(pendiente,pendiente.flujo.ppp) do
                    %i.fa.fa-edit
                - elsif tarea.codigo == Tarea::COD_PPF_002
                  = link_to asignar_revisor_ppf_tarea_pendiente_programa_proyecto_propuesta_path(pendiente,pendiente.flujo.ppp) do
                    %i.fa.fa-edit               
                - elsif tarea.codigo == Tarea::COD_PPF_003
                  = link_to revision_ppf_tarea_pendiente_programa_proyecto_propuesta_path(pendiente,pendiente.flujo.ppp) do
                    %i.fa.fa-edit   
                - elsif tarea.codigo == Tarea::COD_PPF_004
                  = link_to resolver_observaciones_ppf_tarea_pendiente_programa_proyecto_propuesta_path(pendiente,pendiente.flujo.ppp) do
                    %i.fa.fa-edit 
                - elsif tarea.codigo == Tarea::COD_PPF_005
                  = link_to carta_de_apoyo_ppf_tarea_pendiente_programa_proyecto_propuesta_path(pendiente,pendiente.flujo.ppp) do
                    %i.fa.fa-edit
                - elsif tarea.codigo == Tarea::COD_PPF_006
                  = link_to seguimiento_a_terceros_ppf_tarea_pendiente_programa_proyecto_propuesta_path(pendiente,pendiente.flujo.ppp) do
                    %i.fa.fa-edit                       
                - elsif tarea.codigo == Tarea::COD_PPF_007
                  = link_to elaboracion_inicial_propuesta_ppf_tarea_pendiente_programa_proyecto_propuesta_path(pendiente,pendiente.flujo.ppp) do
                    %i.fa.fa-edit 
                - elsif tarea.codigo == Tarea::COD_PPF_008
                  = link_to observaciones_tecnicas_ppf_tarea_pendiente_programa_proyecto_propuesta_path(pendiente,pendiente.flujo.ppp) do
                    %i.fa.fa-edit 
                - elsif tarea.codigo == Tarea::COD_PPF_009
                  = link_to datos_postulacion_ppf_tarea_pendiente_programa_proyecto_propuesta_path(pendiente,pendiente.flujo.ppp) do
                    %i.fa.fa-edit 
                - elsif tarea.codigo == Tarea::COD_PPF_010
                  = link_to seguimiento_proyecto_ppf_tarea_pendiente_programa_proyecto_propuesta_path(pendiente,pendiente.flujo.ppp) do
                    %i.fa.fa-edit 
                - elsif tarea.codigo == Tarea::COD_PPF_011
                  = link_to asignar_usuarios_a_cargo_ejecucion_programa_ppf_tarea_pendiente_programa_proyecto_propuesta_path(pendiente,pendiente.flujo.ppp) do
                    %i.fa.fa-edit 
                - elsif tarea.codigo == Tarea::COD_PPF_012
                  = link_to datos_ejecucion_presupuestaria_anual_ppf_tarea_pendiente_programa_proyecto_propuesta_path(pendiente,pendiente.flujo.ppp) do
                    %i.fa.fa-edit 
                - elsif tarea.codigo == Tarea::COD_PPF_013
                  = link_to ppf_agenda_path(pendiente) do
                    %i.fa.fa-edit 
                - elsif tarea.codigo == Tarea::COD_PPF_016
                  = link_to actualizar_adhesion_path(pendiente) do
                    %i.fa.fa-edit 
                - elsif tarea.codigo == Tarea::COD_PPF_017
                  = link_to revisar_adhesion_path(pendiente) do
                    %i.fa.fa-edit 
                - elsif tarea.codigo == Tarea::COD_PPF_018
                  = link_to ppf_tarea_pendiente_set_metas_acciones_path(pendiente) do
                    %i.fa.fa-edit
                - elsif tarea.codigo == Tarea::COD_PPF_019
                  = link_to revision_ppf_tarea_pendiente_set_metas_acciones_path(pendiente) do
                    %i.fa.fa-edit
                - elsif tarea.codigo == Tarea::COD_PPF_020
                  = link_to dato_productivo_elemento_adheridos_path(pendiente) do
                    %i.fa.fa-edit
                - elsif tarea.codigo == Tarea::COD_PPF_021
                  = link_to ppf_tarea_pendiente_cargar_path(pendiente) do
                    %i.fa.fa-edit
                - elsif tarea.codigo == Tarea::COD_PPF_022
                  = link_to ppf_tarea_pendiente_aprobar_path(pendiente) do
                    %i.fa.fa-edit






                
                -# elsif pendiente.tarea_id == Tarea::ID_PPF_020
                  = link_to cargar_dato_productivo_tarea_pendiente_programa_proyecto_propuesta_path(pendiente) do
                    %i.fa.fa-edit


                - unless proyecto.blank?
                  - if pendiente.tarea_id == Tarea::ID_FPL_003
                    = link_to seguimiento_fpl_proyecto_documento_garantias_path(pendiente,proyecto) do
                      %i.fa.fa-file-text-o
                  - elsif pendiente.tarea_id == Tarea::ID_FPL_005
                    = link_to responsables_seguimiento_fpl_proyecto_path(pendiente,proyecto) do
                      %i.fa.fa-user-o 
                  - elsif pendiente.tarea_id == Tarea::ID_FPL_006
                    = link_to new_seguimiento_fpl_proyecto_reunion_path(pendiente,proyecto) do
                      %i.fa.fa-comments-o 
                  - elsif pendiente.tarea_id == Tarea::ID_FPL_007
                    = link_to calendario_seguimiento_fpl_proyecto_path(pendiente,proyecto) do
                      %i.fa.fa-calendar-o
                  - elsif pendiente.tarea_id == Tarea::ID_FPL_008
                    = link_to solicitud_pago_seguimiento_fpl_proyecto_path(pendiente,proyecto) do
                      %i.fa.fa-dollar 
                  - elsif pendiente.tarea_id == Tarea::ID_FPL_009
                    - data = pendiente.data
                    - pago = ProyectoPago.find(data[:pago_id])
                    = link_to seguimiento_fpl_proyecto_proyecto_pagos_orden_pago_path(pendiente,proyecto, pago) do
                      %i.fa.fa-dollar 
                  - elsif pendiente.tarea_id == Tarea::ID_FPL_010
                    - data = pendiente.data
                    - pago = ProyectoPago.find(data[:pago_id])
                    = link_to seguimiento_fpl_proyecto_proyecto_pagos_fecha_pago_path(pendiente,proyecto, pago) do
                      %i.fa.fa-calendar-o 
                  - elsif pendiente.tarea_id == Tarea::ID_FPL_011
                    = link_to seguimiento_fpl_proyecto_rendicion_actividades_path(pendiente,proyecto) do
                      %i.fa.fa-file-text-o  
                  - elsif pendiente.tarea_id == Tarea::ID_FPL_012
                    = link_to seguimiento_fpl_proyecto_rendicion_actividad_rendicion_tecnica_path(pendiente,proyecto) do
                      %i.fa.fa-file-text-o  
                  - elsif pendiente.tarea_id == Tarea::ID_FPL_013
                    = link_to seguimiento_fpl_proyecto_rendicion_actividad_rendicion_contable_path(pendiente,proyecto) do
                      %i.fa.fa-file-text-o  
                  - elsif pendiente.tarea_id == Tarea::ID_FPL_014
                    - data = pendiente.data
                    - encuesta = Encuesta.find(data[:encuesta_id])
                    = link_to responder_admin_encuesta_path(pendiente,encuesta) do
                      %i.fa.fa-file-text-o  
                  - elsif pendiente.tarea_id == Tarea::ID_FPL_015
                    = link_to seguimiento_fpl_proyecto_proyecto_actividades_path(pendiente,proyecto) do
                      %i.fa.fa-calendar-o 
                  - elsif pendiente.tarea_id == Tarea::ID_FPL_016
                    = link_to seguimiento_fpl_proyecto_proyecto_actividades_path(pendiente,proyecto) do
                      %i.fa.fa-calendar-o 
                  - elsif pendiente.tarea_id == Tarea::ID_FPL_017
                    = link_to resolucion_contrato_seguimiento_fpl_proyecto_path(pendiente, proyecto) do
                      %i.fa.fa-edit 
                  - elsif pendiente.tarea_id == Tarea::ID_FPL_018
                    = link_to restitucion_seguimiento_fpl_proyecto_path(pendiente, proyecto) do
                      %i.fa.fa-edit 

                  - elsif ! encuesta.blank? 
                    = link_to responder_admin_encuesta_path(pendiente,encuesta) do
                      %i.fa.fa-book

                  -#
