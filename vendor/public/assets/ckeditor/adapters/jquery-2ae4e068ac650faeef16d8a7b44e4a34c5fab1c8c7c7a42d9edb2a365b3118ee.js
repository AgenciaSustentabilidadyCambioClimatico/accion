!function(c){if(void 0===c)throw Error("jQuery should be loaded before CKEditor jQuery adapter.");if("undefined"==typeof CKEDITOR)throw Error("CKEditor should be loaded before CKEditor jQuery adapter.");CKEDITOR.config.jqueryOverrideVal="undefined"==typeof CKEDITOR.config.jqueryOverrideVal||CKEDITOR.config.jqueryOverrideVal,c.extend(c.fn,{ckeditorGet:function(){var e=this.eq(0).data("ckeditorInstance");if(!e)throw"CKEditor is not initialized yet, use ckeditor() with a callback.";return e},ckeditor:function(a,n){if(!CKEDITOR.env.isCompatible)throw Error("The environment is incompatible.");if(!c.isFunction(a)){var e=n;n=a,a=e}var d=[];n=n||{},this.each(function(){var r=c(this),e=r.data("ckeditorInstance"),t=r.data("_ckeditorInstanceLock"),i=this,o=new c.Deferred;d.push(o.promise()),e&&!t?(a&&a.apply(e,[this]),o.resolve()):t?e.once("instanceReady",function(){setTimeout(function(){e.element?(e.element.$==i&&a&&a.apply(e,[i]),o.resolve()):setTimeout(arguments.callee,100)},0)},null,null,9999):((n.autoUpdateElement||"undefined"==typeof n.autoUpdateElement&&CKEDITOR.config.autoUpdateElement)&&(n.autoUpdateElementJquery=!0),n.autoUpdateElement=!1,r.data("_ckeditorInstanceLock",!0),e=c(this).is("textarea")?CKEDITOR.replace(i,n):CKEDITOR.inline(i,n),r.data("ckeditorInstance",e),e.on("instanceReady",function(t){var n=t.editor;setTimeout(function(){if(n.element){if(t.removeListener(),n.on("dataReady",function(){r.trigger("dataReady.ckeditor",[n])}),n.on("setData",function(e){r.trigger("setData.ckeditor",[n,e.data])}),n.on("getData",function(e){r.trigger("getData.ckeditor",[n,e.data])},999),n.on("destroy",function(){r.trigger("destroy.ckeditor",[n])}),n.on("save",function(){return c(i.form).submit(),!1},null,null,20),n.config.autoUpdateElementJquery&&r.is("textarea")&&c(i.form).length){var e=function(){r.ckeditor(function(){n.updateElement()})};c(i.form).submit(e),c(i.form).bind("form-pre-serialize",e),r.bind("destroy.ckeditor",function(){c(i.form).unbind("submit",e),c(i.form).unbind("form-pre-serialize",e)})}n.on("destroy",function(){r.removeData("ckeditorInstance")}),r.removeData("_ckeditorInstanceLock"),r.trigger("instanceReady.ckeditor",[n]),a&&a.apply(n,[i]),o.resolve()}else setTimeout(arguments.callee,100)},0)},null,null,9999))});var t=new c.Deferred;return this.promise=t.promise(),c.when.apply(this,d).then(function(){t.resolve()}),this.editor=this.eq(0).data("ckeditorInstance"),this}}),CKEDITOR.config.jqueryOverrideVal&&(c.fn.val=CKEDITOR.tools.override(c.fn.val,function(a){return function(r){if(arguments.length){var e=this,i=[],t=this.each(function(){var e=c(this),t=e.data("ckeditorInstance");if(e.is("textarea")&&t){var n=new c.Deferred;return t.setData(r,function(){n.resolve()}),i.push(n.promise()),!0}return a.call(e,r)});if(i.length){var n=new c.Deferred;return c.when.apply(this,i).done(function(){n.resolveWith(e)}),n.promise()}return t}var o=(t=c(this).eq(0)).data("ckeditorInstance");return t.is("textarea")&&o?o.getData():a.call(t)}}))}(window.jQuery);