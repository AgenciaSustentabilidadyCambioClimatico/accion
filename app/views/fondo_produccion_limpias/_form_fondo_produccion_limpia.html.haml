:javascript
  var pais = 'Chile';//aún no se sabe como se manejará la internalización de este proyecto
  var desc = #{raw json_escape(@tipo_instrumentos.inject({}){|h,ti|h[ti.id]=ti.descripcion;h}.to_json)}

  // DZC 2019-07-12 12:22:18 se agregan validaciones
  var validaciones = #{raw json_escape(@validaciones.to_json)};
  var clases = Object.keys(validaciones);
  var descargables = #{raw json_escape(@descargables.to_json)}

  $('#tabla_usuarios_buscar-usuario-usuario').dataTable({
      destroy: true
  });
  $('#tabla_usuarios_buscar-usuario-consultor').dataTable({
      destroy: true
  });
  $('#tabla_usuarios_buscar-usuario-postulante').dataTable({
      destroy: true
  });

  $(document).on('click focus mouseover', '*',function(e){
    if(!$(this).is('abbr')){
      metodo = ['click','focus'].includes(e.type) ? 'hide' : 'enable';
      $(this).tooltip(metodo);
    }
  });

  $(document).ready(function(){
    sumarTrabajadoresPermanentes();
    sumarTrabajadoresTemporales();
    sumarValores(); 
    sumarValoresTec();
    sumarValoresTecElementosCarga();
    cargarObjetivosEspecificos();
    valida_div();
   
    //$("#intitucion_cogestora").click(function(){
    //  $('#buscador-contribuyente').html("#{j render 'admin/contribuyentes/buscador', es_para_seleccion: true, seleccion_basica: true, tipo_instrumento: 28, resultado_mostrados: 10}");
    //});

    $('#open-modal-button').click(function(){
      $('#modal_objetivos-form').modal('show');
    });

    $('#open-modal-button_crear_equipo_receptora').click(function(){
      $('#modal_postulante_create-form').modal('show');
    });

    $('#open-modal-button_crear_equipo_consultora').click(function(){
      $('#modal_consultora_create-form').modal('show');
    });

    $('#open-modal-button_buscar_usuario').click(function(){
      $('#buscar-usuario .body-usuario-buscador').html("#{j render('fondo_produccion_limpias/buscador_form', modal_id: 'buscar-usuario-usuario', tipo_equipo: '1')}");
      $('#buscar-usuario').modal("show");
    });

    $('#open-modal-button_buscar_contribuyente').click(function(){
        $("#buscar-contribuyente-fpl").modal('show');
    });

    $('#open-modal-button_buscar_usuario_consultora').click(function(){
      $('#buscar-usuario .body-usuario-buscador').html("#{j render('fondo_produccion_limpias/buscador_form', modal_id: 'buscar-usuario-consultor', tipo_equipo: '2')}");
      $('#buscar-usuario').modal("show");
    });

    $('#open-modal-button_buscar_usuario_postulante').click(function(){
      $('#buscar-usuario .body-usuario-buscador').html("#{j render('fondo_produccion_limpias/buscador_form', modal_id: 'buscar-usuario-postulante', tipo_equipo: '3')}");
      $('#buscar-usuario').modal("show");
    });

    $('body').on('change','.usuario-radio',function() {
      $('.seleccionar-usuario-button').removeAttr('disabled');
      $('.seleccionar-y-actualizar-usuario-fpl-button').removeAttr('disabled');
    });

    $('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
      $('#manifestacion_de_interes_current_tab').val($(this).attr('id'));
    });

    function checkbox_related_element(c) {
      element = $('#'+$(c).parents('.form-group').find('label.boolean').attr('for'));
      if (element === undefined) {
        return jQuery.extend();
      } else {
        return element;
      }
    }

    var id = window.setTimeout(function() {}, 0);
    while (id--) {
      window.clearTimeout(id);
    };

    var minutos = "#{@recuerde_guardar_minutos}";
    setTimeout(function showModal() {
      $('#mensaje_recuerde_guardar').modal('show');
      var minutos = "#{@recuerde_guardar_minutos}";
      setTimeout(showModal, ((+minutos)*60*1000));
      }, ((+minutos)*60*1000)
    );

    $(".show-ayuda").on("click",function(){
      id_campo_boton = $(this).attr("campo");
      $(".ayuda-campo-div-"+id_campo_boton).toggle(700);
    });

    $(".card-wrap").each(function(){
      $(this).addClass("card");
      $(this).css("margin-bottom", "0");
    });
  });
  
  function crear_tooltip(elemento_id, tooltip){
    var card_header = $('input[name="manifestacion_de_interes['+elemento_id.replace("#manifestacion_de_interes_", "")+'][]"]').closest(".card").children(".card-header");
    if(elemento_id.includes("_ids") && card_header.length > 0){
      if(!card_header.parent().hasClass("has-error")){
        card_header.addClass('tooltip-block');
        card_header.attr('data-tooltip','true');
        card_header.attr('data-original-title', tooltip);
      }
    }else if($(elemento_id).hasClass('select2-hidden-accessible')){
      $(elemento_id).parent().children('span').addClass('tooltip-block');
      $(elemento_id).parent().children('span').attr('data-tooltip','true');
      $(elemento_id).parent().children('span').attr('data-original-title', tooltip);
    }else if($(elemento_id).hasClass('file')){
      if(!$(elemento_id).parent().hasClass('has-error')){
        $(elemento_id).parent().addClass('tooltip-block');
        $(elemento_id).parent().attr('data-tooltip','true');
        $(elemento_id).parent().attr('data-original-title', tooltip);
      }
    }else{
      $(elemento_id).attr("title","");
      $(elemento_id).addClass('tooltip-block');
      $(elemento_id).attr('data-tooltip','true');
      $(elemento_id).attr('data-original-title', tooltip);
    }
  }

  function sumarValores() {
    // Obtener todos los elementos con la clase 'valor-a-sumar'
    var camposDeTexto = document.querySelectorAll('.valor-a-sumar');
    var total = document.getElementById('total');

    // Inicializar la variable para la suma
    var suma = 0;

    // Iterar sobre los campos de texto y sumar los valores
    camposDeTexto.forEach(function (campo) {
      // Obtener el valor del campo de texto y convertirlo a un número
      var valor = parseFloat(campo.value) || 0;

      // Sumar al total
      suma += valor;
    });

    // Mostrar el resultado o hacer algo con la suma
    total.textContent = suma;
  }

  function sumarValoresTec() {
    if(#{@solo_lectura} != true)  {
      // Obtener todos los elementos con la clase 'valor-a-sumar-tec'
      var camposDeTexto = document.querySelectorAll('.valor-a-sumar-tec');
      var total = document.getElementById('total_tecnica');

      // Inicializar la variable para la suma
      var suma = 0;

      // Iterar sobre los campos de texto y sumar los valores
      camposDeTexto.forEach(function (campo) {
        // Obtener el valor del campo de texto y convertirlo a un número
        var valor = parseFloat(campo.value) || 0;

        // Sumar al total
        suma += valor;
      
      });

    // Mostrar el resultado o hacer algo con la suma
    total.textContent = suma;
    }
  }

  function sumarValoresTecElementosCarga() {
    if(#{@solo_lectura} != true)  {
      if(#{@flujo.tipo_instrumento_id} != 11)  {
        // Obtener todos los elementos con la clase 'valor-a-sumar-tec-elementos'
        var camposDeTexto = document.querySelectorAll('.valor-a-sumar-tec-elementos');
        var total = document.getElementById('total_tecnica_elementos');

        // Inicializar la variable para la suma
        var suma = 0;

        // Iterar sobre los campos de texto y sumar los valores
        camposDeTexto.forEach(function (campo) {
          // Obtener el valor del campo de texto y convertirlo a un número
          var valor = parseFloat(campo.value) || 0;

          // Sumar al total
          suma += valor;
        });

        // Mostrar el resultado o hacer algo con la suma
        total.textContent = suma;
      }
    }
  }

  function sumarValoresTecElementos(campo_a, campo_b, nombre) {
    if(#{@flujo.tipo_instrumento_id} != 11)  {
      // Obtener todos los elementos con la clase 'valor-a-sumar-tec-elementos'
      var camposDeTexto = document.querySelectorAll('.valor-a-sumar-tec-elementos');
      var total = document.getElementById('total_tecnica_elementos');

      // Inicializar la variable para la suma
      var suma = 0;

      // Iterar sobre los campos de texto y sumar los valores
      camposDeTexto.forEach(function (campo) {
        // Obtener el valor del campo de texto y convertirlo a un número
        var valor = parseFloat(campo.value) || 0;

        // Sumar al total
        suma += valor;
      });

      // Mostrar el resultado o hacer algo con la suma
      total.textContent = suma;

      validarCampos(campo_a, campo_b, nombre);
    }
  }

  function validarCampos(campo_a, campo_b, nombre) {
    var campoA = document.getElementById(campo_a).value;
    var campoB = document.getElementById(campo_b).value;

    if (parseFloat(campoA) > parseFloat(campoB)) {
      alert('En la tabla "Elementos Totales a Adherir", el valor de la columna "' + nombre + '" debe ser menor o igual que el de la fila "Empresas Totales a Adherir".');
      document.getElementById(campo_b).value = '';
    }
  }

  function sumarTrabajadoresPermanentes() {
    // Obtener todos los elementos con la clase 'valor-a-sumar'
    var camposDeTexto = document.querySelectorAll('.valor-permanentes');
    var total = document.getElementById('total_permanente');

    // Inicializar la variable para la suma
    var suma = 0;

    // Iterar sobre los campos de texto y sumar los valores
    camposDeTexto.forEach(function (campo) {
      // Obtener el valor del campo de texto y convertirlo a un número
      var valor = parseFloat(campo.value) || 0;

      // Sumar al total
      suma += valor;
    });

    // Mostrar el resultado o hacer algo con la suma
    total.textContent = suma;

    sumarTrabajadoresPromedio();
  }

  function sumarTrabajadoresTemporales() {
    // Obtener todos los elementos con la clase 'valor-a-sumar'
    var camposDeTexto = document.querySelectorAll('.valor-temporales');
    var total = document.getElementById('total_temporales');

    // Inicializar la variable para la suma
    var suma = 0;

    // Iterar sobre los campos de texto y sumar los valores
    camposDeTexto.forEach(function (campo) {
      // Obtener el valor del campo de texto y convertirlo a un número
      var valor = parseFloat(campo.value) || 0;

      // Sumar al total
      suma += valor;
    });

    // Mostrar el resultado o hacer algo con la suma
    total.textContent = suma;

    sumarTrabajadoresPromedio();
  }

  function sumarTrabajadoresPromedio() {
    var permanentes_hombres = document.getElementById('permanentes_hombres');
    var temporales_hombres = document.getElementById('temporales_hombres');
    var total_hombres = document.getElementById('total_hombres');

    var permanentes_mujeres = document.getElementById('permanentes_mujeres');
    var temporales_mujeres = document.getElementById('temporales_mujeres');
    var total_mujeres = document.getElementById('total_mujeres');

    var valor_permanentes = parseFloat(permanentes_hombres.value) || 0;
    var valor_temporales = parseFloat(temporales_hombres.value) || 0;

    var resultado = valor_permanentes + valor_temporales;

    total_hombres.textContent = resultado;

    var valor_permanentes_mujeres = parseFloat(permanentes_mujeres.value) || 0;
    var valor_temporales_mujeres = parseFloat(temporales_mujeres.value) || 0;

    var resultado_mujeres = valor_permanentes_mujeres + valor_temporales_mujeres;

    total_mujeres.textContent = resultado_mujeres;

    var valor_resultado_hombres = parseFloat(resultado) || 0;
    var valor_resultado_mujeres = parseFloat(resultado_mujeres) || 0;

    var total = valor_resultado_hombres + valor_resultado_mujeres;

    total_trabajadores.textContent = total;

  }

  function duracion() {
    var duracion = document.getElementById('duracion_proyecto');
    var valorSeleccionado = duracion.value;
    var tareaPendienteId = document.getElementById('tarea_pendiente_id');

    // Realizar una solicitud AJAX al servidor
    $.ajax({
      type: 'POST',
      url: '/guardar_duracion',
      data: { duracion: valorSeleccionado, id: tareaPendienteId.value },
      success: function(response) {
        console.log('Duración guardada exitosamente en el servidor');
        //location.reload();
      },
      error: function(error) {
        console.error('Error al guardar la duración en el servidor:', error);
      }
    });  
  }

  function habilitaJustificacion() {
    // Seleccionar el elemento select
    var duracion_proyecto = document.getElementById('duracion_proyecto');
    var justificacion_duracion = document.getElementById('justificacion_duracion');
    var titulo_justificacion = document.getElementById('titulo_justificacion');
    
    // Obtener el valor seleccionado
    var valorSeleccionado = duracion_proyecto.value;
    
    // Mostrar un alert con el valor seleccionado
    if (valorSeleccionado && valorSeleccionado < 5) {
      justificacion_duracion.style.visibility = 'hidden';
      titulo_justificacion.style.visibility = 'hidden';
    } else {
      justificacion_duracion.style.visibility = 'visible';
      titulo_justificacion.style.visibility = 'visible';
    }
  }

  function guardarObjetivo() {
    var valueDescripcion = document.getElementById('descripcion').value;
    var valueMetodologia = document.getElementById('metodologia').value;
    var valueResultado = document.getElementById('resultado').value;
    var valueIndicadores = document.getElementById('indicadores').value;

    $.ajax({
      url: "#{insert_objetivo_especifico_fondo_produccion_limpia_path}",
      data: { flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}", 
              descripcion: valueDescripcion, 
              metodologia: valueMetodologia, 
              resultado: valueResultado, 
              indicadores: valueIndicadores },
      method: "GET",
      dataType: "script",
      success: function(response) {
      },
      error: function(error) {
        console.error("Error al llamar al método del controlador", error);
      }
    });
  }

  function editarObjetivo(id) {
    $.ajax({
      url: "#{edit_objetivo_especifico_fondo_produccion_limpia_path}",
      data: { objetivo_id: id },
      method: "GET",
      success: function(response) {
        $('#modal_objetivos-edit-form').modal('show');
      },
      error: function(error) {
        console.error("Error al llamar al método del controlador", error);
      }
    });
  }

  function crearPlanActividades(plan_id, solo_lectura){
    $.ajax({
      url: "#{get_plan_actividades_fondo_produccion_limpia_path}",
      data: { plan_id: plan_id, 
              solo_lectura: solo_lectura},
      method: "GET",
      success: function(response) {
        $('#modal_create_plan_actividades-form').modal('show');
      },
      error: function(error) {
        console.error("Error al llamar al método del controlador", error);
      }
    });
  }

  function modalRrhhPropios(id){
    $('#modal_create_plan_actividades-form').modal('hide');
    $.ajax({
      url: "#{get_recursos_propios_fondo_produccion_limpia_path}",
      data: { actividad_id: id},
      method: "GET",
      success: function(response) {
        $('#modal_rrhh_propios-form').modal('show');
      },
      error: function(error) {
        //console.error("Error al llamar al método del controlador", error);
      }
    });
  }

  function modalRrhhExternos(id){
    $('#modal_create_plan_actividades-form').modal('hide');
    $.ajax({
      url: "#{get_recursos_externos_fondo_produccion_limpia_path}",
      data: { actividad_id: id},
      method: "GET",
      success: function(response) {
        $('#modal_rrhh_externos-form').modal('show');
      },
      error: function(error) {
        //console.error("Error al llamar al método del controlador", error);
      }
    });
  }

  function modalGastosOperacion(id){
    $('#modal_create_plan_actividades-form').modal('hide');
    $('#modal_gastos_operacion-form').modal('show');
  }

  function modalGastosAdministrativos(id){
    $('#modal_create_plan_actividades-form').modal('hide');
    $('#modal_gastos_administracion-form').modal('show');
  }

  function insertGastosOperacion(plan_id){
    var nombre = document.getElementById('nombre').value;
    var valor_unitario = document.getElementById('valor_unitario').value;
    var cantidad = document.getElementById('cantidad').value;
    var unidad_medida = document.getElementById('unidad_medida').value;
    var tipo_aporte_id = document.getElementById('tipo_aporte_id').value;
 
    $.ajax({
      url: "#{insert_gastos_operacion_fondo_produccion_limpia_path}",
      data: { flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}", 
              plan_id: plan_id, 
              nombre: nombre, 
              valor_unitario: valor_unitario, 
              cantidad: cantidad, 
              unidad_medida: unidad_medida, 
              tipo_aporte_id: tipo_aporte_id},
      method: "GET",
      success: function(response) {
        
      },
      error: function(error) {
        //console.error("Error al llamar al método del controlador", error);
      }
    });
  }

  function insertGastosAdministracion(plan_id){
    var nombre = document.getElementById('nombre_adm').value;
    var valor_unitario = document.getElementById('valor_unitario_adm').value;
    var cantidad = document.getElementById('cantidad_adm').value;
    var unidad_medida = document.getElementById('unidad_medida_2').value;
    var tipo_aporte_id = document.getElementById('tipo_aporte_id_2').value;

    $.ajax({
      url: "#{insert_gastos_administracion_fondo_produccion_limpia_path}",
      data: { flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}", 
              plan_id: plan_id, 
              nombre: nombre, 
              valor_unitario: 
              valor_unitario, 
              cantidad: cantidad, 
              unidad_medida: unidad_medida, 
              tipo_aporte_id: tipo_aporte_id},
      method: "GET",
      success: function(response) {
      },
      error: function(error) {
        //console.error("Error al llamar al método del controlador", error);
      }
    });
  }

  function guardarPlanActividad(plan_id){
    // Seleccionar todos los checkboxes dentro de la tabla
    var checkboxes = document.querySelectorAll('#div_duracion input[type="checkbox"]');

    // Array para almacenar los checkboxes seleccionados
    var checkboxesSeleccionados = [];

    // Iterar sobre los checkboxes y verificar cuáles están seleccionados
    checkboxes.forEach(function(checkbox) {
        if (checkbox.checked) {
            checkboxesSeleccionados.push(checkbox.id); // Agregar el ID del checkbox seleccionado al array
        }
    });

    var duracion = checkboxesSeleccionados;
    var objetivos_especifico_id = document.getElementById('objetivos_especifico_id').value;

    var nombre_actividad = document.getElementById('nombre_actividad').value;
    var alertaMostrada = false;

    // Si el campo está vacío, muestra una alerta y evita el envío del formulario
    if (nombre_actividad == "") {
      if (!alertaMostrada) {
        alert('Por favor, ingresa un nombre de actividad.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }

    if (objetivos_especifico_id == "") {
      if (!alertaMostrada) {
        alert('Por favor, seleccione un objetivo específico');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }

    if (checkboxesSeleccionados == "") {
      if (!alertaMostrada) {
        alert('Por favor, seleccione al menos un mes de duración de la actividad');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }
    
    if (plan_id != 0) {
      $.ajax({
        url: "#{insert_plan_actividades_fondo_produccion_limpia_path}",
        data: { flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}", 
                plan_id: plan_id, 
                duracion: duracion, 
                objetivos_especifico_id: objetivos_especifico_id},
        method: "POST",
        success: function(response) {
          //alert("Plan de actividad creado exitosamente");
         
        },
        error: function(error) {
          console.error("Error al llamar al método del controlador", error);
        }
      });
    }else{
      $.ajax({
        url: "#{new_plan_actividades_fondo_produccion_limpia_path}",
        data: { flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}", 
                nombre_actividad: nombre_actividad,
                duracion: duracion, 
                objetivos_especifico_id: objetivos_especifico_id, 
                opcion: 'insert'},
        method: "POST",
        success: function(response) {
        },
        error: function(error) {
          console.error("Error al llamar al método del controlador", error);
        }
      });
    }
    //crearPlanActividades(plan_id, 'false');
  }

  function guardarRrhhPropioshh(plan_id){
    var data = [];// Arreglo para almacenar los datos
    // Recorre cada fila de la tabla
    $('#div_postulantes_faltantes table tbody tr').each(function() {
        var rrhhPropioId = $(this).find('td:nth-child(1)').text(); // Cambiar el selector según la estructura de tu tabla
        var rrhhEquipoId = $(this).find('td:nth-child(2)').text(); // Cambiar el selector según la estructura de tu tabla
        var nombreUsuario = $(this).find('td:nth-child(3)').text(); // Cambiar el selector según la estructura de tu tabla
        var hh = $(this).find('input[type="text"]').val(); // Obtener el valor del input de texto
    
        // Agrega los datos al arreglo
        data.push({
            rrhhPropioId: rrhhPropioId,
            rhhEquipoId: rrhhEquipoId,
            nombreUsuario: nombreUsuario,
            hh: hh
        });
    });

    // Envía el arreglo al controlador utilizando AJAX
    $.ajax({
        type: "GET",
        url: "#{insert_recursos_humanos_propios_fondo_produccion_limpia_path}",
        data: { data: JSON.stringify(data), 
                flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}", 
                plan_id: plan_id},// Envía los datos como JSON
        success: function(response) {
          // Maneja la respuesta del servidor
          //console.log(response);
        },
        error: function(xhr, status, error) {
          // Maneja los errores de la solicitud AJAX
          console.error(error);
        }
    });
  }

  function guardarRrhhExternoshh(plan_id){
    var data = [];// Arreglo para almacenar los datos
    // Recorre cada fila de la tabla
    var alertaMostrada = false;
    $('#div_consultor_faltantes_externos table tbody tr').each(function() {
      var rrhhExternoId = $(this).find('td:nth-child(1)').text(); // Cambiar el selector según la estructura de tu tabla
      var rrhhEquipoId = $(this).find('td:nth-child(2)').text(); // Cambiar el selector según la estructura de tu tabla
      var nombreUsuario = $(this).find('td:nth-child(3)').text(); // Cambiar el selector según la estructura de tu tabla
      var hh = $(this).find('input[type="text"]').val(); // Obtener el valor del input de texto
      
      if (nombreUsuario !== "Fuente de financiamiento*") {

        // Obtener todos los radio buttons con el nombre 'radio_tipo_aporte'
        var radioButtons = document.getElementsByName('radio_tipo_aporte');

        // Iterar sobre los radio buttons para verificar si alguno está seleccionado

        var seleccionado = false;
        for (var i = 0; i < radioButtons.length; i++) {
            if (radioButtons[i].checked) {
                seleccionado = true;
                break;
            }
        }
        // Verificar si al menos uno está seleccionado
        if (seleccionado) {
        // Agrega los datos al arreglo
          data.push({
              rrhhExternoId: rrhhExternoId,
              rhhEquipoId: rrhhEquipoId,
              nombreUsuario: nombreUsuario,
              hh: hh
          });
          var alertaMostrada = true;
        }else{ 
          ///REVISAR ALERT
          if (!alertaMostrada) {
            var alertaMostrada = true;
            alert('Por favor, seleccione alguna Fuente de financiamiento');
            event.preventDefault();
            //return;
          }
        }
      }
    });

    var tipoAporteSeleccionado = $('#div_consultor_faltantes_externos input[name="radio_tipo_aporte"]:checked').val();

    // Envía el arreglo al controlador utilizando AJAX
    $.ajax({
        type: "GET",
        url: "#{insert_recursos_humanos_externos_fondo_produccion_limpia_path}",
        data: { data: JSON.stringify(data), 
                flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}", 
                plan_id: plan_id, 
                tipoAporte: tipoAporteSeleccionado},// Envía los datos como JSON
        success: function(response) {
          // Maneja la respuesta del servidor
          //console.log(response);
        },
        error: function(xhr, status, error) {
          // Maneja los errores de la solicitud AJAX
          console.error(error);
        }
    });
  }  
  
  function optionSelect(tipo){
    var divEquipoConsultora = document.getElementById('div_equipo_consultora');
    var divEmpresaConsultora = document.getElementById('div_empresa_consultora');
    var divEquipoConsultoraEmpresa = document.getElementById('div_equipo_consultora_empresa');
    
    if (tipo == 1) {
      divEquipoConsultora.style.display = 'none';
      divEmpresaConsultora.style.display = 'block';
      divEquipoConsultoraEmpresa.style.display = 'block';
      
    } else if (tipo == 2){
      divEquipoConsultora.style.display = 'block';
      divEmpresaConsultora.style.display = 'none';
      divEquipoConsultoraEmpresa.style.display = 'none'; 
    } else  if (tipo == 0){
      divEquipoConsultora.style.display = 'none';
      divEmpresaConsultora.style.display = 'block';
      divEquipoConsultoraEmpresa.style.display = 'none';
    }
  }

  function valida_div(){
    
    var divEquipoConsultora = document.getElementById('div_equipo_consultora');
    var divEmpresaConsultora = document.getElementById('div_empresa_consultora');
    var divEquipoConsultoraEmpresa = document.getElementById('div_equipo_consultora_empresa');

    var tipo = document.getElementById('tipos').getAttribute('data-tipo');
    if (tipo == 2) {
      divEquipoConsultora.style.display = 'none';
      divEmpresaConsultora.style.display = 'block';
      divEquipoConsultoraEmpresa.style.display = 'block';
      $('#open-modal-button_buscar_contribuyente').prop('disabled', true);
    } else if (tipo == 1){
      divEquipoConsultora.style.display = 'block';
      divEmpresaConsultora.style.display = 'none';
      divEquipoConsultoraEmpresa.style.display = 'none'; 
    } else  if (tipo == 0){
      divEquipoConsultora.style.display = 'none';
      divEmpresaConsultora.style.display = 'block';
      divEquipoConsultoraEmpresa.style.display = 'none';
      $('#open-modal-button_buscar_contribuyente').prop('disabled', false);
    }
   
  }

  function actualizarObjetivo() {
    var valueId = document.getElementById('id_edit').value;
    var valueDescripcion = document.getElementById('descripcion_edit').value;
    var valueMetodologia = document.getElementById('metodologia_edit').value;
    var valueResultado = document.getElementById('resultado_edit').value;
    var valueIndicadores = document.getElementById('indicadores_edit').value;

    $.ajax({
      url: "#{update_objetivo_especifico_fondo_produccion_limpia_path}",
      data: JSON.stringify({ 
        objetivo_id: valueId, 
        flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}",
        descripcion: valueDescripcion,
        metodologia: valueMetodologia,
        resultado: valueResultado,
        indicadores: valueIndicadores
      }),
      contentType: 'application/json',
      method: "PATCH",
      headers: {
        'X-CSRF-Token': $('meta[name="csrf-token"]').attr('content') // CSRF token
      },
      success: function(response) {
      },
      error: function(error) {
        console.error("Error al llamar al método del controlador", error);
      }
    });

  }

  function cargarObjetivosEspecificos() {
    $.ajax({
      url: "#{get_objetivo_especifico_fondo_produccion_limpia_path}",
      data: {
        flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}",
        solo_lectura : "#{@solo_lectura.nil? ? '' : @solo_lectura}",
      },
      method: "GET",
      success: function(response) {
      },
      error: function(error) {
        console.error("Error al llamar al método del controlador", error);
      }
    });
  }

  $(document).ready(function() {
    // Obtén el valor de la URL para activar el tab correspondiente
    var urlParams = new URLSearchParams(window.location.search);
    var activeTab = urlParams.get('tabs');

    // Si hay un valor en 'tabs', activa el tab correspondiente
    if (activeTab) {
      $('#manifestacion a[href="#' + activeTab + '"]').tab('show');
    }
  });

  function iniciarBuscar(id) {
    $.ajax({
      url: "#{buscador_fondo_produccion_limpia_path}",
      data: { id2: id},
      method: "GET",
      success: function(response) {
      },
      error: function(error) {
        console.error("Error al llamar al método del controlador", error);
      }
    });
  }

  function soloNumeros(e) {
    var key = window.Event ? e.which : e.keyCode;
    var value = e.target.value;
    
    // Si el primer carácter ingresado es 0 y no hay ningún otro carácter
    // o el primer carácter ingresado es 0 y el segundo carácter no es un número
    if ((key === 48 && (value === "" || isNaN(parseInt(value[0])))) || (value === "0" && isNaN(parseInt(String.fromCharCode(key))))) {
        e.preventDefault(); // Evita que se ingrese el 0 como primer carácter
    }

    // Restringir que solo se ingresen números
    return (key >= 48 && key <= 57);
  }

  function agregarPlanActividades() {
     $.ajax({
      url: "#{new_plan_actividades_fondo_produccion_limpia_path}",
      data: { flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}", 
              plan_id: 0, 
              opcion: 'create'},
      method: "POST",
      success: function(response) {
        $('#modal_create_plan_actividades-form').modal('show');
      },
      error: function(error) {
        console.error("Error al llamar al método del controlador", error);
      }
    });
  }

  function guardarAdmisibilidadFinanciera(){
    var nota_input_id_1 = document.getElementById('nota_input_id_1').value;
    var nota_input_id_2 = document.getElementById('nota_input_id_2').value;
    var nota_input_id_3 = document.getElementById('nota_input_id_3').value;
    var nota_input_id_4 = document.getElementById('nota_input_id_4').value;
    var nota_input_id_5 = document.getElementById('nota_input_id_5').value;

    var obs_input_id_1 = document.getElementById('obs_input_id_1').value;
    var obs_input_id_2 = document.getElementById('obs_input_id_2').value;
    var obs_input_id_3 = document.getElementById('obs_input_id_3').value;
    var obs_input_id_4 = document.getElementById('obs_input_id_4').value;
    var obs_input_id_5 = document.getElementById('obs_input_id_5').value;

    var jsonData = {
      1: {
          criterio_id: 1,
          nota: nota_input_id_1,
          justificacion: obs_input_id_1
      },
      2: {
          criterio_id: 2,
          nota: nota_input_id_2,
          justificacion: obs_input_id_2
      },
      3: {
          criterio_id: 3,
          nota: nota_input_id_3,
          justificacion: obs_input_id_3
      },
      4: {
          criterio_id: 4,
          nota: nota_input_id_4,
          justificacion: obs_input_id_4
      },
      5: {
          criterio_id: 5,
          nota: nota_input_id_5,
          justificacion: obs_input_id_5
      }
    };

    const button_guardar = document.getElementById('guardar_button');
    button_guardar.innerHTML = '<i class="fa fa-spinner fa-spin"></i> Guardando...';
    button_guardar.disabled = true;

    const button_enviar = document.getElementById('enviar_admisibilidad_financiera_button');
    button_enviar.disabled = true;

    $.ajax({
      url: "#{revisar_admisibilidad_fondo_produccion_limpia_path}",
      data: JSON.stringify({ flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}", jsonData }),
      contentType: "application/json",
      method: "PATCH",
      success: function(response) {
      },
      error: function(error) {
        console.error("Error al llamar al método del controlador", error);
        $('.loading-data').hide();
        button_guardar.innerHTML = 'Guardar';
        button_guardar.disabled = false;
        button_enviar.disabled = false;
      }
    });
  }

  
  function enviarAdmisibilidadFinanciera(){
    var nota_input_id_1 = document.getElementById('nota_input_id_1').value;
    var nota_input_id_2 = document.getElementById('nota_input_id_2').value;
    var nota_input_id_3 = document.getElementById('nota_input_id_3').value;
    var nota_input_id_4 = document.getElementById('nota_input_id_4').value;
    var nota_input_id_5 = document.getElementById('nota_input_id_5').value;

    var obs_input_id_1 = document.getElementById('obs_input_id_1').value;
    var obs_input_id_2 = document.getElementById('obs_input_id_2').value;
    var obs_input_id_3 = document.getElementById('obs_input_id_3').value;
    var obs_input_id_4 = document.getElementById('obs_input_id_4').value;
    var obs_input_id_5 = document.getElementById('obs_input_id_5').value;

    var jsonData = {
      1: {
          criterio_id: 1,
          nota: nota_input_id_1,
          justificacion: obs_input_id_1
      },
      2: {
          criterio_id: 2,
          nota: nota_input_id_2,
          justificacion: obs_input_id_2
      },
      3: {
          criterio_id: 3,
          nota: nota_input_id_3,
          justificacion: obs_input_id_3
      },
      4: {
          criterio_id: 4,
          nota: nota_input_id_4,
          justificacion: obs_input_id_4
      },
      5: {
          criterio_id: 5,
          nota: nota_input_id_5,
          justificacion: obs_input_id_5
      }
    };

    var alertaMostrada = false;

    // Si el campo está vacío, muestra una alerta y evita el envío del formulario
    if (nota_input_id_1 == "") {
      if (!alertaMostrada) {
        alert('Por favor, selecciona una nota a la pregunta 1.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }else{
      if (nota_input_id_1 < 5) {
        if (obs_input_id_1 == "") {
          if (!alertaMostrada) {
            alert('Por favor, ingresa una justificación a la pregunta 1.');
            alertaMostrada = true;
          }
          event.preventDefault();
          return;
        }
      }
    }

    if (nota_input_id_2 == "") {
      if (!alertaMostrada) {
        alert('Por favor, selecciona una nota a la pregunta 2.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }else{
      if (nota_input_id_2 < 5) {
        if (obs_input_id_2 == "") {
          if (!alertaMostrada) {
            alert('Por favor, ingresa una justificación a la pregunta 2.');
            alertaMostrada = true;
          }
          event.preventDefault();
          return;
        }
      }
    }

    if (nota_input_id_3 == "") {
      if (!alertaMostrada) {
        alert('Por favor, selecciona una nota a la pregunta 3.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }else{
      if (nota_input_id_3 < 5) {
        if (obs_input_id_3 == "") {
          if (!alertaMostrada) {
            alert('Por favor, ingresa una justificación a la pregunta 3.');
            alertaMostrada = true;
          }
          event.preventDefault();
          return;
        }
      }
    }

    if (nota_input_id_4 == "") {
      if (!alertaMostrada) {
        alert('Por favor, selecciona una nota a la pregunta 4.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }else{
      if (nota_input_id_4 < 5) {
        if (obs_input_id_4 == "") {
          if (!alertaMostrada) {
            alert('Por favor, ingresa una justificación a la pregunta 4.');
            alertaMostrada = true;
          }
          event.preventDefault();
          return;
        }
      }
    }

    if (nota_input_id_5 == "") {
      if (!alertaMostrada) {
        alert('Por favor, selecciona una nota a la pregunta 5.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }else{
      if (nota_input_id_5 < 5) {
        if (obs_input_id_5 == "") {
          if (!alertaMostrada) {
            alert('Por favor, ingresa una justificación a la pregunta 5.');
            alertaMostrada = true;
          }
          event.preventDefault();
          return;
        }
      }
    }

    $('.loading-data').show();

    const button_enviar = document.getElementById('enviar_admisibilidad_financiera_button');
    button_enviar.innerHTML = '<i class="fa fa-spinner fa-spin"></i> Enviando...';
    button_enviar.disabled = true;

    const button_guardar = document.getElementById('guardar_button');
    button_guardar.disabled = true;

    $.ajax({
      url: "#{enviar_admisibilidad_financiera_fondo_produccion_limpia_path}",
      data: JSON.stringify({ flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}", jsonData }),
      contentType: "application/json",
      method: "POST",
      success: function(response) {
      },
      error: function(error) {
        console.error("Error al llamar al método del controlador", error);
        $('.loading-data').hide();
        button_enviar.innerHTML = '<i class="fa fa-arrow-circle-right"></i> Enviar';
        button_enviar.disabled = false;
        button_guardar.disabled = false;
      }
    });
  }

  function guardarAdmisibilidadTecnica(){
    var nota_input_id_1 = document.getElementById('nota_input_tecnica_id_1').value;
    var nota_input_id_2 = document.getElementById('nota_input_tecnica_id_2').value;
    var nota_input_id_3 = document.getElementById('nota_input_tecnica_id_3').value;
    var nota_input_id_4 = document.getElementById('nota_input_tecnica_id_4').value;
    var nota_input_id_5 = document.getElementById('nota_input_tecnica_id_5').value;
    var nota_input_id_6 = document.getElementById('nota_input_tecnica_id_6').value;
    var nota_input_id_7 = document.getElementById('nota_input_tecnica_id_7').value;
    var nota_input_id_8 = document.getElementById('nota_input_tecnica_id_8').value;

    var obs_input_id_1 = document.getElementById('obs_input_tecnica_id_1').value;
    var obs_input_id_2 = document.getElementById('obs_input_tecnica_id_2').value;
    var obs_input_id_3 = document.getElementById('obs_input_tecnica_id_3').value;
    var obs_input_id_4 = document.getElementById('obs_input_tecnica_id_4').value;
    var obs_input_id_5 = document.getElementById('obs_input_tecnica_id_5').value;
    var obs_input_id_6 = document.getElementById('obs_input_tecnica_id_6').value;
    var obs_input_id_7 = document.getElementById('obs_input_tecnica_id_7').value;
    var obs_input_id_8 = document.getElementById('obs_input_tecnica_id_8').value;

    var jsonData = {
      1: {
          criterio_id: 1,
          nota: nota_input_id_1,
          justificacion: obs_input_id_1
      },
      2: {
          criterio_id: 2,
          nota: nota_input_id_2,
          justificacion: obs_input_id_2
      },
      3: {
          criterio_id: 3,
          nota: nota_input_id_3,
          justificacion: obs_input_id_3
      },
      4: {
          criterio_id: 4,
          nota: nota_input_id_4,
          justificacion: obs_input_id_4
      },
      5: {
          criterio_id: 5,
          nota: nota_input_id_5,
          justificacion: obs_input_id_5
      },
      6: {
          criterio_id: 6,
          nota: nota_input_id_6,
          justificacion: obs_input_id_6
      },
      7: {
          criterio_id: 7,
          nota: nota_input_id_7,
          justificacion: obs_input_id_7
      },
      8: {
          criterio_id: 8,
          nota: nota_input_id_8,
          justificacion: obs_input_id_8
      }
    };

    const button_guardar = document.getElementById('guardar_button_admisibilidad_tecnica');
    button_guardar.innerHTML = '<i class="fa fa-spinner fa-spin"></i> Guardando...';
    button_guardar.disabled = true;

    const button_enviar = document.getElementById('enviar_admisibilidad_tecnica_button');
    button_enviar.disabled = true;

    $.ajax({
      url: "#{revisar_admisibilidad_tecnica_fondo_produccion_limpia_path}",
      data: JSON.stringify({ flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}", jsonData }),
      contentType: "application/json",
      method: "PATCH",
      success: function(response) {
        //button.innerHTML = 'Guardar';
        //button.disabled = false;
      },
      error: function(error) {
        console.error("Error al llamar al método del controlador", error);
        $('.loading-data').hide();
        button_guardar.innerHTML = 'Guardar';
        button_guardar.disabled = false;
        button_enviar.disabled = false;
      }
    });
  }

  function enviarAdmisibilidadTecnica(){
    var nota_input_id_1 = document.getElementById('nota_input_tecnica_id_1').value;
    var nota_input_id_2 = document.getElementById('nota_input_tecnica_id_2').value;
    var nota_input_id_3 = document.getElementById('nota_input_tecnica_id_3').value;
    var nota_input_id_4 = document.getElementById('nota_input_tecnica_id_4').value;
    var nota_input_id_5 = document.getElementById('nota_input_tecnica_id_5').value;
    var nota_input_id_6 = document.getElementById('nota_input_tecnica_id_6').value;
    var nota_input_id_7 = document.getElementById('nota_input_tecnica_id_7').value;
    var nota_input_id_8 = document.getElementById('nota_input_tecnica_id_8').value;

    var obs_input_id_1 = document.getElementById('obs_input_tecnica_id_1').value;
    var obs_input_id_2 = document.getElementById('obs_input_tecnica_id_2').value;
    var obs_input_id_3 = document.getElementById('obs_input_tecnica_id_3').value;
    var obs_input_id_4 = document.getElementById('obs_input_tecnica_id_4').value;
    var obs_input_id_5 = document.getElementById('obs_input_tecnica_id_5').value;
    var obs_input_id_6 = document.getElementById('obs_input_tecnica_id_6').value;
    var obs_input_id_7 = document.getElementById('obs_input_tecnica_id_7').value;
    var obs_input_id_8 = document.getElementById('obs_input_tecnica_id_8').value;

    var jsonData = {
      1: {
          criterio_id: 1,
          nota: nota_input_id_1,
          justificacion: obs_input_id_1
      },
      2: {
          criterio_id: 2,
          nota: nota_input_id_2,
          justificacion: obs_input_id_2
      },
      3: {
          criterio_id: 3,
          nota: nota_input_id_3,
          justificacion: obs_input_id_3
      },
      4: {
          criterio_id: 4,
          nota: nota_input_id_4,
          justificacion: obs_input_id_4
      },
      5: {
          criterio_id: 5,
          nota: nota_input_id_5,
          justificacion: obs_input_id_5
      },
      6: {
          criterio_id: 6,
          nota: nota_input_id_6,
          justificacion: obs_input_id_6
      },
      7: {
          criterio_id: 7,
          nota: nota_input_id_7,
          justificacion: obs_input_id_7
      },
      8: {
          criterio_id: 8,
          nota: nota_input_id_8,
          justificacion: obs_input_id_8
      }
    };

    var alertaMostrada = false;

    // Si el campo está vacío, muestra una alerta y evita el envío del formulario
    if (nota_input_id_1 == "") {
      if (!alertaMostrada) {
        alert('Por favor, selecciona una nota a la pregunta 1.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }else{
      if (nota_input_id_1 < 5) {
        if (obs_input_id_1 == "") {
          if (!alertaMostrada) {
            alert('Por favor, ingresa una justificación a la pregunta 1.');
            alertaMostrada = true;
          }
          event.preventDefault();
          return;
        }
      }
    }

    if (nota_input_id_2 == "") {
      if (!alertaMostrada) {
        alert('Por favor, selecciona una nota a la pregunta 2.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }else{
      if (nota_input_id_2 < 5) {
        if (obs_input_id_2 == "") {
          if (!alertaMostrada) {
            alert('Por favor, ingresa una justificación a la pregunta 2.');
            alertaMostrada = true;
          }
          event.preventDefault();
          return;
        }
      }
    }

    if (nota_input_id_3 == "") {
      if (!alertaMostrada) {
        alert('Por favor, selecciona una nota a la pregunta 3.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }else{
      if (nota_input_id_3 < 5) {
        if (obs_input_id_3 == "") {
          if (!alertaMostrada) {
            alert('Por favor, ingresa una justificación a la pregunta 3.');
            alertaMostrada = true;
          }
          event.preventDefault();
          return;
        }
      }
    }

    if (nota_input_id_4 == "") {
      if (!alertaMostrada) {
        alert('Por favor, selecciona una nota a la pregunta 4.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }else{
      if (nota_input_id_4 < 5) {
        if (obs_input_id_4 == "") {
          if (!alertaMostrada) {
            alert('Por favor, ingresa una justificación a la pregunta 4.');
            alertaMostrada = true;
          }
          event.preventDefault();
          return;
        }
      }
    }

    if (nota_input_id_5 == "") {
      if (!alertaMostrada) {
        alert('Por favor, selecciona una nota a la pregunta 5.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }else{
      if (nota_input_id_5 < 5) {
        if (obs_input_id_5 == "") {
          if (!alertaMostrada) {
            alert('Por favor, ingresa una justificación a la pregunta 5.');
            alertaMostrada = true;
          }
          event.preventDefault();
          return;
        }
      }
    }

    if (nota_input_id_6 == "") {
      if (!alertaMostrada) {
        alert('Por favor, selecciona una nota a la pregunta 6.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }else{
      if (nota_input_id_6 < 5) {
        if (obs_input_id_6 == "") {
          if (!alertaMostrada) {
            alert('Por favor, ingresa una justificación a la pregunta 6.');
            alertaMostrada = true;
          }
          event.preventDefault();
          return;
        }
      }
    }

    if (nota_input_id_7 == "") {
      if (!alertaMostrada) {
        alert('Por favor, selecciona una nota a la pregunta 7.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }else{
      if (nota_input_id_7 < 5) {
        if (obs_input_id_7 == "") {
          if (!alertaMostrada) {
            alert('Por favor, ingresa una justificación a la pregunta 7.');
            alertaMostrada = true;
          }
          event.preventDefault();
          return;
        }
      }
    }

    if (nota_input_id_8 == "") {
      if (!alertaMostrada) {
        alert('Por favor, selecciona una nota a la pregunta 8.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }else{
      if (nota_input_id_8 < 5) {
        if (obs_input_id_8 == "") {
          if (!alertaMostrada) {
            alert('Por favor, ingresa una justificación a la pregunta 8.');
            alertaMostrada = true;
          }
          event.preventDefault();
          return;
        }
      }
    }
    $('.loading-data').show();

    const button_enviar = document.getElementById('enviar_admisibilidad_tecnica_button');
    button_enviar.innerHTML = '<i class="fa fa-spinner fa-spin"></i> Enviando...';
    button_enviar.disabled = true;

    const button_guardar = document.getElementById('guardar_button_admisibilidad_tecnica');
    button_guardar.disabled = true;

    $.ajax({
      url: "#{enviar_admisibilidad_tecnica_fondo_produccion_limpia_path}",
      data: JSON.stringify({ flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}", jsonData }),
      contentType: "application/json",
      method: "POST",
      success: function(response) {
      },
      error: function(error) {
        console.error("Error al llamar al método del controlador", error);
        $('.loading-data').hide();
        button_enviar.innerHTML = '<i class="fa fa-arrow-circle-right"></i> Enviar';
        button_enviar.disabled = false;
        button_guardar.disabled = false;
      }
    });
  }  

  function guardarAdmisibilidadJuridica(){
    var nota_input_id_1 = document.getElementById('nota_input_juridica_id_1').value;
    var nota_input_id_2 = document.getElementById('nota_input_juridica_id_2').value;
    var nota_input_id_3 = document.getElementById('nota_input_juridica_id_3').value;
    var nota_input_id_4 = document.getElementById('nota_input_juridica_id_4').value;
    var nota_input_id_5 = document.getElementById('nota_input_juridica_id_5').value;
    var nota_input_id_6 = document.getElementById('nota_input_juridica_id_6').value;
    var nota_input_id_7 = document.getElementById('nota_input_juridica_id_7').value;
    var nota_input_id_8 = document.getElementById('nota_input_juridica_id_8').value;

    var obs_input_id_1 = document.getElementById('obs_input_juridica_id_1').value;
    var obs_input_id_2 = document.getElementById('obs_input_juridica_id_2').value;
    var obs_input_id_3 = document.getElementById('obs_input_juridica_id_3').value;
    var obs_input_id_4 = document.getElementById('obs_input_juridica_id_4').value;
    var obs_input_id_5 = document.getElementById('obs_input_juridica_id_5').value;
    var obs_input_id_6 = document.getElementById('obs_input_juridica_id_6').value;
    var obs_input_id_7 = document.getElementById('obs_input_juridica_id_7').value;
    var obs_input_id_8 = document.getElementById('obs_input_juridica_id_8').value;

    var jsonData = {
      1: {
          criterio_id: 1,
          nota: nota_input_id_1,
          justificacion: obs_input_id_1
      },
      2: {
          criterio_id: 2,
          nota: nota_input_id_2,
          justificacion: obs_input_id_2
      },
      3: {
          criterio_id: 3,
          nota: nota_input_id_3,
          justificacion: obs_input_id_3
      },
      4: {
          criterio_id: 4,
          nota: nota_input_id_4,
          justificacion: obs_input_id_4
      },
      5: {
          criterio_id: 5,
          nota: nota_input_id_5,
          justificacion: obs_input_id_5
      },
      6: {
          criterio_id: 6,
          nota: nota_input_id_6,
          justificacion: obs_input_id_6
      },
      7: {
          criterio_id: 7,
          nota: nota_input_id_7,
          justificacion: obs_input_id_7
      },
      8: {
          criterio_id: 8,
          nota: nota_input_id_8,
          justificacion: obs_input_id_8
      }
    };

    $('.loading-data').show();

    const button_guardar = document.getElementById('guardar_button_admisibilidad_juridica');
    button_guardar.innerHTML = '<i class="fa fa-spinner fa-spin"></i> Guardando...';
    button_guardar.disabled = true;

    const button_enviar = document.getElementById('enviar_admisibilidad_juridica_button');
    button_enviar.disabled = true;

    $.ajax({
      url: "#{revisar_admisibilidad_juridica_fondo_produccion_limpia_path}",
      data: JSON.stringify({ flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}", jsonData }),
      contentType: "application/json",
      method: "PATCH",
      success: function(response) {
        $('.loading-data').show();
        //$('.loading-data').hide();
        //button_guardar.innerHTML = 'Guardar';
        //button_guardar.disabled = false;
      },
      error: function(error) {
        console.error("Error al llamar al método del controlador", error);
        $('.loading-data').hide();
        button_guardar.innerHTML = 'Guardar';
        button_guardar.disabled = false;
        button_enviar.disabled = false;
      }
    });
  }

  function enviarAdmisibilidadJuridica(){
    var nota_input_id_1 = document.getElementById('nota_input_juridica_id_1').value;
    var nota_input_id_2 = document.getElementById('nota_input_juridica_id_2').value;
    var nota_input_id_3 = document.getElementById('nota_input_juridica_id_3').value;
    var nota_input_id_4 = document.getElementById('nota_input_juridica_id_4').value;
    var nota_input_id_5 = document.getElementById('nota_input_juridica_id_5').value;
    var nota_input_id_6 = document.getElementById('nota_input_juridica_id_6').value;
    var nota_input_id_7 = document.getElementById('nota_input_juridica_id_7').value;
    var nota_input_id_8 = document.getElementById('nota_input_juridica_id_8').value;

    var obs_input_id_1 = document.getElementById('obs_input_juridica_id_1').value;
    var obs_input_id_2 = document.getElementById('obs_input_juridica_id_2').value;
    var obs_input_id_3 = document.getElementById('obs_input_juridica_id_3').value;
    var obs_input_id_4 = document.getElementById('obs_input_juridica_id_4').value;
    var obs_input_id_5 = document.getElementById('obs_input_juridica_id_5').value;
    var obs_input_id_6 = document.getElementById('obs_input_juridica_id_6').value;
    var obs_input_id_7 = document.getElementById('obs_input_juridica_id_7').value;
    var obs_input_id_8 = document.getElementById('obs_input_juridica_id_8').value;

    var jsonData = {
      1: {
          criterio_id: 1,
          nota: nota_input_id_1,
          justificacion: obs_input_id_1
      },
      2: {
          criterio_id: 2,
          nota: nota_input_id_2,
          justificacion: obs_input_id_2
      },
      3: {
          criterio_id: 3,
          nota: nota_input_id_3,
          justificacion: obs_input_id_3
      },
      4: {
          criterio_id: 4,
          nota: nota_input_id_4,
          justificacion: obs_input_id_4
      },
      5: {
          criterio_id: 5,
          nota: nota_input_id_5,
          justificacion: obs_input_id_5
      },
      6: {
          criterio_id: 6,
          nota: nota_input_id_6,
          justificacion: obs_input_id_6
      },
      7: {
          criterio_id: 7,
          nota: nota_input_id_7,
          justificacion: obs_input_id_7
      },
      8: {
          criterio_id: 8,
          nota: nota_input_id_8,
          justificacion: obs_input_id_8
      }
    };

    var alertaMostrada = false;

    // Si el campo está vacío, muestra una alerta y evita el envío del formulario
    if (nota_input_id_1 == "") {
      if (!alertaMostrada) {
        alert('Por favor, selecciona respuesta a la pregunta 1.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }else{
      if (nota_input_id_1 == "2") {
        if (obs_input_id_1 == "") {
          if (!alertaMostrada) {
            alert('Por favor, ingresa una observación a la pregunta 1.');
            alertaMostrada = true;
          }
          event.preventDefault();
          return;
        }
      }
    }

    if (nota_input_id_2 == "") {
      if (!alertaMostrada) {
        alert('Por favor, selecciona respuesta a la pregunta 2.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }else{
      if (nota_input_id_2 == "2") {
        if (obs_input_id_2 == "") {
          if (!alertaMostrada) {
            alert('Por favor, ingresa una observación a la pregunta 2.');
            alertaMostrada = true;
          }
          event.preventDefault();
          return;
        }
      }
    }

    if (nota_input_id_3 == "") {
      if (!alertaMostrada) {
        alert('Por favor, selecciona respuesta a la pregunta 3.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }else{
      if (nota_input_id_3 == "2") {
        if (obs_input_id_3 == "") {
          if (!alertaMostrada) {
            alert('Por favor, ingresa una observación a la pregunta 3.');
            alertaMostrada = true;
          }
          event.preventDefault();
          return;
        }
      }
    }

    if (nota_input_id_4 == "") {
      if (!alertaMostrada) {
        alert('Por favor, selecciona respuesta a la pregunta 4.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }else{
      if (nota_input_id_4 == "2") {
        if (obs_input_id_4 == "") {
          if (!alertaMostrada) {
            alert('Por favor, ingresa una observación a la pregunta 4.');
            alertaMostrada = true;
          }
          event.preventDefault();
          return;
        }
      }
    }

    if (nota_input_id_5 == "") {
      if (!alertaMostrada) {
        alert('Por favor, selecciona respuesta a la pregunta 5.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }else{
      if (nota_input_id_5 == "2") {
        if (obs_input_id_5 == "") {
          if (!alertaMostrada) {
            alert('Por favor, ingresa una observación a la pregunta 5.');
            alertaMostrada = true;
          }
          event.preventDefault();
          return;
        }
      }
    }

    if (nota_input_id_6 == "") {
      if (!alertaMostrada) {
        alert('Por favor, selecciona respuesta a la pregunta 6.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }else{
      if (nota_input_id_6 == "2") {
        if (obs_input_id_6 == "") {
          if (!alertaMostrada) {
            alert('Por favor, ingresa una observación a la pregunta 6.');
            alertaMostrada = true;
          }
          event.preventDefault();
          return;
        }
      }
    }

    if (nota_input_id_7 == "") {
      if (!alertaMostrada) {
        alert('Por favor, selecciona respuesta a la pregunta 7.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }else{
      if (nota_input_id_7 == "2") {
        if (obs_input_id_7 == "") {
          if (!alertaMostrada) {
            alert('Por favor, ingresa una observación a la pregunta 7.');
            alertaMostrada = true;
          }
          event.preventDefault();
          return;
        }
      }
    }

    if (nota_input_id_8 == "") {
      if (!alertaMostrada) {
        alert('Por favor, selecciona respuesta a la pregunta 8.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }else{
      if (nota_input_id_8 == "2") {
        if (obs_input_id_8 == "") {
          if (!alertaMostrada) {
            alert('Por favor, ingresa una observación a la pregunta 8.');
            alertaMostrada = true;
          }
          event.preventDefault();
          return;
        }
      }
    }

    $('.loading-data').show();

    const button_enviar = document.getElementById('enviar_admisibilidad_juridica_button');
    button_enviar.innerHTML = '<i class="fa fa-spinner fa-spin"></i> Enviando...';
    button_enviar.disabled = true;

    const button_guardar = document.getElementById('guardar_button_admisibilidad_juridica');
    button_guardar.disabled = true;

    $.ajax({
      url: "#{enviar_admisibilidad_juridica_fondo_produccion_limpia_path}",
      data: JSON.stringify({ flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}", jsonData }),
      contentType: "application/json",
      method: "POST",
      success: function(response) {
      },
      error: function(error) {
        console.error("Error al llamar al método del controlador", error);
        $('.loading-data').hide();
        button_enviar.innerHTML = '<i class="fa fa-arrow-circle-right"></i> Enviar';
        button_enviar.disabled = false;
        button_guardar.disabled = false;
      }
    });

  }

  function guardarObservacionesAdmisibilidadJuridica(){
    $('.loading-data').show();

    $.ajax({
      url: "#{resolver_observaciones_admisibilidad_juridica_fondo_produccion_limpia_path}",
      data: JSON.stringify({ flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}" }),
      contentType: "application/json",
      method: "PATCH",
      success: function(response) {
        $('.loading-data').hide();
      },
      error: function(error) {
        console.error("Error al llamar al método del controlador", error);
        $('.loading-data').hide();
      }
    });
  }

  function enviarObservacionesAdmisibilidadJuridica(){
    $('.loading-data').show();
    $.ajax({
      url: "#{enviar_observaciones_admisibilidad_juridica_fondo_produccion_limpia_path}",
      data: JSON.stringify({ flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}" }),
      contentType: "application/json",
      method: "POST",
      success: function(response) {
        //$('.loading-data').hide();
      },
      error: function(error) {
        console.error("Error al llamar al método del controlador", error);
        $('.loading-data').hide();
      }
    });
  }

  function enviarObservacionesAdmisibilidadFinanciera(){
    var cantidad_micro_empresa = document.getElementById('cantidad_micro_empresa').value;
    var cantidad_pequeña_empresa = document.getElementById('cantidad_pequeña_empresa').value;
    var cantidad_mediana_empresa = document.getElementById('cantidad_mediana_empresa').value;
    var cantidad_grande_empresa = document.getElementById('cantidad_grande_empresa').value;
    var duracion = document.getElementById('duracion').value;
    var fortalezas_consultores = document.getElementById('fortalezas_consultores').value;    
    var empresas_asociadas_ag = 0;   
    var empresas_no_asociadas_ag = 0;
    var elementos_micro_empresa = 0;
    var elementos_pequena_empresa = 0;
    var elementos_mediana_empresa = 0;
    var elementos_grande_empresa = 0;

    if(#{@flujo.tipo_instrumento_id} == 11)  {

      var empresas_asociadas_ag = document.getElementById('empresas_asociadas_ag').value;
      var empresas_no_asociadas_ag = document.getElementById('empresas_no_asociadas_ag').value;
   
      // Obtener el elemento <ul> con la clase seleccionados_tree
      var ulElement = document.querySelector('.seleccionados_tree');

      // Verificar si se encontró el elemento <ul>
      if (ulElement) {
          // Obtener todos los elementos <li> dentro del <ul>
          var liElements = ulElement.querySelectorAll('li');

          // Crear un array para almacenar los IDs de las comunas seleccionadas
          var comunasIds = [];

          // Iterar sobre los elementos <li> para obtener los IDs
          liElements.forEach(function(liElement) {
              // Obtener el ID del elemento <li>
              var comunaId = liElement.id;
              // Agregar el ID al array de IDs de comunas seleccionadas
              comunasIds.push(comunaId);
          });

          // Ahora tienes el array comunasIds que contiene los IDs de las comunas seleccionadas
          // console.log('IDs de comunas seleccionadas:', comunasIds);
      } else {
          console.log('No se encontró el elemento <ul> con la clase seleccionados_tree');
      }
    }else{
      elementos_micro_empresa = document.getElementById('elementos_micro_empresa').value;
      elementos_pequena_empresa = document.getElementById('elementos_pequena_empresa').value;
      elementos_mediana_empresa = document.getElementById('elementos_mediana_empresa').value;
      elementos_grande_empresa = document.getElementById('elementos_grande_empresa').value;
    }

    $.ajax({
      url: "#{guardar_fondo_temporal_fondo_produccion_limpia_path}",
      data: {
        flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}",
        cantidad_micro_empresa: cantidad_micro_empresa,
        cantidad_pequeña_empresa: cantidad_pequeña_empresa,
        cantidad_mediana_empresa: cantidad_mediana_empresa,
        cantidad_grande_empresa: cantidad_grande_empresa,
        empresas_asociadas_ag: empresas_asociadas_ag,
        empresas_no_asociadas_ag: empresas_no_asociadas_ag,
        duracion: duracion,
        fortalezas_consultores: fortalezas_consultores,
        comunasIds : comunasIds,
        elementos_micro_empresa: elementos_micro_empresa,
        elementos_pequena_empresa: elementos_pequena_empresa,
        elementos_mediana_empresa: elementos_mediana_empresa,
        elementos_grande_empresa: elementos_grande_empresa
      },
      method: "GET",
      success: function(response) {
        $.ajax({
          url: "#{get_valida_campos_nulos_fondo_produccion_limpia_path}",
          data: {
            flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}"
          },
          method: "GET",
          success: function(response) {
            if(confirm("¿Está seguro que desea enviar?")){
              $.ajax({
                url: "#{enviar_observaciones_admisibilidad_fondo_produccion_limpia_path}",
                data: JSON.stringify({ flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}" }),
                contentType: "application/json",
                method: "POST",
                success: function(response) {
                  //$('.loading-data').hide();
                },
                error: function(error) {
                  console.error("Error al llamar al método del controlador", error);
                  $('.loading-data').hide();
                }
              });
            }
          }})
      },
      error: function(error) {
        console.error("Error al llamar al método del controlador", error);
      }
    });
  }

  function enviarObservacionesAdmisibilidadTecnica(){
    var cantidad_micro_empresa = document.getElementById('cantidad_micro_empresa').value;
    var cantidad_pequeña_empresa = document.getElementById('cantidad_pequeña_empresa').value;
    var cantidad_mediana_empresa = document.getElementById('cantidad_mediana_empresa').value;
    var cantidad_grande_empresa = document.getElementById('cantidad_grande_empresa').value;
    var duracion = document.getElementById('duracion').value;
    var fortalezas_consultores = document.getElementById('fortalezas_consultores').value;    

    var empresas_asociadas_ag = 0;   
    var empresas_no_asociadas_ag = 0;

    var elementos_micro_empresa = 0;
    var elementos_pequena_empresa = 0;
    var elementos_mediana_empresa = 0;
    var elementos_grande_empresa = 0;

    if(#{@flujo.tipo_instrumento_id} == 11)  {

      var empresas_asociadas_ag = document.getElementById('empresas_asociadas_ag').value;
      var empresas_no_asociadas_ag = document.getElementById('empresas_no_asociadas_ag').value;

      // Obtener el elemento <ul> con la clase seleccionados_tree
      var ulElement = document.querySelector('.seleccionados_tree');

      // Verificar si se encontró el elemento <ul>
      if (ulElement) {
          // Obtener todos los elementos <li> dentro del <ul>
          var liElements = ulElement.querySelectorAll('li');

          // Crear un array para almacenar los IDs de las comunas seleccionadas
          var comunasIds = [];

          // Iterar sobre los elementos <li> para obtener los IDs
          liElements.forEach(function(liElement) {
              // Obtener el ID del elemento <li>
              var comunaId = liElement.id;
              // Agregar el ID al array de IDs de comunas seleccionadas
              comunasIds.push(comunaId);
          });

          // Ahora tienes el array comunasIds que contiene los IDs de las comunas seleccionadas
          // console.log('IDs de comunas seleccionadas:', comunasIds);
      } else {
          console.log('No se encontró el elemento <ul> con la clase seleccionados_tree');
      }
    }else{
      elementos_micro_empresa = document.getElementById('elementos_micro_empresa').value;
      elementos_pequena_empresa = document.getElementById('elementos_pequena_empresa').value;
      elementos_mediana_empresa = document.getElementById('elementos_mediana_empresa').value;
      elementos_grande_empresa = document.getElementById('elementos_grande_empresa').value;
    }

    $.ajax({
      url: "#{guardar_fondo_temporal_fondo_produccion_limpia_path}",
      data: {
        flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}",
        cantidad_micro_empresa: cantidad_micro_empresa,
        cantidad_pequeña_empresa: cantidad_pequeña_empresa,
        cantidad_mediana_empresa: cantidad_mediana_empresa,
        cantidad_grande_empresa: cantidad_grande_empresa,
        empresas_asociadas_ag: empresas_asociadas_ag,
        empresas_no_asociadas_ag: empresas_no_asociadas_ag,
        duracion: duracion,
        fortalezas_consultores: fortalezas_consultores,
        comunasIds : comunasIds,
        elementos_micro_empresa: elementos_micro_empresa,
        elementos_pequena_empresa: elementos_pequena_empresa,
        elementos_mediana_empresa: elementos_mediana_empresa,
        elementos_grande_empresa: elementos_grande_empresa
      },
      method: "GET",
      success: function(response) {
        $.ajax({
          url: "#{get_valida_campos_nulos_fondo_produccion_limpia_path}",
          data: {
            flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}"
          },
          method: "GET",
          success: function(response) {
            if(confirm("¿Está seguro que desea enviar?")){
              $('.loading-data').show();
              $.ajax({
                url: "#{enviar_observaciones_admisibilidad_tecnica_fondo_produccion_limpia_path}",
                data: JSON.stringify({ flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}" }),
                contentType: "application/json",
                method: "POST",
                success: function(response) {
                  //$('.loading-data').hide();
                },
                error: function(error) {
                  console.error("Error al llamar al método del controlador", error);
                  $('.loading-data').hide();
                }
              });
            }
          }})
      },
      error: function(error) {
        console.error("Error al llamar al método del controlador", error);
      }
    });
  }

  function guardarPertinenciaFactibilidad(){
    var nota_input_id_1 = document.getElementById('nota_input_pert_tecnica_id_1').value;
    var nota_input_id_2 = document.getElementById('nota_input_pert_tecnica_id_2').value;
    var nota_input_id_3 = document.getElementById('nota_input_pert_tecnica_id_3').value;
    var nota_input_id_4 = document.getElementById('nota_input_pert_tecnica_id_4').value;
    var nota_input_id_5 = document.getElementById('nota_input_pert_tecnica_id_5').value;
    var nota_input_id_6 = document.getElementById('nota_input_pert_tecnica_id_6').value;
    var nota_input_id_7 = document.getElementById('nota_input_pert_tecnica_id_7').value;
    var nota_input_id_8 = document.getElementById('nota_input_pert_tecnica_id_8').value;

    var obs_input_id_1 = document.getElementById('obs_input_pert_tecnica_id_1').value;
    var obs_input_id_2 = document.getElementById('obs_input_pert_tecnica_id_2').value;
    var obs_input_id_3 = document.getElementById('obs_input_pert_tecnica_id_3').value;
    var obs_input_id_4 = document.getElementById('obs_input_pert_tecnica_id_4').value;
    var obs_input_id_5 = document.getElementById('obs_input_pert_tecnica_id_5').value;
    var obs_input_id_6 = document.getElementById('obs_input_pert_tecnica_id_6').value;
    var obs_input_id_7 = document.getElementById('obs_input_pert_tecnica_id_7').value;
    var obs_input_id_8 = document.getElementById('obs_input_pert_tecnica_id_8').value;

    var jsonDataTecnico = {
      1: {
          criterio_id: 1,
          nota: nota_input_id_1,
          justificacion: obs_input_id_1
      },
      2: {
          criterio_id: 2,
          nota: nota_input_id_2,
          justificacion: obs_input_id_2
      },
      3: {
          criterio_id: 3,
          nota: nota_input_id_3,
          justificacion: obs_input_id_3
      },
      4: {
          criterio_id: 4,
          nota: nota_input_id_4,
          justificacion: obs_input_id_4
      },
      5: {
          criterio_id: 5,
          nota: nota_input_id_5,
          justificacion: obs_input_id_5
      },
      6: {
          criterio_id: 6,
          nota: nota_input_id_6,
          justificacion: obs_input_id_6
      },
      7: {
          criterio_id: 7,
          nota: nota_input_id_7,
          justificacion: obs_input_id_7
      },
      8: {
          criterio_id: 8,
          nota: nota_input_id_8,
          justificacion: obs_input_id_8
      }
    };

    var nota_input_id_1 = document.getElementById('nota_input_pert_id_1').value;
    var nota_input_id_2 = document.getElementById('nota_input_pert_id_2').value;
    var nota_input_id_3 = document.getElementById('nota_input_pert_id_3').value;
    var nota_input_id_4 = document.getElementById('nota_input_pert_id_4').value;
    var nota_input_id_5 = document.getElementById('nota_input_pert_id_5').value;

    var obs_input_id_1 = document.getElementById('obs_input_pert_id_1').value;
    var obs_input_id_2 = document.getElementById('obs_input_pert_id_2').value;
    var obs_input_id_3 = document.getElementById('obs_input_pert_id_3').value;
    var obs_input_id_4 = document.getElementById('obs_input_pert_id_4').value;
    var obs_input_id_5 = document.getElementById('obs_input_pert_id_5').value;

    var jsonDataFinanciera = {
      1: {
          criterio_id: 1,
          nota: nota_input_id_1,
          justificacion: obs_input_id_1
      },
      2: {
          criterio_id: 2,
          nota: nota_input_id_2,
          justificacion: obs_input_id_2
      },
      3: {
          criterio_id: 3,
          nota: nota_input_id_3,
          justificacion: obs_input_id_3
      },
      4: {
          criterio_id: 4,
          nota: nota_input_id_4,
          justificacion: obs_input_id_4
      },
      5: {
          criterio_id: 5,
          nota: nota_input_id_5,
          justificacion: obs_input_id_5
      }
    };

    var nota_input_pertinencia = document.getElementById('nota_input_pertinencia').value;
    var obs_input_pertinencia = document.getElementById('obs_input_pertinencia').value;
    
    $('.loading-data').show();
    
    const button = document.getElementById('guardar_button_pertinencia_factibilidad');
    button.innerHTML = '<i class="fa fa-spinner fa-spin"></i> Guardando...';
    button.disabled = true;

    $.ajax({
      url: "#{revisar_pertinencia_factibilidad_fondo_produccion_limpia_path}",
      data: JSON.stringify({ flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}", 
        jsonDataTecnico, 
        jsonDataFinanciera, 
        nota_input_pertinencia: nota_input_pertinencia, 
        obs_input_pertinencia: obs_input_pertinencia }),
      contentType: "application/json",
      method: "PATCH",
      success: function(response) {
        $('.loading-data').hide();
        button.innerHTML = 'Guardar';
        button.disabled = false;
      },
      error: function(error) {
        console.error("Error al llamar al método del controlador", error);
        $('.loading-data').hide();
        button.innerHTML = 'Guardar';
        button.disabled = false;
      }
    });
  }

  function enviarPertinenciaFactibilidad(){
    var nota_input_id_1 = document.getElementById('nota_input_pert_tecnica_id_1').value;
    var nota_input_id_2 = document.getElementById('nota_input_pert_tecnica_id_2').value;
    var nota_input_id_3 = document.getElementById('nota_input_pert_tecnica_id_3').value;
    var nota_input_id_4 = document.getElementById('nota_input_pert_tecnica_id_4').value;
    var nota_input_id_5 = document.getElementById('nota_input_pert_tecnica_id_5').value;
    var nota_input_id_6 = document.getElementById('nota_input_pert_tecnica_id_6').value;
    var nota_input_id_7 = document.getElementById('nota_input_pert_tecnica_id_7').value;
    var nota_input_id_8 = document.getElementById('nota_input_pert_tecnica_id_8').value;

    var obs_input_id_1 = document.getElementById('obs_input_pert_tecnica_id_1').value;
    var obs_input_id_2 = document.getElementById('obs_input_pert_tecnica_id_2').value;
    var obs_input_id_3 = document.getElementById('obs_input_pert_tecnica_id_3').value;
    var obs_input_id_4 = document.getElementById('obs_input_pert_tecnica_id_4').value;
    var obs_input_id_5 = document.getElementById('obs_input_pert_tecnica_id_5').value;
    var obs_input_id_6 = document.getElementById('obs_input_pert_tecnica_id_6').value;
    var obs_input_id_7 = document.getElementById('obs_input_pert_tecnica_id_7').value;
    var obs_input_id_8 = document.getElementById('obs_input_pert_tecnica_id_8').value;

    var jsonDataTecnico = {
      1: {
          criterio_id: 1,
          nota: nota_input_id_1,
          justificacion: obs_input_id_1
      },
      2: {
          criterio_id: 2,
          nota: nota_input_id_2,
          justificacion: obs_input_id_2
      },
      3: {
          criterio_id: 3,
          nota: nota_input_id_3,
          justificacion: obs_input_id_3
      },
      4: {
          criterio_id: 4,
          nota: nota_input_id_4,
          justificacion: obs_input_id_4
      },
      5: {
          criterio_id: 5,
          nota: nota_input_id_5,
          justificacion: obs_input_id_5
      },
      6: {
          criterio_id: 6,
          nota: nota_input_id_6,
          justificacion: obs_input_id_6
      },
      7: {
          criterio_id: 7,
          nota: nota_input_id_7,
          justificacion: obs_input_id_7
      },
      8: {
          criterio_id: 8,
          nota: nota_input_id_8,
          justificacion: obs_input_id_8
      }
    };

    var nota_input_id_1 = document.getElementById('nota_input_pert_id_1').value;
    var nota_input_id_2 = document.getElementById('nota_input_pert_id_2').value;
    var nota_input_id_3 = document.getElementById('nota_input_pert_id_3').value;
    var nota_input_id_4 = document.getElementById('nota_input_pert_id_4').value;
    var nota_input_id_5 = document.getElementById('nota_input_pert_id_5').value;

    var obs_input_id_1 = document.getElementById('obs_input_pert_id_1').value;
    var obs_input_id_2 = document.getElementById('obs_input_pert_id_2').value;
    var obs_input_id_3 = document.getElementById('obs_input_pert_id_3').value;
    var obs_input_id_4 = document.getElementById('obs_input_pert_id_4').value;
    var obs_input_id_5 = document.getElementById('obs_input_pert_id_5').value;

    var jsonDataFinanciera = {
      1: {
          criterio_id: 1,
          nota: nota_input_id_1,
          justificacion: obs_input_id_1
      },
      2: {
          criterio_id: 2,
          nota: nota_input_id_2,
          justificacion: obs_input_id_2
      },
      3: {
          criterio_id: 3,
          nota: nota_input_id_3,
          justificacion: obs_input_id_3
      },
      4: {
          criterio_id: 4,
          nota: nota_input_id_4,
          justificacion: obs_input_id_4
      },
      5: {
          criterio_id: 5,
          nota: nota_input_id_5,
          justificacion: obs_input_id_5
      }
    };

    var nota_input_pertinencia = document.getElementById('nota_input_pertinencia').value;
    var obs_input_pertinencia = document.getElementById('obs_input_pertinencia').value;

     var alertaMostrada = false;

    // Si el campo está vacío, muestra una alerta y evita el envío del formulario
    if (obs_input_pertinencia == "") {
      if (!alertaMostrada) {
        alert('Por favor, ingresar una observación.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }
    $('.loading-data').show();

    const button = document.getElementById('enviar_pertinencia_factibilidad_button');
    button.innerHTML = '<i class="fa fa-spinner fa-spin"></i> Enviando...';
    button.disabled = true;

    $.ajax({
      url: "#{enviar_pertinencia_factibilidad_fondo_produccion_limpia_path}",
      data: JSON.stringify({ flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}", 
        jsonDataTecnico, 
        jsonDataFinanciera, 
        nota_input_pertinencia: nota_input_pertinencia, 
        obs_input_pertinencia: obs_input_pertinencia }),
      contentType: "application/json",
      method: "POST",
      success: function(response) {
        //$('.loading-data').hide();
      },
      error: function(error) {
        console.error("Error al llamar al método del controlador", error);
        $('.loading-data').hide();
        button.innerHTML = '<i class="fa fa-arrow-circle-right"></i> Enviar';
        button.disabled = false;
      }
    });
  }

  
  function enviarEvaluacionGeneral(){
    var nota_input_id_1 = document.getElementById('nota_input_pert_tecnica_id_1').value;
    var nota_input_id_2 = document.getElementById('nota_input_pert_tecnica_id_2').value;
    var nota_input_id_3 = document.getElementById('nota_input_pert_tecnica_id_3').value;
    var nota_input_id_4 = document.getElementById('nota_input_pert_tecnica_id_4').value;
    var nota_input_id_5 = document.getElementById('nota_input_pert_tecnica_id_5').value;
    var nota_input_id_6 = document.getElementById('nota_input_pert_tecnica_id_6').value;
    var nota_input_id_7 = document.getElementById('nota_input_pert_tecnica_id_7').value;
    var nota_input_id_8 = document.getElementById('nota_input_pert_tecnica_id_8').value;

    var obs_input_id_1 = document.getElementById('obs_input_pert_tecnica_id_1').value;
    var obs_input_id_2 = document.getElementById('obs_input_pert_tecnica_id_2').value;
    var obs_input_id_3 = document.getElementById('obs_input_pert_tecnica_id_3').value;
    var obs_input_id_4 = document.getElementById('obs_input_pert_tecnica_id_4').value;
    var obs_input_id_5 = document.getElementById('obs_input_pert_tecnica_id_5').value;
    var obs_input_id_6 = document.getElementById('obs_input_pert_tecnica_id_6').value;
    var obs_input_id_7 = document.getElementById('obs_input_pert_tecnica_id_7').value;
    var obs_input_id_8 = document.getElementById('obs_input_pert_tecnica_id_8').value;

    var jsonDataTecnico = {
      1: {
          criterio_id: 1,
          nota: nota_input_id_1,
          justificacion: obs_input_id_1
      },
      2: {
          criterio_id: 2,
          nota: nota_input_id_2,
          justificacion: obs_input_id_2
      },
      3: {
          criterio_id: 3,
          nota: nota_input_id_3,
          justificacion: obs_input_id_3
      },
      4: {
          criterio_id: 4,
          nota: nota_input_id_4,
          justificacion: obs_input_id_4
      },
      5: {
          criterio_id: 5,
          nota: nota_input_id_5,
          justificacion: obs_input_id_5
      },
      6: {
          criterio_id: 6,
          nota: nota_input_id_6,
          justificacion: obs_input_id_6
      },
      7: {
          criterio_id: 7,
          nota: nota_input_id_7,
          justificacion: obs_input_id_7
      },
      8: {
          criterio_id: 8,
          nota: nota_input_id_8,
          justificacion: obs_input_id_8
      }
    };

    var nota_input_finanaciera_id_1 = document.getElementById('nota_input_pert_general_id_1').value;
    var nota_input_finanaciera_id_2 = document.getElementById('nota_input_pert_general_id_2').value;
    var nota_input_finanaciera_id_3 = document.getElementById('nota_input_pert_general_id_3').value;
    var nota_input_finanaciera_id_4 = document.getElementById('nota_input_pert_general_id_4').value;
    var nota_input_finanaciera_id_5 = document.getElementById('nota_input_pert_general_id_5').value;

    var obs_input_finanaciera_id_1 = document.getElementById('obs_input_pert_general_id_1').value;
    var obs_input_finanaciera_id_2 = document.getElementById('obs_input_pert_general_id_2').value;
    var obs_input_finanaciera_id_3 = document.getElementById('obs_input_pert_general_id_3').value;
    var obs_input_finanaciera_id_4 = document.getElementById('obs_input_pert_general_id_4').value;
    var obs_input_finanaciera_id_5 = document.getElementById('obs_input_pert_general_id_5').value;

    var jsonDataFinanciera = {
      1: {
          criterio_id: 1,
          nota: nota_input_finanaciera_id_1,
          justificacion: obs_input_finanaciera_id_1
      },
      2: {
          criterio_id: 2,
          nota: nota_input_finanaciera_id_2,
          justificacion: obs_input_finanaciera_id_2
      },
      3: {
          criterio_id: 3,
          nota: nota_input_finanaciera_id_3,
          justificacion: obs_input_finanaciera_id_3
      },
      4: {
          criterio_id: 4,
          nota: nota_input_finanaciera_id_4,
          justificacion: obs_input_finanaciera_id_4
      },
      5: {
          criterio_id: 5,
          nota: nota_input_finanaciera_id_5,
          justificacion: obs_input_finanaciera_id_5
      }
    };

    var nota_input_jur_id_1 = document.getElementById('nota_input_juridica_general_id_1').value;
    var nota_input_jur_id_2 = document.getElementById('nota_input_juridica_general_id_2').value;
    var nota_input_jur_id_3 = document.getElementById('nota_input_juridica_general_id_3').value;
    var nota_input_jur_id_4 = document.getElementById('nota_input_juridica_general_id_4').value;
    var nota_input_jur_id_5 = document.getElementById('nota_input_juridica_general_id_5').value;
    var nota_input_jur_id_6 = document.getElementById('nota_input_juridica_general_id_6').value;
    var nota_input_jur_id_7 = document.getElementById('nota_input_juridica_general_id_7').value;
    var nota_input_jur_id_8 = document.getElementById('nota_input_juridica_general_id_8').value;

    var obs_input_jur_id_1 = document.getElementById('obs_input_juridica_general_id_1').value;
    var obs_input_jur_id_2 = document.getElementById('obs_input_juridica_general_id_2').value;
    var obs_input_jur_id_3 = document.getElementById('obs_input_juridica_general_id_3').value;
    var obs_input_jur_id_4 = document.getElementById('obs_input_juridica_general_id_4').value;
    var obs_input_jur_id_5 = document.getElementById('obs_input_juridica_general_id_5').value;
    var obs_input_jur_id_6 = document.getElementById('obs_input_juridica_general_id_6').value;
    var obs_input_jur_id_7 = document.getElementById('obs_input_juridica_general_id_7').value;
    var obs_input_jur_id_8 = document.getElementById('obs_input_juridica_general_id_8').value;

    var jsonDataJuridica = {
      1: {
          criterio_id: 1,
          nota: nota_input_jur_id_1,
          justificacion: obs_input_jur_id_1
      },
      2: {
          criterio_id: 2,
          nota: nota_input_jur_id_2,
          justificacion: obs_input_jur_id_2
      },
      3: {
          criterio_id: 3,
          nota: nota_input_jur_id_3,
          justificacion: obs_input_jur_id_3
      },
      4: {
          criterio_id: 4,
          nota: nota_input_jur_id_4,
          justificacion: obs_input_jur_id_4
      },
      5: {
          criterio_id: 5,
          nota: nota_input_jur_id_5,
          justificacion: obs_input_jur_id_5
      },
      6: {
          criterio_id: 6,
          nota: nota_input_jur_id_6,
          justificacion: obs_input_jur_id_6
      },
      7: {
          criterio_id: 7,
          nota: nota_input_jur_id_7,
          justificacion: obs_input_jur_id_7
      },
      8: {
          criterio_id: 8,
          nota: nota_input_jur_id_8,
          justificacion: obs_input_jur_id_8
      }
    };

    var nota_input_pertinencia = document.getElementById('nota_input_pertinencia').value;
    var obs_input_pertinencia = document.getElementById('obs_input_pertinencia').value;

     var alertaMostrada = false;

    // Si el campo está vacío, muestra una alerta y evita el envío del formulario
    if (obs_input_pertinencia == "") {
      if (!alertaMostrada) {
        alert('Por favor, ingresar una observación.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }

    $('.loading-data').show();

    const button = document.getElementById('enviar_evaluacion_general_button');
    button.innerHTML = '<i class="fa fa-spinner fa-spin"></i> Enviando...';
    button.disabled = true;

    $.ajax({
      url: "#{enviar_evaluacion_general_fondo_produccion_limpia_path}",
      data: JSON.stringify({ flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}", 
        jsonDataTecnico, 
        jsonDataFinanciera, 
        jsonDataJuridica,
        nota_input_pertinencia: nota_input_pertinencia, 
        obs_input_pertinencia: obs_input_pertinencia }),
      contentType: "application/json",
      method: "POST",
      success: function(response) {
      },
      error: function(error) {
        $('.loading-data').hide();
        console.error("Error al llamar al método del controlador", error);
        button.innerHTML = '<i class="fa fa-arrow-circle-right"></i> Enviar';
        button.disabled = false;
      }
    });
  }

  function guardarAsignarRevisores() {
    var codigo_proyecto = document.getElementById('codigo_proyecto').value;
    var revisor_tecnico_id = document.getElementById('revisor_tecnico_fpl_id').value;
    var revisor_financiero_id = document.getElementById('revisor_financiero_fpl_id').value;
    var revisor_juridico_id = document.getElementById('revisor_juridico_fpl_id').value;
    var comentario_asignar_revisor = document.getElementById('comentario_asignar_revisor_fpl').value;
    
    var alertaMostrada = false;

    // Si el campo está vacío, muestra una alerta y evita el envío del formulario
    if (codigo_proyecto == "") {
      if (!alertaMostrada) {
        alert('Por favor, ingresa el codigo de proyecto.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }

    if (revisor_tecnico_id == "") {
      if (!alertaMostrada) {
        alert('Por favor, ingresa el revisor técnico.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }

    if (revisor_financiero_id == "") {
      if (!alertaMostrada) {
        alert('Por favor, ingresa el revisor financiero.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }

    if (revisor_juridico_id == "") {
      if (!alertaMostrada) {
        alert('Por favor, ingresa el revisor jurídico.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }

    if (comentario_asignar_revisor == "") {
      if (!alertaMostrada) {
        alert('Por favor, ingresa algun comentario.');
        alertaMostrada = true;
      }
      event.preventDefault();
      return;
    }
    $('.loading-data').show();
    const button = document.getElementById('guardar_button_revisor');
    button.innerHTML = '<i class="fa fa-spinner fa-spin"></i> Guardando...';
    button.disabled = true;
    $.ajax({
      url: "#{asignar_revisor_fondo_produccion_limpia_path}",
      data: {
        flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}",
        codigo_proyecto: codigo_proyecto,
        revisor_tecnico_id: revisor_tecnico_id,
        revisor_financiero_id: revisor_financiero_id,
        revisor_juridico_id: revisor_juridico_id,
        comentario_asignar_revisor: comentario_asignar_revisor
      },
      method: "PATCH",
      success: function(response) {
        //calcularPromedioFinanciera();
        $('.loading-data').hide();
      },
      error: function(error) {
        console.error("Error al llamar al método del controlador", error);
        $('.loading-data').hide();
      }
    });
  }

    function guardarArchivosEquipo(equipo_id, nombreCampo) {
      var archivoInput = document.getElementById('archivoInput_'+ equipo_id);
      var archivo = archivoInput.files[0];
      var formData = new FormData();
      formData.append('archivo', archivo);
      formData.append('nombre_campo', nombreCampo);
      formData.append('equipo_id', equipo_id);

      // Obtener el ID del flujo
      var Id = "#{@tarea_pendiente.nil? ? '' : @tarea_pendiente.id}";
      var flujo_id = "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}";

      // Agregar el ID del flujo como parte de los datos del formulario
      formData.append('id', Id);
      formData.append('flujo_id', flujo_id);

      fetch('/subir_documento_equipo', {
        method: 'POST',
        body: formData,
        headers: {
          'X-CSRF-Token': document.querySelector('meta[name="csrf-token"]').getAttribute('content')
        }
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('Error al subir el archivo');
        }
        return response.json();
      })
      .then(data => {
        //console.log('Documentos subidos correctamente:', data);
        // Aquí puedes realizar alguna acción después de subir los documentos, como actualizar la interfaz de usuario
      })
      .catch(error => {
        //console.error('Error:', error);
        // Aquí puedes manejar el error, como mostrar un mensaje de error al usuario
      });
    }

    function guardarArchivos(event, id_doc, nombreCampo) {
      //var archivoInput = document.getElementById('archivoInput_'+ id_doc);
      var archivoInput = document.getElementById(nombreCampo);
      var archivo = archivoInput.files[0];
      var formData = new FormData();
      formData.append('archivo', archivo);
      formData.append('nombre_campo', nombreCampo);

      // Obtener el ID del flujo
      var Id = "#{@tarea_pendiente.nil? ? '' : @tarea_pendiente.id}";

      // Agregar el ID del flujo como parte de los datos del formulario
      formData.append('id', Id);

      fetch('/subir_documento', {
        method: 'POST',
        body: formData,
        headers: {
          'X-CSRF-Token': document.querySelector('meta[name="csrf-token"]').getAttribute('content')
        }
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('Error al subir el archivo');
        }
        return response.json();
      })
      .then(data => {
        //console.log('Documentos subidos correctamente:', data);
        // Aquí puedes realizar alguna acción después de subir los documentos, como actualizar la interfaz de usuario
      })
      .catch(error => {
        //console.error('Error:', error);
        // Aquí puedes manejar el error, como mostrar un mensaje de error al usuario
      });
    }

    function actualizarContenidoDescarga(id, nombreArchivo, nombreCampo) {
      var fila = document.getElementById(`fila_${id}`);
      var linkDescarga = fila.querySelector('a.btn-descargar');
      if (nombreArchivo !== "") {
        // Si se ha cargado un archivo, actualizar el contenido del enlace de descarga
        linkDescarga.dataset.originalTitle = nombreArchivo;
        linkDescarga.innerHTML = `<i class="fa fa-download"></i> ${nombreArchivo}`;
        linkDescarga.href = `/uploads/fondo_produccion_limpia/${nombreCampo}/${id}/${nombreArchivo}`;
        linkDescarga.classList.remove('btn-disabled');
        linkDescarga.classList.add('btn-block', 'btn-descargar', 'tooltip-block');
        linkDescarga.setAttribute('download', ''); // Agregar el atributo 'download'
      } else {
        // Si no se ha cargado un archivo, restaurar el contenido predeterminado del enlace de descarga
        linkDescarga.dataset.originalTitle = "Archivo(s) no subido(s)...";
        linkDescarga.innerText = "";
        linkDescarga.href = "#";
        linkDescarga.classList.add('btn-disabled');
      }
    }

    function guardarYActualizar(event, id, nombreCampo) {
      guardarArchivos(event, id, nombreCampo);
      actualizarContenidoDescarga(id, event.target.value.split('\\').pop(), nombreCampo);
    } 
                                        
%style
  :css
    .table-responsive {
      width: 100%;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      -ms-overflow-style: -ms-autohiding-scrollbar;
    }

    .table {
      width: 100%;
      max-width: 100%;
      margin-bottom: 1rem;
      background-color: transparent;
    }

    .table tbody + tbody {
      border-top: 2px solid #dee2e6;
    }

    .table .table {
      background-color: #fff;
    }

    .table thead th {
      font-size: 12px;
      border-bottom: 2px solid #dee2e6;
      border-right: 2px solid #dee2e6; 
      border-left: 2px solid #dee2e6;
    }

    .titulo-sector {
      vertical-align: middle;
      border-bottom: 2px solid #dee2e6;
      background-color: #E0EFF6;
      text-align: center;
      font-weight: bold;
      font-size: 14px; 
    }

    .encabezado-form {
      vertical-align: middle;
      border-bottom: 2px solid #dee2e6;
      background-color: #E0EFF6;
      text-align: center;
      font-weight: bold;
    }

    .encabezado-titulo-form {
      vertical-align: middle;
      border-bottom: 0px solid #dee2e6;
      background-color: #E0EFF6;
      text-align: center;
      font-weight: bold;
    }

    .encabezado2-form {
      text-align: center; 
      border-bottom: 2px solid #dee2e6;
      vertical-align: middle; 
      background-color: #E0EFF6;
      font-weight: bold;
    }

    .contenido-form {
      border-bottom: 2px solid #dee2e6;
      border-right: 2px solid #dee2e6; 
      border-left: 2px solid #dee2e6; 
      font-size: 12px; 
      vertical-align: top;
      background-color: #fff;
      color: #5d759e;
      //font-weight: 500;     
    }

    .sub-contenido-form {
      font-size: 12px; 
      vertical-align: top;
      background-color: #fff;
      color: #5d759e !important;     
      text-align: center; 
    }

    
    .option-form {
      font-size: 12px; 
      vertical-align: top;
      background-color: #fff;
      color: #5d759e !important;     
      font-weight: bold;
    }

    .white-space {
      border-bottom: 2px solid #fff !important;
    }

    .td-popup {
      color: #0c5460 !important;
      font-size: 13px;
    }

    .contenido-popup-form {
      font-size: 12px; 
      vertical-align: top;
      background-color: #fff;
      color: #5d759e; 
      width: 100px;    
    }

    .sub-contenido-popup-form {
      font-size: 10px !important;
      vertical-align: middle;
      border-bottom: 2px solid #dee2e6;
      background-color: #E0EFF6;
      text-align: center;
      font-weight: bold;
      width: 100px;
      //height: 10px;
    }

    .label-estilo {
      color: #5d759e;
      font-weight: 400;
      font-size: 14px;
    }

    .rojo_subrayado {
      color: red;
      text-decoration: underline;
    }

    .total_verde {
      background-color: #CCFFCC;
      //background-color: #659d65;
      font-weight: bold;
    }

    .contenido1-det-form {
      border-bottom: 2px solid #dee2e6;
      font-size: 12px; 
      width: 50%;
      padding: 0.75rem;
      vertical-align: top;
    }

    .contenido2-det-form {
      border-bottom: 2px solid #dee2e6;
      font-size: 12px; 
      width: 20%;
      padding: 0.75rem;
      vertical-align: top;
      text-align: center;
    }

    .contenido3-det-form {
      border-bottom: 2px solid #dee2e6;
      font-size: 12px; 
      width: 30%;
      padding: 0.75rem;
      vertical-align: top;
      text-align: center;
    }

    .texto-rojo {
      color: red;
    }

    .smaller-text {
      font-size: 12px; 
    }

    .border-text {
      border: 1px solid #ced4da; 
      border-radius: 0.25rem;
    }

    .border-error {
      border: 1px solid #de2d0f; 
      border-radius: 0.25rem;
    }

    .mensaje-rojo {
        color: red;
    }

    .contenido-form-costo {
      border-bottom: 2px solid #dee2e6;
      border-right: 2px solid #dee2e6; 
      border-left: 2px solid #dee2e6; 
      font-size: 12px; 
      vertical-align: top;
      background-color: #fff;
      color: #5d759e;
      //font-weight: 500;
      text-align: right;
    }

    .contenido-form-center {
      border-bottom: 2px solid #dee2e6;
      border-right: 2px solid #dee2e6; 
      border-left: 2px solid #dee2e6; 
      font-size: 12px; 
      vertical-align: top;
      background-color: #fff;
      color: #5d759e;
      //font-weight: 500;
      text-align: center;
    }

    .icono-celeste {
      color: #0069d9;
    }

    .text-success {
      color: green; /* Cambia el color a verde si es necesario */
    }

    .text-danger {
      color: red; /* Color rojo para cuando la condición no se cumple */
    }

    .tooltip-error .tooltip-inner {
      background: #DE2D0F !important; /* Color de fondo en rojo */
    }

    .tooltip-error .tooltip-inner::before {
      border-top-color: #DE2D0F !important; /* Color del triángulo de la tooltip */
    }

    #total_tecnica {
      text-align: center; /* Centra horizontalmente */
      vertical-align: middle; /* Centra verticalmente */
      width: 100px; /* Ajusta el ancho si es necesario */
      height: 50px; /* Ajusta la altura si es necesario */
    }

    #total_tecnica_elementos {
      text-align: center; /* Centra horizontalmente */
      vertical-align: middle; /* Centra verticalmente */
      width: 100px; /* Ajusta el ancho si es necesario */
      height: 50px; /* Ajusta la altura si es necesario */
    }

= render 'modal_recuerde_guardar'
#fondoContent.tab-content.px-2.pt-0
  - tipo = @tipo
  - solo_lectura = @solo_lectura
  - adm_juridica = @adm_juridica
  %div{ id: "tipos", "data-tipo" => tipo }
  <input type="hidden" id="codigo_estado" name="codigo_estado" value="">
  <input type="hidden" id="campos_pendientes" name="campos_pendientes" value="">
  <input type="hidden" id="response_costos" name="response_costos" value="">
  <input type="hidden" id="contador_campos_nulos" name="contador_campos_nulos" value="">
  #sector.tab-pane.fade.disabled{"aria-expanded" => (tabs[:"sector"] ? 'true' : 'false'), "aria-labelledby" => "sector-tab", :role => "tabpanel", class: ("show active" if tabs[:"sector"])}  
    .card
      .card-body
        <h1>Caracterización Económica</h1>
        .alert.alert-primary
          %small  
            %i.fa.fa-question-circle.fa-1-5x
            Este punto permitirá contextualizar la importancia del sector productivo en la economía e identificar los aspectos más relevantes del o de los procesos productivos que pretenden abordarse con la realización del proyecto
       
        %div.table-responsive
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr
                %th.encabezado-titulo-form{colspan: 5, style: 'border-right: 0px solid #dee2e6; border-left: 2px solid #dee2e6;'}
                  Empresas del sector
              %tr
                %th{colspan: 9, style: 'text-align: right; border-right: 0px solid #dee2e6; border-left: 0px solid #dee2e6;'}
              %tr
                %th.encabezado-form{colspan: 6}Cantidad de empresas por tamaño <a href="http://www.sii.cl/estadisticas/empresas_tamano_ventas.htm" target="_blank">(clasificación SII)</a>

              %tr
                %th.encabezado2-form Micro
                %th.encabezado2-form Pequeña
                %th.encabezado2-form Mediana
                %th.encabezado2-form Grande
                %th.encabezado2-form Total
              %tr
                %th
                  = f.text_field :nombre_acuerdo, class: 'valor-a-sumar', type: 'number', id: 'micro_sector', onchange: 'sumarValores();', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'               
                %th
                  = f.text_field :nombre_acuerdo, class: 'valor-a-sumar', type: 'number', id: 'pequena_sector', onchange: 'sumarValores();', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'              
                %th
                  = f.text_field :nombre_acuerdo, class: 'valor-a-sumar', type: 'number', id: 'mediana_sector', onchange: 'sumarValores();', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                %th
                  = f.text_field :nombre_acuerdo, class: 'valor-a-sumar', type: 'number', id: 'grande_sector', onchange: 'sumarValores();', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                %th#total
          %br
        %div.table-responsive  
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @regiones.nil? || @regiones.size <= 0)}
            %thead
              %tr
                %th.encabezado-form{colspan: 6}Distribución Regional
              %tr
                %th.encabezado-form{style: 'width: 25%;'} Región
                %th.encabezado-form{style: 'width: 25%;'} 	N° de empresas del sector
              %tbody
                - @regiones.each do |region|
                  %tr
                    %td.contenido-form{style: 'vertical-align: middle;'}= region.nombre
                    %td.contenido-form 
                      = f.text_field :nombre_acuerdo, value: 0, type: 'number', id: 'numero_emp_reg', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
        
        %br
        %div.table-responsive
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr
                %th.encabezado-form{colspan: 11} Fuerza Laboral 
              %tr
                %th{colspan: 5, style: 'text-align: right; border-right: 0px solid #dee2e6; border-left: 0px solid #dee2e6;'}
              %tr
                %th.encabezado2-form{colspan: 3, style: 'width: 33,3%;'} 
                  Trabajadores permanentes promedio por empresa
                %th.white-space  
                %th.encabezado2-form{colspan: 3, style: 'width: 33,3%;'}  
                  Trabajadores temporales promedio por empresa
                %th.white-space
                %th.encabezado2-form{colspan: 3, style: 'width: 33,3%;'} 
                  Trabajadores promedio por empresa
              %tr
                %th.contenido-form Hombre
                %th.contenido-form Mujer
                %th.contenido-form Total
                %th.white-space
                %th.contenido-form Hombre
                %th.contenido-form Mujer
                %th.contenido-form Total
                %th.white-space
                %th.contenido-form Hombre
                %th.contenido-form Mujer
                %th.contenido-form Total
              %tr
                %th.contenido-form
                  = f.text_field :nombre_acuerdo, class: 'valor-permanentes', type: 'number', id: 'permanentes_hombres', onchange: 'sumarTrabajadoresPermanentes();', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                %th.contenido-form
                  = f.text_field :nombre_acuerdo, class: 'valor-permanentes', type: 'number', id: 'permanentes_mujeres', onchange: 'sumarTrabajadoresPermanentes();', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                %th#total_permanente
                %th.white-space
                %th.contenido-form
                  = f.text_field :nombre_acuerdo, class: 'valor-temporales', type: 'number', id: 'temporales_hombres', onchange: 'sumarTrabajadoresTemporales();', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                %th.contenido-form
                  = f.text_field :nombre_acuerdo, class: 'valor-temporales', type: 'number', id: 'temporales_mujeres', onchange: 'sumarTrabajadoresTemporales();', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                %th.contenido-form#total_temporales
                %th.white-space
                %th.contenido-form#total_hombres
                %th.contenido-form#total_mujeres
                %th.contenido-form#total_trabajadores
        %br
        %div.table-responsive
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr
                %th.encabezado-form{colspan: 6} Factores y variables de Producción (Certificación Ambiental)
              %tr
                %th.contenido-form
                  = f.input :nombre_acuerdo, as: :text, input_html: { }, label: false, required: true
        %br
        <h1>Caracterización Ambiental y Social</h1>
        .alert.alert-primary
          %small  
            %i.fa.fa-question-circle.fa-1-5x
            En este punto se deberán evidenciar externalidades ambientales y sociales que presenta el sector y que contextualizan la necesidad de desarrollar un APL
        %div.table-responsive       
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead  
              
              %tr
                %th.encabezado-form{colspan: 6} Identificación de Consumos
              %tr
                %th.contenido-form
                  = f.input :nombre_acuerdo, as: :text, input_html: { }, label: false, required: true
                              
                          
  #propuesta-tecnica.tab-pane.fade.disabled{"aria-expanded" => (tabs[:"propuesta-tecnica"] ? 'true' : 'false'), "aria-labelledby" => "propuesta-tecnica-tab", :role => "tabpanel", class: ("show active" if tabs[:"propuesta-tecnica"])}
    .card
      .card-body
        <h1>Objetivos del proyecto</h1>
        -# =f.label t(:objetivo_general)
        %div.table-responsive
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr
                %th.encabezado-form{colspan: 6}=t(:objetivo_general)
        %br
        .alert.alert-primary
          %small  
            %i.fa.fa-question-circle.fa-1-5x
            Apoyar a sectores productivos del país a la formación de Cultura de Producción Limpia a través del desarrollo de estrategias, programas o proyectos de comunicación hacia empresas, los trabajadores ya la comunidad en general y que pongan de relieve impactos, beneficios, mejores practicas, tecnicas, avances o innovaviones fruto de la implementación de Acuendos de Producción Limpia o de la aplicación de sistemas o estrategias de gestión productivas sustentable con una visión preventiva de la contaminacion y uso eficiente de los recursos. </br></br> <a href="http://fpl.cpl.cl/ayuda/guias/documentos/guia_1.pdf" target="_blank">Descargar Guía Nº1</a>
        %br
        %h1= t(:objetivo_específico)
        %br
        - if !solo_lectura
          - button_class = @total_de_errores_por_tab.present? ? (@objetivo_especificos.present? ? 'btn-primary' : 'btn-danger') : 'btn-primary'
          = button_tag 'Agregar Objetivo', id: 'open-modal-button', class: "btn btn-sm #{button_class} margin-bottom-20", type: 'button'

        %div#div_objetivo_especifico.table-responsive  
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr
                %th.encabezado2-form=t(:descripcion)
                %th.encabezado2-form.center=t(:metodologia)
                %th.encabezado2-form=t(:resultado)
                %th.encabezado2-form=t(:indicadores)
                - if !solo_lectura
                  %th.encabezado2-form.dos.iconos-acciones=t(:acción)
            %tbody
        %br
        <h1>Empresas que serán consideradas para la realizacion del diagnóstico sectorial</h1>
        - if @flujo.tipo_instrumento_id == TipoInstrumento::FPL_LINEA_1_1 || @flujo.tipo_instrumento_id == TipoInstrumento::FPL_LINEA_5_1 
          %div.table-responsive
            %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
              %thead
                %tr
                  %th.encabezado-form{colspan: 6}Cantidad y tamaño de las empresas consideradas para la realización del diagnóstico sectorial. <a href="http://www.sii.cl/estadisticas/empresas_tamano_ventas.htm" target="_blank">clasificación SII</a>
                %tr
                  %th.encabezado2-form Micro
                  %th.encabezado2-form Pequeña
                  %th.encabezado2-form Mediana
                  %th.encabezado2-form Grande
                  %th.encabezado2-form Total
                  
                %tr
                  -if !solo_lectura                 
                    %th
                      %label.label-estilo{ for: 'cantidad_micro_empresa' }
                        %abbr{ title: "Campo requerido" } *
                        Cantidad Micro Empresas
                      - border_class = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.cantidad_micro_empresa.nil? ? 'border-error' : 'border-text'
                      - tooltip_data = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.cantidad_micro_empresa.nil? ? { toggle: 'tooltip', placement: 'top', original_title: 'Campo no puede estar vacío' } : {}
                      = f.text_field :cantidad_micro_empresa, class: "form-control text required tooltip-block valor-a-sumar-tec #{border_class}", required: 'required', type: 'number', onchange: 'sumarValoresTec();', id: 'cantidad_micro_empresa', data: tooltip_data
                    %th
                      %label.label-estilo{ for: 'cantidad_pequeña_empresa' }
                        %abbr{ title: "Campo requerido" } *
                        Cantidad Pequeña Empresas
                      - border_class = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.cantidad_pequeña_empresa.nil? ? 'border-error' : 'border-text'
                      - tooltip_data = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.cantidad_pequeña_empresa.nil? ? { toggle: 'tooltip', placement: 'top', original_title: 'Campo no puede estar vacío' } : {}
                      = f.text_field :cantidad_pequeña_empresa, class: "form-control text required tooltip-block valor-a-sumar-tec #{border_class}", required: 'required', type: 'number', onchange: 'sumarValoresTec();', id: 'cantidad_pequeña_empresa', data: tooltip_data           
                    %th
                      %label.label-estilo{ for: 'cantidad_mediana_empresa' }
                        %abbr{ title: "Campo requerido" } *
                        Cantidad Mediana Empresas
                      - border_class = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.cantidad_mediana_empresa.nil? ? 'border-error' : 'border-text'
                      - tooltip_data = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.cantidad_mediana_empresa.nil? ? { toggle: 'tooltip', placement: 'top', original_title: 'Campo no puede estar vacío' } : {}
                      = f.text_field :cantidad_mediana_empresa, class: "form-control text required tooltip-block valor-a-sumar-tec #{border_class}", required: 'required', type: 'number', onchange: 'sumarValoresTec();', id: 'cantidad_mediana_empresa', data: tooltip_data         
                    %th
                      %label.label-estilo{ for: 'cantidad_grande_empresa' }
                        %abbr{ title: "Campo requerido" } *
                        Cantidad Grande Empresas
                      - border_class = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.cantidad_grande_empresa.nil? ? 'border-error' : 'border-text'
                      - tooltip_data = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.cantidad_grande_empresa.nil? ? { toggle: 'tooltip', placement: 'top', original_title: 'Campo no puede estar vacío' } : {}
                      = f.text_field :cantidad_grande_empresa, class: "form-control text required tooltip-block valor-a-sumar-tec #{border_class}", required: 'required', type: 'number', onchange: 'sumarValoresTec();', id: 'cantidad_grande_empresa', data: tooltip_data     
                    %th#total_tecnica
                  -else
                    %th
                      = f.object.cantidad_micro_empresa
                    %th
                      = f.object.cantidad_pequeña_empresa
                    %th
                      = f.object.cantidad_mediana_empresa
                    %th
                      = f.object.cantidad_grande_empresa                  
                    %th
                      = f.object.cantidad_micro_empresa + f.object.cantidad_pequeña_empresa + f.object.cantidad_mediana_empresa + f.object.cantidad_grande_empresa 
          %br 
            .row
              .col-12
                -if solo_lectura
                  %label.control-label.string=@validaciones[:manifestacion_de_interes][:comunas_ids][:nombre]
                  #manifestacion_de_interes_comunas_ids
                #checkbox-tree-selector-regiones-provincias-comunas.mb-3
                  -card_class = ''
                  -card_class += ' border-0' if solo_lectura
                  -card_class += ' has-error' if f.object.errors.messages.has_key?(:comunas_ids)
                  -border_class = @total_de_errores_por_tab.present? && @comuna_flujo.blank? ? 'border-error' : 'border-text'
                  -tooltip_data = @total_de_errores_por_tab.present? && @comuna_flujo.blank? ? { toggle: 'tooltip', placement: 'top', original_title: 'Campo no puede estar vacío' } : {}
                  .card.m-0.card-preview-seleccionados{class: "#{card_class} #{border_class} tooltip-block", data: tooltip_data}
                    -if !solo_lectura
                      #manifestacion_de_interes_comunas_ids.card-header.pt-2.pb-1.pl-3.titulo-sector 
                        %h5.no-margin.float-left.display_select_title
                          %abbr{title: :required} *
                          =@validaciones[:manifestacion_de_interes][:comunas_ids][:nombre]
                        .float-right
                          %i.fa.fa-chevron-right#boton_expandir_territorios
                    .card-body.py-0.required{class: (solo_lectura ? 'px-0' : 'group-hide')}
                      .row
                        .col-lg-4.pr-lg-0.p-0.beauty-tree-content{class: (solo_lectura ? 'd-none' : 'col-lg-4 col-12')}
                          =beauty_tree_selector(f.object.comunas_beauty_tree_selector ,"manifestacion_de_interes[comunas_ids][]", "comunas")
                        .col-12{class: (solo_lectura ? '' : 'col-lg-8 pl-lg-0')}
                          = f.input :proponente, as: :hidden, wrapper: false, input_html: {class: ""}
                          #representacion-seleccion-territorio-mapa{style: (solo_lectura ? 'height: 400px;' : '')}
                      - if f.object.errors.messages.has_key?(:comunas_ids)
                        %span.help-block
                          = f.object.errors.messages[:comunas_ids].first
                    -if !solo_lectura
                      .card-footer.p-0
                        %ul.list-group.seleccionados_tree.m-0
                    -else
                      .card-footer.px-0.pb-0.pt-1.border-0
                        %ul.list-group.seleccionados_tree_solo_lectura.m-0
            
            %div.table-responsive
              %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
                %thead
                  %tr
                    %th.encabezado2-form 
                      Empresas socias de la A.G. potenciales suscriptoras del APL
                    %th.encabezado2-form 
                      Empresas potenciales no socias de la A.G.       
                  %tr
                    -if !solo_lectura
                      %th{style: 'width: 50%;'}
                        %label.label-estilo{ for: 'empresas_asociadas_ag' }
                          %abbr{ title: "Campo requerido" } *
                          N° Empresas Asociadas AG: 
                        - border_class = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.empresas_asociadas_ag.nil? ? 'border-error' : 'border-text'
                        - tooltip_data = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.empresas_asociadas_ag.nil? ? { toggle: 'tooltip', placement: 'top', original_title: 'Campo no puede estar vacío' } : {}
                        = f.text_field :empresas_asociadas_ag, class: "form-control text required tooltip-block #{border_class}", required: 'required', type: 'number', id: 'empresas_asociadas_ag', data: tooltip_data 
                      %th{style: 'width: 50%;'}
                        %label.label-estilo{ for: 'empresas_no_asociadas_ag' }
                          %abbr{ title: "Campo requerido" } *
                          N° Empresas No Asociadas AG: 
                        - border_class = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.empresas_no_asociadas_ag.nil? ? 'border-error' : 'border-text'
                        - tooltip_data = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.empresas_no_asociadas_ag.nil? ? { toggle: 'tooltip', placement: 'top', original_title: 'Campo no puede estar vacío' } : {}
                        = f.text_field :empresas_no_asociadas_ag, class: "form-control text required tooltip-block #{border_class}", required: 'required', type: 'number', id: 'empresas_no_asociadas_ag', data: tooltip_data 
                    -else
                      %th
                        = f.object.empresas_asociadas_ag
                      %th
                        = f.object.empresas_no_asociadas_ag
              %br
        - else
          %div.table-responsive
            %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
              %thead
                %tr
                  %th.encabezado-form{colspan: 6}Cantidad y tamaño de las empresas consideradas para la realización del diagnóstico sectorial. <a href="http://www.sii.cl/estadisticas/empresas_tamano_ventas.htm" target="_blank">clasificación SII</a>
                %tr
                  %th.encabezado2-form 
                  %th.encabezado2-form Micro
                  %th.encabezado2-form Pequeña
                  %th.encabezado2-form Mediana
                  %th.encabezado2-form Grande
                  %th.encabezado2-form Total
                %tr
                  -if !solo_lectura
                    %th
                      Empresas Totales a Adherir
                    %th
                      %label.label-estilo{ for: 'cantidad_micro_empresa' }
                        %abbr{ title: "Campo requerido" } *
                        Cantidad Micro Empresas
                      - border_class = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.cantidad_micro_empresa.nil? ? 'border-error' : 'border-text'
                      - tooltip_data = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.cantidad_micro_empresa.nil? ? { toggle: 'tooltip', placement: 'top', original_title: 'Campo no puede estar vacío' } : {}
                      = f.text_field :cantidad_micro_empresa, class: "form-control text required tooltip-block valor-a-sumar-tec #{border_class}", required: 'required', type: 'number', onchange: 'sumarValoresTec();', id: 'cantidad_micro_empresa', data: tooltip_data 
                    %th
                      %label.label-estilo{ for: 'cantidad_pequeña_empresa' }
                        %abbr{ title: "Campo requerido" } *
                        Cantidad Pequeña Empresas
                      - border_class = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.cantidad_pequeña_empresa.nil? ? 'border-error' : 'border-text'
                      - tooltip_data = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.cantidad_pequeña_empresa.nil? ? { toggle: 'tooltip', placement: 'top', original_title: 'Campo no puede estar vacío' } : {}
                      = f.text_field :cantidad_pequeña_empresa, class: "form-control text required tooltip-block valor-a-sumar-tec #{border_class}", required: 'required', type: 'number', onchange: 'sumarValoresTec();', id: 'cantidad_pequeña_empresa', data: tooltip_data           
                    %th
                      %label.label-estilo{ for: 'cantidad_mediana_empresa' }
                        %abbr{ title: "Campo requerido" } *
                        Cantidad Mediana Empresas
                      - border_class = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.cantidad_mediana_empresa.nil? ? 'border-error' : 'border-text'
                      - tooltip_data = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.cantidad_mediana_empresa.nil? ? { toggle: 'tooltip', placement: 'top', original_title: 'Campo no puede estar vacío' } : {}
                      = f.text_field :cantidad_mediana_empresa, class: "form-control text required tooltip-block valor-a-sumar-tec #{border_class}", required: 'required', type: 'number', onchange: 'sumarValoresTec();', id: 'cantidad_mediana_empresa', data: tooltip_data         
                    %th
                      %label.label-estilo{ for: 'cantidad_grande_empresa' }
                        %abbr{ title: "Campo requerido" } *
                        Cantidad Grande Empresas
                      - border_class = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.cantidad_grande_empresa.nil? ? 'border-error' : 'border-text'
                      - tooltip_data = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.cantidad_grande_empresa.nil? ? { toggle: 'tooltip', placement: 'top', original_title: 'Campo no puede estar vacío' } : {}
                      = f.text_field :cantidad_grande_empresa, class: "form-control text required tooltip-block valor-a-sumar-tec #{border_class}", required: 'required', type: 'number', onchange: 'sumarValoresTec();', id: 'cantidad_grande_empresa', data: tooltip_data     
                    %th#total_tecnica 
                  -else
                    %th
                      Empresas Totales a Adherir
                    %th
                      = f.object.cantidad_micro_empresa
                    %th
                      = f.object.cantidad_pequeña_empresa
                    %th
                      = f.object.cantidad_mediana_empresa
                    %th
                      = f.object.cantidad_grande_empresa                  
                    %th
                      = f.object.cantidad_micro_empresa + f.object.cantidad_pequeña_empresa + f.object.cantidad_mediana_empresa + f.object.cantidad_grande_empresa 
                %tr
                  -if !solo_lectura
                    %th
                      Elementos Totales a Adherir
                    %th
                      %label.label-estilo{ for: 'elementos_micro_empresa' }
                        %abbr{ title: "Campo requerido" } *
                        Elementos Micro Empresas
                      - border_class = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.elementos_micro_empresa.nil? ? 'border-error' : 'border-text'
                      - tooltip_data = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.elementos_micro_empresa.nil? ? { toggle: 'tooltip', placement: 'top', original_title: 'Campo no puede estar vacío' } : {}
                      = f.text_field :elementos_micro_empresa, class: "form-control text required tooltip-block valor-a-sumar-tec-elementos #{border_class}", required: 'required', type: 'number', onchange: "sumarValoresTecElementos('cantidad_micro_empresa', 'elementos_micro_empresa', 'Micro');", id: 'elementos_micro_empresa', data: tooltip_data  
                    %th
                      %label.label-estilo{ for: 'elementos_pequena_empresa' }
                        %abbr{ title: "Campo requerido" } *
                        Elementos Pequeña Empresas
                      - border_class = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.elementos_pequena_empresa.nil? ? 'border-error' : 'border-text'
                      - tooltip_data = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.elementos_pequena_empresa.nil? ? { toggle: 'tooltip', placement: 'top', original_title: 'Campo no puede estar vacío' } : {}
                      = f.text_field :elementos_pequena_empresa, class: "form-control text required tooltip-block valor-a-sumar-tec-elementos #{border_class}", required: 'required', type: 'number', onchange: "sumarValoresTecElementos('cantidad_pequeña_empresa' , 'elementos_pequena_empresa', 'Pequeña');", id: 'elementos_pequena_empresa', data: tooltip_data        
                    %th
                      %label.label-estilo{ for: 'elementos_mediana_empresa' }
                        %abbr{ title: "Campo requerido" } *
                        Elementos Mediana Empresas
                      - border_class = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.elementos_mediana_empresa.nil? ? 'border-error' : 'border-text'
                      - tooltip_data = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.elementos_mediana_empresa.nil? ? { toggle: 'tooltip', placement: 'top', original_title: 'Campo no puede estar vacío' } : {}
                      = f.text_field :elementos_mediana_empresa, class: "form-control text required tooltip-block valor-a-sumar-tec-elementos #{border_class}", required: 'required', type: 'number', onchange: "sumarValoresTecElementos('cantidad_mediana_empresa', 'elementos_mediana_empresa', 'Mediana');", id: 'elementos_mediana_empresa', data: tooltip_data  
                    %th
                      %label.label-estilo{ for: 'elementos_grande_empresa' }
                        %abbr{ title: "Campo requerido" } *
                        Elementos Grande Empresas
                      - border_class = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.elementos_grande_empresa.nil? ? 'border-error' : 'border-text'
                      - tooltip_data = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.elementos_grande_empresa.nil? ? { toggle: 'tooltip', placement: 'top', original_title: 'Campo no puede estar vacío' } : {}
                      = f.text_field :elementos_grande_empresa, class: "form-control text required tooltip-block valor-a-sumar-tec-elementos #{border_class}", required: 'required', type: 'number', onchange: "sumarValoresTecElementos('cantidad_grande_empresa', 'elementos_grande_empresa', 'Grande');", id: 'elementos_grande_empresa', data: tooltip_data           
                    %th#total_tecnica_elementos
                  -else
                    %th
                      Elementos Totales a Adherir
                    %th
                      = f.object.elementos_micro_empresa
                    %th
                      = f.object.elementos_pequena_empresa
                    %th
                      = f.object.elementos_mediana_empresa
                    %th
                      = f.object.elementos_grande_empresa                  
                    %th
                      = f.object.elementos_micro_empresa + f.object.elementos_pequena_empresa + f.object.elementos_mediana_empresa + f.object.elementos_grande_empresa    
            %br
        <h1>Duración del proyecto</h1>
        %div.table-responsive{style: 'border-bottom: 0px solid #dee2e6;'} 
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr
                -if !solo_lectura
                  %th
                    = f.input :duracion, required: true, label: t(:duracion_proyecto), collection: (1..@duracion).map { |num| [num, num] }, input_html: { class: 'required-field', onchange: 'duracion()', id: 'duracion'}
                -else
                  %th
                    = f.object.duracion
        %br
       
  #equipo-trabajo.tab-pane.fade.disabled{"aria-expanded" => (tabs[:"equipo-trabajo"] ? 'true' : 'false'), "aria-labelledby" => "equipo-trabajo-tab", :role => "tabpanel", class: ("show active" if tabs[:"equipo-trabajo"])}
    .card
      .card-body
        %br
        <input type="hidden" id="Tipo_0_Option" name="Tipo_0_Option" value="0">
        <input type="hidden" id="Tipo_1_Option" name="Tipo_1_Option" value="1">
        - if current_user.is_admin? || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA) 
          -# = link_to 'Agregar', new_objetivo_especifico_fondo_produccion_limpia_path(id: @tarea_pendiente.id), class: 'btn btn-sm btn-primary margin-bottom-20 btn-sm'
        <h1>Equipo de Institución Receptora del Cofinanciamiento</h1>
        -#<h1>A) Equipo de Trabajo del Postulante  </h1>
        %br
        %div#div_postulante.table-responsive  
          - if !solo_lectura
            - button_class = @total_de_errores_por_tab.present? ? (@postulantes.present? ? 'btn-primary' : 'btn-danger') : 'btn-primary'
            = button_tag 'Agregar Postulante', id: 'open-modal-button_buscar_usuario_postulante', class: "btn btn-sm #{button_class} margin-bottom-20 btn-sm", type: 'button'
          %br
            %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
              %thead
                %tr
                  %th.encabezado2-form=t(:nombre_completo_persona)
                  %th.encabezado2-form.center=t(:rut)
                  %th.encabezado2-form=t(:telefono)
                  %th.encabezado2-form=t(:email)
                  %th.encabezado2-form=t(:profesion)
                  %th.encabezado2-form=t(:funciones_proyecto)
                  %th.encabezado2-form=t(:valor_hh)
                  %th.encabezado2-form=t(:copia_ci)
                  %th.encabezado2-form=t(:curriculum_vitae)
                  - if !solo_lectura
                    %th.encabezado2-form.dos.iconos-acciones=t(:acción)
              %tbody
                - if @postulantes.present?
                  - @postulantes.each do |postulante|
                    %tr
                      %td.contenido-form= postulante.user.nombre_completo
                      %td.contenido-form= postulante.user.rut
                      %td.contenido-form= postulante.user.telefono
                      %td.contenido-form= postulante.user.email
                      %td.contenido-form= postulante.profesion
                      %td.contenido-form= postulante.funciones_proyecto
                      %td.contenido-form= number_to_currency postulante.valor_hh
                      %td.contenido-form
                        = __descargar_archivo(postulante.copia_ci,postulante.copia_ci,false,false)
                      %td.contenido-form
                        = __descargar_archivo(postulante.curriculum,postulante.curriculum,false,false)
                      - if !solo_lectura
                        %td.contenido-form.dos.iconos-acciones{id: "iconos-acciones-#{postulante.id}"}
                          - if recurso_humano_existente?(postulante.id, postulante.flujo.id)
                            %i.fa.fa-exclamation-circle{'data-toggle'=>"tooltip", 'title'=>"El consultor no puede ser eliminado ya que se encuentra asociado a alguna actividad."}
                          - else
                            = link_to eliminar_equipo_postulante_fondo_produccion_limpia_path(user_id: postulante.id), remote: true, method: :delete, data: { user_id: postulante.id, confirm: t(:está_seguro_que_desea_borrar?, item: t(:responsable)) }, title: "Eliminar al consultor", class: 'eliminar-user-consultora', id: "eliminar-postulante-#{postulante.id}" do
                              %i.fa.fa-trash 
        </br>
        <h1>Equipo de Institución Ejecutora</h1>
        -#<h1>B) Equipo de Trabajo de la Consultora</h1>
        - if current_user.is_admin? || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA) && !solo_lectura
          -# = link_to 'Agregar', new_admin_user_path, class: 'btn btn-sm btn-primary margin-bottom-20 btn-sm' 
        -# %div.table-responsive
        -#  %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
        -#    %thead
        -#      %tr
        -#        %th.encabezado-form{colspan: 9}=t(:equipo_trabajo_consultores) 
        -# %br
          -# = link_to 'Agregar', new_objetivo_especifico_fondo_produccion_limpia_path(id: @tarea_pendiente.id), class: 'btn btn-sm btn-primary margin-bottom-20 btn-sm'
        %br
        .alert.alert-primary
          %small  
            %i.fa.fa-question-circle.fa-1-5x
            En este punto se debe indicar si se contratarán los servicios de una empresa consultora o de un equipo de consultor(es), para realizar una parte o todo el proyecto.
        - if !solo_lectura
          %div.table-responsive       
            %table 
              -#-if @count_user_empresa == 0 && @count_user_equipo == 0
              -if @tipo == 0
                %tr
                  %td= f.radio_button :nombre_acuerdo, 'opcion_1', { checked: true, class: 'required-field', id: 'opcion_1', onclick: "optionSelect(document.getElementById('Tipo_0_Option').value);" }
                  %td.option-form Empresa Consultora
                %tr
                  %td= f.radio_button :nombre_acuerdo, 'opcion_2', { class: 'required-field', id: 'opcion_2', onclick: 'optionSelect(2);'  }
                  %td.option-form Equipo de Consultores

              -#-if @count_user_empresa > 0
              -if @tipo == 2
                %tr
                  %td= f.radio_button :nombre_acuerdo, 'opcion_1', { checked: true, class: 'required-field', id: 'opcion_1', onclick: "optionSelect(document.getElementById('Tipo_1_Option').value);" }
                  %td.option-form Empresa Consultora
                %tr
                  %td= f.radio_button :nombre_acuerdo, 'opcion_2', { class: 'required-field', id: 'opcion_2', onclick: 'optionSelect(2);', disabled: 'disabled'  }
                  %td.option-form Equipo de Consultores
              
              -#-if @count_user_equipo > 0
              -if @tipo == 1
                %tr
                  %td= f.radio_button :nombre_acuerdo, 'opcion_1', { class: 'required-field', id: 'opcion_1', onclick: "optionSelect(document.getElementById('Tipo_1_Option').value);", disabled: 'disabled' }
                  %td.option-form Empresa Consultora
                %tr
                  %td= f.radio_button :nombre_acuerdo, 'opcion_2', { checked: true, class: 'required-field', id: 'opcion_2', onclick: 'optionSelect(2);'  }
                  %td.option-form Equipo de Consultores
        %br   
        %div#div_empresa_consultora.table-responsive  
          - if !solo_lectura
            - button_class = @total_de_errores_por_tab.present? ? (@empresa_equipo.present? ? 'btn-primary' : 'btn-danger') : 'btn-primary'
            = button_tag 'Agregar Empresa', id: 'open-modal-button_buscar_contribuyente', class: "btn btn-sm #{button_class} margin-bottom-20 btn-sm", type: 'button'
          %br
            %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
              %thead
                %tr
                  %th.encabezado2-form=t(:razon_social)
                  %th.encabezado2-form.center=t(:rut)
                  - if !solo_lectura
                    %th.encabezado2-form.dos.iconos-acciones=t(:acción)
              %tbody
                - if @empresa_equipo.present?
                  - @empresa_equipo.each do |empresa|
                    %tr
                      %td.contenido-form=empresa.razon_social
                      %td.contenido-form=empresa.rut
                      - if !solo_lectura
                        %td.contenido-form.dos.iconos-acciones
                          - if equipo_consultores_existente?(empresa.contribuyente_id, empresa.flujo_id)
                            %i.fa.fa-exclamation-circle{'data-toggle'=>"tooltip", 'title'=>"La empresa no puede ser eliminada ya que tiene un equipo de consultores asociados."}
                          - else
                            = link_to eliminar_empresa_fondo_produccion_limpia_path(contribuyente_id: empresa.id), remote: true, method: :delete, data: { contribuyente_id: empresa.id, confirm: t(:está_seguro_que_desea_borrar?, item: t(:contribuyente)) }, title: "Eliminar Contribuyente", class: 'eliminar-empresa', id: "eliminar-empresa-#{empresa.id}" do
                              %i.fa.fa-trash 
        -#- if @count_empresa_equipo.present? && @count_empresa_equipo > 0
        %div#div_equipo_consultora_empresa.table-responsive{ style: 'display: none;' }
          - if !solo_lectura
            - button_class = @total_de_errores_por_tab.present? ? (@user_equipo.present? ? 'btn-primary' : 'btn-danger') : 'btn-primary'
            = button_tag 'Agregar Consultor', id: 'open-modal-button_buscar_usuario_consultora', class: "btn btn-sm #{button_class} margin-bottom-20", type: 'button'
          %br
            %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
              %thead
                %tr
                  %th.encabezado2-form=t(:nombre_completo_persona)
                  %th.encabezado2-form.center=t(:rut)
                  %th.encabezado2-form=t(:telefono)
                  %th.encabezado2-form=t(:email)
                  %th.encabezado2-form=t(:profesion)
                  %th.encabezado2-form=t(:funciones_proyecto)
                  %th.encabezado2-form=t(:valor_hh)
                  %th.encabezado2-form=t(:copia_ci)
                  %th.encabezado2-form=t(:curriculum_vitae)
                  - if !solo_lectura
                    %th.encabezado2-form.dos.iconos-acciones=t(:acción)
              %tbody
                - if @user_equipo.present?
                  - @user_equipo.each do |user|
                    %tr
                      %td.contenido-form= user.user.nombre_completo
                      %td.contenido-form= user.user.rut
                      %td.contenido-form= user.user.telefono
                      %td.contenido-form= user.user.email
                      %td.contenido-form= user.profesion
                      %td.contenido-form= user.funciones_proyecto
                      %td.contenido-form= number_to_currency user.valor_hh
                      %td.contenido-form
                        = __descargar_archivo(user.copia_ci,user.copia_ci,false,false)
                      %td.contenido-form
                        = __descargar_archivo(user.curriculum,user.curriculum,false,false)
                      - if !solo_lectura
                        %td.contenido-form.dos.iconos-acciones{id: "iconos-acciones-#{user.id}"}
                          - if recurso_humano_existente?(user.id, user.flujo.id)
                            %i.fa.fa-exclamation-circle{'data-toggle'=>"tooltip", 'title'=>"El consultor no puede ser eliminado ya que se encuentra asociado a alguna actividad."}
                          - else
                            = link_to eliminar_consultor_empresa_fondo_produccion_limpia_path(user_id: user.id), remote: true, method: :delete, data: { user_id: user.id, confirm: t(:está_seguro_que_desea_borrar?, item: t(:responsable)) }, title: "Eliminar al consultor", class: 'eliminar-user-consultora_empresa', id: "eliminar-usuario_empresa-#{user.id}" do
                              %i.fa.fa-trash 
        </br>
        %div#div_equipo_consultora.table-responsive{ style: 'display: none;' }
          - if !solo_lectura
            - button_class = @total_de_errores_por_tab.present? ? (@user_equipo.present? ? 'btn-primary' : 'btn-danger') : 'btn-primary'
            = button_tag 'Agregar Consultor', id: 'open-modal-button_buscar_usuario', class: "btn btn-sm #{button_class} margin-bottom-20", type: 'button'  
          %br
            %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
              %thead
                %tr
                  %th.encabezado2-form=t(:nombre_completo_persona)
                  %th.encabezado2-form.center=t(:rut)
                  %th.encabezado2-form=t(:telefono)
                  %th.encabezado2-form=t(:email)
                  %th.encabezado2-form=t(:profesion)
                  %th.encabezado2-form=t(:funciones_proyecto)
                  %th.encabezado2-form=t(:valor_hh)
                  %th.encabezado2-form=t(:copia_ci)
                  %th.encabezado2-form=t(:curriculum_vitae)
                  - if @acceso == :admin || current_user.session[:cargos].include?(Rol::JEFE_DE_LINEA)
                    %th.encabezado2-form.dos.iconos-acciones=t(:acción)
              %tbody
                - if @user_equipo.present?
                  - @user_equipo.each do |user|
                    %tr
                      %td.contenido-form= user.user.nombre_completo
                      %td.contenido-form= user.user.rut
                      %td.contenido-form= user.user.telefono
                      %td.contenido-form= user.user.email
                      %td.contenido-form= user.profesion
                      %td.contenido-form= user.funciones_proyecto
                      %td.contenido-form= number_to_currency user.valor_hh
                      %td.contenido-form
                        = __descargar_archivo(user.copia_ci,user.copia_ci,false,false)
                      %td.contenido-form
                        = __descargar_archivo(user.curriculum,user.curriculum,false,false)
                      - if !solo_lectura
                        %td.contenido-form.dos.iconos-acciones{id: "iconos-acciones-#{user.id}"}
                          - if recurso_humano_existente?(user.id, user.flujo.id)
                            %i.fa.fa-exclamation-circle{'data-toggle'=>"tooltip", 'title'=>"El consultor no puede ser eliminado ya que se encuentra asociado a alguna actividad."}
                          - else
                            = link_to eliminar_equipo_fondo_produccion_limpia_path(user_id: user.id), remote: true, method: :delete, data: { user_id: user.id, confirm: t(:está_seguro_que_desea_borrar?, item: t(:responsable)) }, title: "Eliminar al consultor", class: 'eliminar-user-consultora', id: "eliminar-usuario-#{user.id}" do
                              %i.fa.fa-trash 
        </br>
        %div.table-responsive       
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead  
              %tr
                %th.encabezado-form{colspan: 6} Indicar fortalezas del o los consultores
              %tr
                -if !solo_lectura
                  %th
                    %label.label-estilo{ for: 'fortalezas_consultores' }
                      %abbr{ title: "Campo requerido" } *
                      Describir Fortalezas del Equipo
                      %br
                    - border_class = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.fortalezas_consultores.nil? ? 'border-error' : 'border-text'
                    - tooltip_data = @total_de_errores_por_tab.present? && @fondo_produccion_limpia.fortalezas_consultores.nil? ? { toggle: 'tooltip', placement: 'top', original_title: 'Campo no puede estar vacío' } : {}
                    = f.text_area :fortalezas_consultores, class: "form-control text required tooltip-block #{border_class}", required: 'required', type: 'text', id: 'fortalezas_consultores', style: 'width: 100%;', data: tooltip_data         
                -else
                  %th
                    = f.object.fortalezas_consultores
  #plan-de-actividades.tab-pane.fade.disabled{"aria-expanded" => (tabs[:"plan-de-actividades"] ? 'true' : 'false'), "aria-labelledby" => "plan-de-actividades-tab", :role => "tabpanel", class: ("show active" if tabs[:"plan-de-actividades"])}
    .card
      .card-header
      .card-body
        <h1>Plan de Actividades</h1>
        .alert.alert-primary
          %small  
            %i.fa.fa-question-circle.fa-1-5x
            El plan ofrece un enfoque estructurado y detallado para planificar y gestionar las diversas etapas y actividades de un proyecto, incluyendo la asignación de costos. Además, la capacidad de editar, eliminar y agregar actividades proporciona flexibilidad en la adaptación del plan a las necesidades cambiantes del proyecto.
        - if !solo_lectura
          = button_tag 'Agregar Actividad', onclick: "agregarPlanActividades()", class: 'btn btn-sm btn-primary margin-bottom-20 btn-sm', type: 'button', id: 'agregar_plan_actividades'
        %div#div_plan_actividades.table-responsive  
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle;', rowspan: 2}=t(:actividades)
                %th.encabezado-form{colspan: @duracion, style: 'text-align: center; border-right: 1px solid #dee2e6;'}=t(:duracion)
                %th.encabezado-form{colspan: 4, style: 'text-align: center; border-right: 1px solid #dee2e6;'}=t(:costos)
                -# if @acceso == :admin || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA)
                %th.encabezado-form.dos.iconos-acciones{style: 'vertical-align: middle;', rowspan: 2}=t(:acción)
              %tr
                - (1..@duracion).each do |d|
                  %th.encabezado-form=d
                %th.encabezado-form="Recursos Humanos Propios"
                %th.encabezado-form="Recursos Humanos Externos"
                %th.encabezado-form="Gastos de Operación"
                %th.encabezado-form="Gastos de Administración"
              %tbody
                - if @actividad_x_linea.present?  
                  - current_tipo_actividad = nil
                  - @actividad_x_linea.each do |actividad|
                    - if @flujo.tipo_instrumento_id != TipoInstrumento::FPL_LINEA_1_1 || @flujo.tipo_instrumento_id != TipoInstrumento::FPL_LINEA_5_1 
                      - if current_tipo_actividad != actividad.tipo_actividad
                        - current_tipo_actividad = actividad.tipo_actividad
                        %tr
                          %th.contenido-form{style: 'font-weight: bold;', colspan: (@duracion + 6)}= current_tipo_actividad == 0 ? t(:tipo_a) : t(:tipo_b)
                    %tr
                      %td.contenido-form=actividad.nombre
                      -#- if @actividad_detalle.present?
                      - detalle_existente = @actividad_detalle.find { |detalle| detalle.id == actividad.id }
                      - if detalle_existente.present?
                        - duraciones = detalle_existente.duracion.split(',')
                        - (1..@duracion).each do |d|
                          - if duraciones.include?(d.to_s)
                            %td.contenido-form{id: "mes_#{actividad.id}_#{d.to_s}"}= "X"
                          - else
                            %td.contenido-form{id: "mes_#{actividad.id}_#{d.to_s}"}= ""
                        %td.contenido-form{id: "valor_hh_tipo_3_#{actividad.id}"}= number_to_currency(detalle_existente.valor_hh_tipo_3)
                        %td.contenido-form{id: "valor_hh_tipos_1_2_#{actividad.id}"}= number_to_currency(detalle_existente.valor_hh_tipos_1_2)
                        %td.contenido-form{id: "total_gastos_tipo_1_#{actividad.id}"}= number_to_currency(detalle_existente.total_gastos_tipo_1)
                        %td.contenido-form{id: "total_gastos_tipo_2_#{actividad.id}"}= number_to_currency(detalle_existente.total_gastos_tipo_2)
                      - else
                        - (1..@duracion).each do |d|
                          %td.contenido-form{id: "mes_#{actividad.id}_#{d.to_s}"}= ""
                        %td.contenido-form{id: "valor_hh_tipo_3_#{actividad.id}"}
                        %td.contenido-form{id: "valor_hh_tipos_1_2_#{actividad.id}"}
                        %td.contenido-form{id: "total_gastos_tipo_1_#{actividad.id}"}
                        %td.contenido-form{id: "total_gastos_tipo_2_#{actividad.id}"}
                      %td.contenido-form.dos.iconos-acciones
                        = link_to "#", title: "Editar", onclick: "crearPlanActividades(#{actividad.id},#{@solo_lectura})", class: 'crear_plan_actividad', data: { actividad_id: actividad.id }, id:"crear_plan_actividad_#{actividad.id}" do
                          %i.fa.fa-edit 
  #documentacion-legal.tab-pane.fade.disabled{"aria-expanded" => (tabs[:"documentacion-legal"] ? 'true' : 'false'), "aria-labelledby" => "documentacion-legal-tab", :role => "tabpanel", class: ("show active" if tabs[:"documentacion-legal"])}
    .card
      .card-body
        <h1>Antecedentes que se deben adjuntar</h1>
        .alert.alert-primary
          %small  
            %i.fa.fa-question-circle.fa-1-5x
            Recuerde que sólo puede subir un archivo por cada fila. Pueden subir archivos pdf, word, excel o archivos comprimidos con .zip o .rar 
        <h1>A) Postulante </h1>              
        %div.table-responsive
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr
                %th.encabezado-form{style: 'width: 25%;'} Documento
                %th.encabezado-form{style: 'width: 25%;'} Descargar Archivo
                - if adm_juridica
                  %th.encabezado-form{style: 'width: 25%;'} Subir Documento
              %tbody
                - @descargables_postulante.each do |descargable|
                  %tr{id: "fila_#{descargable.id}", data: { original_title: "", title: "" }}
                    %td.contenido-form{style: 'vertical-align: middle;'}
                      %abbr{ title: "Campo requerido" } *
                      = descargable.nombre
                    %td.contenido-form
                      = __descargar_archivo(f.object.send(descargable.nombre_campo), f.object)
                      -#
                        = __upload_status(f.object,descargable.nombre_campo)
                    - if adm_juridica
                      %td.contenido-form
                        - if @total_de_errores_por_tab.present?
                          - valor = @fondo_produccion_limpia.send(descargable.nombre_campo)
                          - if valor.nil? || valor.file.nil? || !valor.file.present?
                            = f.file_field descargable.nombre_campo, id: "#{descargable.nombre_campo}", name: "#{descargable.nombre_campo}", class: "form-control smaller-text border-error", onchange: "guardarYActualizar(event, '#{descargable.id}', '#{descargable.nombre_campo}')", label: false
                          - else
                            = f.file_field descargable.nombre_campo, id: "#{descargable.nombre_campo}", name: "#{descargable.nombre_campo}", class: "form-control smaller-text border-text", onchange: "guardarYActualizar(event, '#{descargable.id}', '#{descargable.nombre_campo}')", label: false
                        - else
                          = f.file_field descargable.nombre_campo, id: "#{descargable.nombre_campo}", name: "#{descargable.nombre_campo}", class: "form-control smaller-text border-text", onchange: "guardarYActualizar(event, '#{descargable.id}', '#{descargable.nombre_campo}')", label: false
        %br              
        <h1>B) Receptor cofinanciamiento </h1>              
        %div.table-responsive
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr
                %th.encabezado-form{style: 'width: 25%;'} Documento
                %th.encabezado-form{style: 'width: 25%;'} Descargar Archivo
                - if adm_juridica  
                  %th.encabezado-form{style: 'width: 25%;'} Subir Documento
              %tbody
                - @descargables_receptor.each do |descargable|
                  %tr{id: "fila_#{descargable.id}", data: { original_title: "", title: "" }}
                    %td.contenido-form{style: 'vertical-align: middle;'}
                      %abbr{ title: "Campo requerido" } *
                      = descargable.nombre
                    %td.contenido-form
                      = __descargar_archivo(f.object.send(descargable.nombre_campo), f.object)
                      -#
                        = __upload_status(f.object,descargable.nombre_campo)
                    - if adm_juridica
                      %td.contenido-form
                        - if @total_de_errores_por_tab.present?
                          - valor = @fondo_produccion_limpia.send(descargable.nombre_campo)
                          - if valor.nil? || valor.file.nil? || !valor.file.present?
                            = f.file_field descargable.nombre_campo, id: "#{descargable.nombre_campo}", name: "#{descargable.nombre_campo}", class: "form-control smaller-text border-error", onchange: "guardarYActualizar(event, '#{descargable.id}', '#{descargable.nombre_campo}')", label: false
                          - else
                            = f.file_field descargable.nombre_campo, id: "#{descargable.nombre_campo}", name: "#{descargable.nombre_campo}", class: "form-control smaller-text border-text", onchange: "guardarYActualizar(event, '#{descargable.id}', '#{descargable.nombre_campo}')", label: false
                        - else
                          = f.file_field descargable.nombre_campo, id: "#{descargable.nombre_campo}", name: "#{descargable.nombre_campo}", class: "form-control smaller-text border-text", onchange: "guardarYActualizar(event, '#{descargable.id}', '#{descargable.nombre_campo}')", label: false
        %br
        <h1>C) Ejecutor </h1>              
        %div#div_ejecutor.table-responsive  
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr
                %th.encabezado-form{style: 'width: 25%;'} Documento
                %th.encabezado-form{style: 'width: 25%;'} Descargar Archivo
                - if adm_juridica
                  %th.encabezado-form{style: 'width: 25%;'} Subir Documento
              %tbody
                - @descargables_ejecutor.each do |descargable|
                  %tr{id: "fila_#{descargable.id}", data: { original_title: "", title: "" }}
                    %td.contenido-form{style: 'vertical-align: middle;'}
                      %abbr{ title: "Campo requerido" } *
                      = descargable.nombre
                    %td.contenido-form
                      = __descargar_archivo(f.object.send(descargable.nombre_campo), f.object)
                      -#
                        = __upload_status(f.object,descargable.nombre_campo)
                    - if adm_juridica 
                      %td.contenido-form
                        - if @total_de_errores_por_tab.present?
                          - valor = @fondo_produccion_limpia.send(descargable.nombre_campo)
                          - if valor.nil? || valor.file.nil? || !valor.file.present?
                            = f.file_field descargable.nombre_campo, id: "#{descargable.nombre_campo}", name: "#{descargable.nombre_campo}", class: "form-control smaller-text border-error", onchange: "guardarYActualizar(event, '#{descargable.id}', '#{descargable.nombre_campo}')", label: false
                          - else
                            = f.file_field descargable.nombre_campo, id: "#{descargable.nombre_campo}", name: "#{descargable.nombre_campo}", class: "form-control smaller-text border-text", onchange: "guardarYActualizar(event, '#{descargable.id}', '#{descargable.nombre_campo}')", label: false
                        - else
                          = f.file_field descargable.nombre_campo, id: "#{descargable.nombre_campo}", name: "#{descargable.nombre_campo}", class: "form-control smaller-text border-text", onchange: "guardarYActualizar(event, '#{descargable.id}', '#{descargable.nombre_campo}')", label: false
  #costos.tab-pane.fade.disabled{"aria-expanded" => (tabs[:"costos"] ? 'true' : 'false'), "aria-labelledby" => "costos-tab", :role => "tabpanel", class: ("show active" if tabs[:"costos"])}
    .card
      .card-body
        <h1>Resumen</h1>
        .alert.alert-primary
          %small  
            #mensaje-costo
        %div.table-responsive 
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr{style: 'background-color: #5d759e;'}
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 40%;'}=t(:estructura_costos)
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 30%;'} $
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 30%;'}=t(:porcentaje_costo)
            %tbody
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Costo total de la propuesta
                - if @costos.present?
                  %td#costo_total_de_la_propuesta.contenido-form-costo=number_to_currency @costos['costo_total_de_la_propuesta']
                  - if @costos['costo_total_de_la_propuesta'] != 0
                    %td#porcentaje_costo_total_de_la_propuesta.contenido-form-costo=number_to_percentage((@costos['costo_total_de_la_propuesta'].to_f / @costos['costo_total_de_la_propuesta'] * 100).round(2), precision: 2)
                  - else
                    %td#porcentaje_costo_total_de_la_propuesta.contenido-form-costo 100,00%
                - else
                  %td#costo_total_de_la_propuesta.contenido-form-costo $0
                  %td#porcentaje_costo_total_de_la_propuesta.contenido-form-costo  0,00%
              %tr
                %td.contenido-form Aporte Propio Valorado
                - if @costos.present?
                  %td#aporte_propio_valorado.contenido-form-costo=number_to_currency @costos.aporte_propio_valorado
                  - if @costos['costo_total_de_la_propuesta'] != 0
                    %td#porcentaje_aporte_propio_valorado.contenido-form-costo=number_to_percentage((@costos['aporte_propio_valorado'].to_f / @costos['costo_total_de_la_propuesta'] * 100).round(2), precision: 2)
                  - else
                    %td#porcentaje_aporte_propio_valorado.contenido-form-costo 0,00%
                - else
                  %td#aporte_propio_valorado.contenido-form-costo $0
                  %td#porcentaje_aporte_propio_valorado.contenido-form-costo  0,00%
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Aporte Propio Líquido
                - if @costos.present?
                  %td#aporte_propio_liquido.contenido-form-costo=number_to_currency @costos.aporte_propio_liquido
                  - if @costos['costo_total_de_la_propuesta'] != 0
                    %td#porcentaje_aporte_propio_liquido.contenido-form-costo=number_to_percentage((@costos['aporte_propio_liquido'].to_f / @costos['costo_total_de_la_propuesta'] * 100).round(2), precision: 2)
                  - else
                    %td#porcentaje_aporte_propio_liquido.contenido-form-costo 0,00%
                - else
                  %td#aporte_propio_liquido.contenido-form-costo $0
                  %td#porcentaje_aporte_propio_liquido.contenido-form-costo  0,00%    
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Aporte Propio Total
                - if @costos.present?
                  %td#aporte_propio_total.contenido-form-costo=number_to_currency(@costos['aporte_propio_liquido'] + @costos['aporte_propio_valorado'])
                  - if @costos['costo_total_de_la_propuesta'] != 0
                    %td#porcentaje_aporte_propio_total.contenido-form-costo=number_to_percentage(((@costos['aporte_propio_liquido'].to_f + @costos['aporte_propio_valorado'].to_f) / @costos['costo_total_de_la_propuesta']  * 100).round(2), precision: 2)
                  - else
                    %td#porcentaje_aporte_propio_total.contenido-form-costo 0,00%
                - else
                  %td#aporte_propio_total.contenido-form-costo $0
                  %td#porcentaje_aporte_propio_total.contenido-form-costo  0,00%
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Aporte solicitado Fondo PL
                - if @costos.present?
                  %td#aporte_solicitado_al_fondo.contenido-form-costo=number_to_currency @costos.aporte_solicitado_al_fondo
                  - if @costos['costo_total_de_la_propuesta'] != 0
                    %td#porcentaje_aporte_solicitado_al_fondo.contenido-form-costo=number_to_percentage((@costos['aporte_solicitado_al_fondo'].to_f / @costos['costo_total_de_la_propuesta'] * 100).round(2), precision: 2)
                  - else
                    %td#porcentaje_aporte_solicitado_al_fondo.contenido-form-costo 0,00%
                - else
                  %td#aporte_solicitado_al_fondo.contenido-form-costo $0
                  %td#porcentaje_aporte_solicitado_al_fondo.contenido-form-costo  0,00%
          %br        
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr{style: 'background-color: #5d759e;'}
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 40%;'}=t(:estructura_costos_partida)
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 30%;'} $
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 30%;'}=t(:porcentaje_costo)
            %tbody
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Recursos Humanos Propios
                - if @costos.present?
                  %td#recursos_humanos_propios.contenido-form-costo=number_to_currency @costos.recursos_humanos_propios
                  - if @costos['costo_total_de_la_propuesta'] != 0
                    %td#porcentaje_recursos_humanos_propios.contenido-form-costo=number_to_percentage((@costos['recursos_humanos_propios'].to_f / @costos['costo_total_de_la_propuesta'] * 100).round(2), precision: 2)
                  - else
                    %td#porcentaje_recursos_humanos_propios.contenido-form-costo 0,00%
                - else
                  %td#recursos_humanos_propios.contenido-form-costo $0
                  %td#porcentaje_recursos_humanos_propios.contenido-form-costo  0,00%
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Recursos Humanos Externos
                - if @costos.present?
                  %td#recursos_humanos_externos.contenido-form-costo=number_to_currency @costos.recursos_humanos_externos
                  - if @costos['costo_total_de_la_propuesta'] != 0
                    %td#porcentaje_recursos_humanos_externos.contenido-form-costo=number_to_percentage((@costos['recursos_humanos_externos'].to_f / @costos['costo_total_de_la_propuesta'] * 100).round(2), precision: 2)
                  - else
                    %td#porcentaje_recursos_humanos_externos.contenido-form-costo 0,00%
                - else
                  %td#recursos_humanos_externos.contenido-form-costo $0
                  %td#porcentaje_recursos_humanos_externos.contenido-form-costo 0,00%
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Gastos de Operación
                - if @costos.present?
                  %td#gastos_operacion.contenido-form-costo=number_to_currency @costos.gastos_operacion
                  - if @costos['costo_total_de_la_propuesta'] != 0
                    %td#porcentaje_gastos_operacion.contenido-form-costo=number_to_percentage((@costos['gastos_operacion'].to_f / @costos['costo_total_de_la_propuesta'] * 100).round(2), precision: 2)
                  - else
                    %td.contenido-form-costo 0,00%
                - else
                  %td#gastos_operacion.contenido-form-costo $0
                  %td#porcentaje_gastos_operacion.contenido-form-costo  0,00%
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Gastos de Administración
                - if @costos.present?
                  %td#gastos_administrativos.contenido-form-costo=number_to_currency @costos.gastos_administrativos
                  - if @costos['costo_total_de_la_propuesta'] != 0
                    %td#porcentaje_gastos_administrativos.contenido-form-costo=number_to_percentage((@costos['gastos_administrativos'].to_f / @costos['costo_total_de_la_propuesta'] * 100).round(2), precision: 2)
                  - else
                    %td#porcentaje_gastos_administrativos.contenido-form-costo 0,00%
                - else
                  %td#gastos_administrativos.contenido-form-costo $0
                  %td#porcentaje_gastos_administrativos.contenido-form-costo  0,00%
          %br        
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr{style: 'background-color: #5d759e;'}
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 40%;', rowspan: 2}=t(:aporte_beneficiario_partida)
                %th.encabezado-form{colspan: 2, style: 'text-align: center; vertical-align: middle; width: 30%;'} Aporte Valorado
                %th.encabezado-form{colspan: 2, style: 'text-align: center; vertical-align: middle;width: 30%;'} Aporte líquido
              %tr{style: 'background-color: #5d759e;'}
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 15%;'} $
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 15%;'} %
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 15%;'} $
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 15%;'} %
            %tbody
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Recursos Humanos Propios
                - if @costos.present?
                  %td#aporte_propio_valorado_rrhh_propio.contenido-form-costo=number_to_currency @costos.aporte_propio_valorado_rrhh_propio
                  - if @costos['costo_total_de_la_propuesta'] != 0
                    %td#porcentaje_aporte_propio_valorado_rrhh_propio.contenido-form-costo=number_to_percentage((@costos['aporte_propio_valorado_rrhh_propio'].to_f / @costos['aporte_propio_valorado'] * 100).round(2), precision: 2)
                  - else
                    %td#porcentaje_aporte_propio_valorado_rrhh_propio.contenido-form-costo 0,00%
                  %td#aporte_propio_liquido_rrhh_propio.contenido-form-costo=number_to_currency @costos.aporte_propio_liquido_rrhh_propio
                  - if @costos['costo_total_de_la_propuesta'] != 0
                    %td#porcentaje_aporte_propio_liquido_rrhh_propio.contenido-form-costo=number_to_percentage((@costos['aporte_propio_liquido_rrhh_propio'].to_f / @costos['aporte_propio_liquido'] * 100).round(2), precision: 2)
                  - else
                    %td#porcentaje_aporte_propio_liquido_rrhh_propio.contenido-form-costo 0,00%
                - else
                  %td#aporte_propio_valorado_rrhh_propio.contenido-form-costo $0
                  %td#porcentaje_aporte_propio_valorado_rrhh_propio.contenido-form-costo  0,00%
                  %td#aporte_propio_liquido_rrhh_propio.contenido-form-costo $0
                  %td#porcentaje_aporte_propio_liquido_rrhh_propio.contenido-form-costo  0,00%
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Recursos Humanos Externos
                - if @costos.present?
                  %td#aporte_propio_valorado_rrhh_externo.contenido-form-costo=number_to_currency @costos.aporte_propio_valorado_rrhh_externo
                  - if @costos['costo_total_de_la_propuesta'] != 0
                    %td#porcentaje_aporte_propio_valorado_rrhh_externo.contenido-form-costo=number_to_percentage((@costos['aporte_propio_valorado_rrhh_externo'].to_f / @costos['aporte_propio_valorado'] * 100).round(2), precision: 2)
                  - else
                    %td#porcentaje_aporte_propio_valorado_rrhh_externo.contenido-form-costo 0,00%
                  %td#aporte_propio_liquido_rrhh_externo.contenido-form-costo=number_to_currency @costos.aporte_propio_liquido_rrhh_externo
                  - if @costos['costo_total_de_la_propuesta'] != 0
                    %td#porcentaje_aporte_propio_liquido_rrhh_externo.contenido-form-costo=number_to_percentage((@costos['aporte_propio_liquido_rrhh_externo'].to_f / @costos['aporte_propio_liquido'] * 100).round(2), precision: 2)
                  - else
                    %td#porcentaje_aporte_propio_liquido_rrhh_externo.contenido-form-costo 0,00%
                - else
                  %td#aporte_propio_valorado_rrhh_externo.contenido-form-costo $0
                  %td#porcentaje_aporte_propio_valorado_rrhh_externo.contenido-form-costo  0,00%
                  %td#aporte_propio_liquido_rrhh_externo.contenido-form-costo $0
                  %td#porcentaje_aporte_propio_liquido_rrhh_externo.contenido-form-costo  0,00%
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Gastos de Operación
                - if @costos.present?
                  %td#aporte_propio_valorado_gasto_operacion.contenido-form-costo=number_to_currency @costos.aporte_propio_valorado_gasto_operacion
                  - if @costos['aporte_propio_valorado'] != 0
                    %td#porcentaje_aporte_propio_valorado_gasto_operacion.contenido-form-costo=number_to_percentage((@costos['aporte_propio_valorado_gasto_operacion'].to_f / @costos['aporte_propio_valorado'] * 100).round(2), precision: 2)
                  - else
                    %td#porcentaje_aporte_propio_valorado_gasto_operacion.contenido-form-costo 0,00%
                  %td#aporte_propio_liquido_gasto_operacion.contenido-form-costo=number_to_currency @costos.aporte_propio_liquido_gasto_operacion
                  - if @costos['aporte_propio_liquido'] != 0
                    %td#porcentaje_aporte_propio_liquido_gasto_operacion.contenido-form-costo=number_to_percentage((@costos['aporte_propio_liquido_gasto_operacion'].to_f / @costos['aporte_propio_liquido'] * 100).round(2), precision: 2)
                  - else
                    %td#porcentaje_aporte_propio_liquido_gasto_operacion.contenido-form-costo 0,00%
                - else
                  %td#aporte_propio_valorado_gasto_operacion.contenido-form-costo $0
                  %td#porcentaje_aporte_propio_valorado_gasto_operacion.contenido-form-costo  0,00%
                  %td#aporte_propio_liquido_gasto_operacion.contenido-form-costo $0
                  %td#porcentaje_aporte_propio_liquido_gasto_operacion.contenido-form-costo  0,00%
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Gastos de Administración
                - if @costos.present?
                  %td#aporte_propio_valorado_gasto_administracion.contenido-form-costo=number_to_currency @costos.aporte_propio_valorado_gasto_administracion
                  - if @costos['aporte_propio_valorado'] != 0
                    %td#porcentaje_aporte_propio_valorado_gasto_administracion.contenido-form-costo=number_to_percentage((@costos['aporte_propio_valorado_gasto_administracion'].to_f / @costos['aporte_propio_valorado'] * 100).round(2), precision: 2)
                  - else
                    %td#porcentaje_aporte_propio_valorado_gasto_administracion.contenido-form-costo 0,00%
                  %td#aporte_propio_liquido_gasto_administracion.contenido-form-costo=number_to_currency @costos.aporte_propio_liquido_gasto_administracion
                  - if @costos['aporte_propio_liquido'] != 0
                    %td#porcentaje_aporte_propio_liquido_gasto_administracion.contenido-form-costo=number_to_percentage((@costos['aporte_propio_liquido_gasto_administracion'].to_f / @costos['aporte_propio_liquido'] * 100).round(2), precision: 2)
                  - else
                    %td#porcentaje_aporte_propio_liquido_gasto_administracion.contenido-form-costo 0,00%
                - else
                  %td#aporte_propio_valorado_gasto_administracion.contenido-form-costo $0
                  %td#porcentaje_aporte_propio_valorado_gasto_administracion.contenido-form-costo  0,00%
                  %td#aporte_propio_liquido_gasto_administracion.contenido-form-costo $0
                  %td#porcentaje_aporte_propio_liquido_gasto_administracion.contenido-form-costo  0,00%
          %br        
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr{style: 'background-color: #5d759e;'}
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 40%;'}=t(:aporte_fondo_partida)
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 30%;'} $
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 30%;'}=t(:porcentaje_costo)
            %tbody
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Recursos Humanos Externos
                - if @costos.present?
                  %td#aporte_solicitado_fondo_rrhh_externo.contenido-form-costo=number_to_currency @costos.aporte_solicitado_fondo_rrhh_externo
                  - if @costos['aporte_solicitado_al_fondo'] != 0
                    %td#porcentaje_aporte_solicitado_fondo_rrhh_externo.contenido-form-costo=number_to_percentage((@costos['aporte_solicitado_fondo_rrhh_externo'].to_f / @costos['aporte_solicitado_al_fondo'] * 100).round(2), precision: 2)
                  - else
                    %td#porcentaje_aporte_solicitado_fondo_rrhh_externo.contenido-form-costo 0,00%
                - else
                  %td#aporte_solicitado_fondo_rrhh_externo.contenido-form-costo $0
                  %td#porcentaje_aporte_solicitado_fondo_rrhh_externo.contenido-form-costo  0,00%
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Gastos de Operación
                - if @costos.present?
                  %td#aporte_solicitado_fondo_gasto_operacion.contenido-form-costo=number_to_currency @costos.aporte_solicitado_fondo_gasto_operacion
                  - if @costos['aporte_solicitado_al_fondo'] != 0
                    %td#porcentaje_aporte_solicitado_fondo_gasto_operacion.contenido-form-costo=number_to_percentage((@costos['aporte_solicitado_fondo_gasto_operacion'].to_f / @costos['aporte_solicitado_al_fondo'] * 100).round(2), precision: 2)
                  - else
                    %td#porcentaje_aporte_solicitado_fondo_gasto_operacion.contenido-form-costo 0,00%
                - else
                  %td#aporte_solicitado_fondo_gasto_operacion.contenido-form-costo $0
                  %td#porcentaje_aporte_solicitado_fondo_gasto_operacion.contenido-form-costo  0,00%
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Gastos de Administración
                - if @costos.present?
                  %td#aporte_solicitado_fondo_gasto_administracion.contenido-form-costo=number_to_currency @costos.aporte_solicitado_fondo_gasto_administracion
                  - if @costos['aporte_solicitado_al_fondo'] != 0
                    %td#porcentaje_aporte_solicitado_fondo_gasto_administracion.contenido-form-costo=number_to_percentage((@costos['aporte_solicitado_fondo_gasto_administracion'].to_f / @costos['aporte_solicitado_al_fondo'] * 100).round(2), precision: 2)
                  - else
                    %td#porcentaje_aporte_solicitado_fondo_gasto_administracion.contenido-form-costo 0,00%
                - else
                  %td#aporte_solicitado_fondo_gasto_administracion.contenido-form-costo $0
                  %td#porcentaje_aporte_solicitado_fondo_gasto_administracion.contenido-form-costo  0,00%
        %br
        <h1>Validación</h1>   
        - if @flujo.tipo_instrumento_id == TipoInstrumento::FPL_LINEA_1_1 || @flujo.tipo_instrumento_id == TipoInstrumento::FPL_LINEA_5_1
          %div.table-responsive 
            %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
              %thead
                %tr{style: 'background-color: #5d759e;'}
                  %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 30%;'} Glosa
                  %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 10%;'} Monto
                  %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 40%;'} Criterio
                  %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 10%;'} Límite
                  %th.encabezado-form{style: 'text-align: center; vertical-align: middle;  width: 10%;'} Cumple?
              %tbody
                %tr
                  %td.contenido-form(width="33%" class="tabla_grisC") Aporte líquido del postulante
                  - if @costos.present?
                    %td#valida_aporte_propio_liquido.contenido-form-costo=number_to_currency @costos.aporte_propio_liquido
                    %td.contenido-form Mayor o igual al #{(Gasto::PORCENTAJE_APORTE_LIQUIDO_MINIMO_DIAGNOSTICO)}% del total del proyecto
                    %td#valida_porcentaje_aporte_propio_liquido.contenido-form-costo=number_to_currency(((@costos['costo_total_de_la_propuesta'].to_f * Gasto::PORCENTAJE_APORTE_LIQUIDO_MINIMO_DIAGNOSTICO)/100))
                    %td#valida_pregunta_aporte_propio_liquido.contenido-form-center
                      - if @costos.aporte_propio_liquido >= (((@costos['costo_total_de_la_propuesta'].to_f * Gasto::PORCENTAJE_APORTE_LIQUIDO_MINIMO_DIAGNOSTICO)/100)) && @costos.costo_total_de_la_propuesta != ''
                        %span{ class: 'text-success' } SI
                      - else
                        %span{ class: 'text-danger' } NO
                  - else
                    %td#valida_aporte_propio_liquido.contenido-form-costo $0
                    %td.contenido-form Mayor o igual al #{(Gasto::PORCENTAJE_APORTE_LIQUIDO_MINIMO_DIAGNOSTICO)}% del total del proyecto
                    %td#valida_porcentaje_aporte_propio_liquido.contenido-form-costo  0,00%
                    %td#valida_pregunta_aporte_propio_liquido.contenido-form-center
                      %span{ class: 'text-danger' } NO
                %tr
                  %td.contenido-form(width="33%" class="tabla_grisC") Aporte del postulante
                  - if @costos.present?
                    %td#valida_costo_total_de_la_propuesta.contenido-form-costo=number_to_currency (@costos['aporte_propio_liquido'] + @costos['aporte_propio_valorado'])
                    %td.contenido-form Mayor o igual al #{(Gasto::PORCENTAJE_APORTE_PROPIO_MINIMO_DIAGNOSTICO)}% del total del proyecto
                    %td#valida_porcentaje_costo_total_de_la_propuesta.contenido-form-costo=number_to_currency(((@costos['costo_total_de_la_propuesta'].to_f * Gasto::PORCENTAJE_APORTE_PROPIO_MINIMO_DIAGNOSTICO)/100))
                    %td#valida_pregunta_costo_total_de_la_propuesta.contenido-form-center
                      - if (@costos['aporte_propio_liquido'] + @costos['aporte_propio_valorado']) >= (((@costos['costo_total_de_la_propuesta'].to_f * Gasto::PORCENTAJE_APORTE_PROPIO_MINIMO_DIAGNOSTICO)/100)) && @costos.costo_total_de_la_propuesta != ''
                        %span{ class: 'text-success' } SI
                      - else
                        %span{ class: 'text-danger' } NO
                  - else
                    %td#valida_costo_total_de_la_propuesta.contenido-form-costo $0
                    %td.contenido-form Mayor o igual al #{(Gasto::PORCENTAJE_APORTE_PROPIO_MINIMO_DIAGNOSTICO)}% del total del proyecto
                    %td#valida_porcentaje_costo_total_de_la_propuesta.contenido-form-costo  0,00%
                    %td#valida_pregunta_costo_total_de_la_propuesta.contenido-form-center
                      %span{ class: 'text-danger' } NO
                %tr
                  %td.contenido-form(width="33%" class="tabla_grisC") Gastos de Administración
                  - if @costos.present?
                    %td#valida_gastos_administrativos.contenido-form-costo=number_to_currency @costos.gastos_administrativos
                    %td.contenido-form Menor o igual al #{(Gasto::PORCENTAJE_GASTO_ADMINISTRACION_DIAGNOSTICO)}% del total del proyecto
                    %td#valida_porcentaje_gastos_administrativos.contenido-form-costo=number_to_currency(((@costos['costo_total_de_la_propuesta'].to_f * Gasto::PORCENTAJE_GASTO_ADMINISTRACION_DIAGNOSTICO)/100))
                    %td#valida_pregunta_gastos_administrativos.contenido-form-center
                      - if @costos.gastos_administrativos <= (((@costos['costo_total_de_la_propuesta'].to_f * Gasto::PORCENTAJE_GASTO_ADMINISTRACION_DIAGNOSTICO)/100)) && @costos.costo_total_de_la_propuesta != ''
                        %span{ class: 'text-success' } SI
                      - else
                        %span{ class: 'text-danger' } NO
                  - else
                    %td#valida_gastos_administrativos.contenido-form-costo $0
                    %td.contenido-form Mayor o igual al #{(Gasto::PORCENTAJE_GASTO_ADMINISTRACION_DIAGNOSTICO)}% del total del proyecto
                    %td#valida_porcentaje_gastos_administrativos.contenido-form-costo  0,00%
                    %td#valida_pregunta_gastos_administrativos.contenido-form-center
                      %span{ class: 'text-danger' } NO
                %tr
                  %td.contenido-form(width="33%" class="tabla_grisC") Cofinanciamiento CPL
                  - if @costos.present?
                    %td#valida_aporte_solicitado_al_fondo.contenido-form-costo=number_to_currency @costos.aporte_solicitado_al_fondo
                    %td.contenido-form Menor o igual a #{number_to_currency(tope_maximo_solicitar_diagnostico(@tarea_pendiente.flujo_id))}
                    %td#valida_porcentaje_aporte_solicitado_al_fondo.contenido-form-costo #{number_to_currency(tope_maximo_solicitar_diagnostico(@tarea_pendiente.flujo_id))}
                    %td#valida_pregunta_aporte_solicitado_al_fondo.contenido-form-center
                      - if @costos.aporte_solicitado_al_fondo <= tope_maximo_solicitar_diagnostico(@tarea_pendiente.flujo_id) && @costos.costo_total_de_la_propuesta != ''
                        %span{ class: 'text-success' } SI
                      - else
                        %span{ class: 'text-danger' } NO
                  - else
                    %td#valida_aporte_solicitado_al_fondo.contenido-form-costo $0
                    %td.contenido-form Mayor o igual al #{number_to_currency(tope_maximo_solicitar_diagnostico(@tarea_pendiente.flujo_id))}
                    %td#valida_porcentaje_aporte_solicitado_al_fondo.contenido-form-costo  0,00%
                    %td#valida_pregunta_aporte_solicitado_al_fondo.contenido-form-center
                      %span{ class: 'text-danger' } NO
          %br
        - else
          %div.table-responsive 
            %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
              %thead
                %tr{style: 'background-color: #5d759e;'}
                  %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 30%;'} Tipo de Actividades
                  %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 30%;'} Glosa
                  %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 10%;'} Monto
                  %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 40%;'} Criterio
                  %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 10%;'} Límite
                  %th.encabezado-form{style: 'text-align: center; vertical-align: middle;  width: 10%;'} Cumple?
              %tbody
                %tr
                  %td.contenido-form{style: 'text-align: left; vertical-align: middle;', rowspan: 2} De apoyo general al postulante
                  %td.contenido-form{style: 'text-align: left; vertical-align: middle;'} Aporte del postulante
                  - if @costos_seguimiento[0].present?
                    %td#apoyo_general_postulante_aporte_postulante_monto.contenido-form-costo=number_to_currency(@costos_seguimiento[0]['aporte_propio_valorado']+@costos_seguimiento[0]['aporte_propio_liquido'])
                    %td.contenido-form Mayor o igual al #{(Gasto::PORCENTAJE_APORTE_PROPIO_MINIMO_DIAGNOSTICO)}% del total de actividades de Tipo A
                    %td#apoyo_general_postulante_aporte_postulante_limite.contenido-form-costo=number_to_currency((((@costos_seguimiento[0]['aporte_solicitado_al_fondo']+@costos_seguimiento[0]['aporte_propio_valorado']+@costos_seguimiento[0]['aporte_propio_liquido']) * Gasto::PORCENTAJE_APORTE_PROPIO_MINIMO_DIAGNOSTICO)/100))
                    %td#apoyo_general_postulante_aporte_postulante_cumple.contenido-form-center
                      - if @costos_seguimiento[0]['aporte_propio_valorado']+@costos_seguimiento[0]['aporte_propio_liquido'] >= ((((@costos_seguimiento[0]['aporte_solicitado_al_fondo']+@costos_seguimiento[0]['aporte_propio_valorado']+@costos_seguimiento[0]['aporte_propio_liquido']) * Gasto::PORCENTAJE_APORTE_PROPIO_MINIMO_DIAGNOSTICO)/100)) && @costos_seguimiento[0]['aporte_propio_valorado'] != ''
                        %span{ class: 'text-success' } SI
                      - else
                        %span{ class: 'text-danger' } NO
                  - else
                    %td#apoyo_general_postulante_aporte_postulante_monto.contenido-form-costo $0
                    %td.contenido-form Mayor o igual al #{(Gasto::PORCENTAJE_APORTE_LIQUIDO_MINIMO_DIAGNOSTICO)}% del total del proyecto
                    %td#apoyo_general_postulante_aporte_postulante_limite.contenido-form-costo  $0
                    %td#apoyo_general_postulante_aporte_postulante_cumple.contenido-form-center 
                      %span{ class: 'text-danger' } NO
                %tr
                  %td.contenido-form{style: 'text-align: left; vertical-align: middle;'} Cofinanciamiento CPL
                  - if @costos_seguimiento[0].present?
                    %td#apoyo_general_postulante_cofinanciamiento_cpl_monto.contenido-form-costo=number_to_currency(@costos_seguimiento[0]['aporte_solicitado_al_fondo'].to_f)
                    %td.contenido-form Menor o igual a #{number_to_currency(tope_maximo_solicitar_diagnostico(@tarea_pendiente.flujo_id))}
                    %td#apoyo_general_postulante_cofinanciamiento_cpl_limite.contenido-form-costo #{number_to_currency(tope_maximo_solicitar_diagnostico(@tarea_pendiente.flujo_id))}
                    %td#apoyo_general_postulante_cofinanciamiento_cpl_cumple.contenido-form-center
                      - if @costos_seguimiento[0]['aporte_solicitado_al_fondo'].to_f <= tope_maximo_solicitar_diagnostico(@tarea_pendiente.flujo_id) && @costos_seguimiento[0]['aporte_solicitado_al_fondo'].to_f != ''
                        %span{ class: 'text-success' } SI
                      - else
                        %span{ class: 'text-danger' } NO
                  - else
                    %td#apoyo_general_postulante_cofinanciamiento_cpl_monto.contenido-form-costo $0
                    %td.contenido-form Menor o igual a #{number_to_currency(tope_maximo_solicitar_diagnostico(@tarea_pendiente.flujo_id))}
                    %td#apoyo_general_postulante_cofinanciamiento_cpl_limite.contenido-form-costo  $0
                    %td#apoyo_general_postulante_cofinanciamiento_cpl_cumple.contenido-form-center  
                      %span{ class: 'text-danger' } NO    
                %tr
                  %td.contenido-form{style: 'text-align: left; vertical-align: middle;', rowspan: 2} De apoyo directo a las empresas de menor tamaño
                  %td.contenido-form{style: 'text-align: left; vertical-align: middle;'} Aporte del postulante
                  - if @costos_seguimiento[1].present?
                    %td#apoyo_general_empresa_aporte_postulante_monto.contenido-form-costo=number_to_currency(@costos_seguimiento[1]['aporte_propio_valorado']+@costos_seguimiento[1]['aporte_propio_liquido'])
                    %td#apoyo_general_empresa_aporte_postulante_porcentaje.contenido-form Mayor o igual al #{number_to_percentage((@confinanciamiento_empresa[1]).round(2), precision: 2)} del total Actividades Tipo B
                    %td#apoyo_general_empresa_aporte_postulante_limite.contenido-form-costo=number_to_currency((((@costos_seguimiento[1]['aporte_solicitado_al_fondo']+@costos_seguimiento[1]['aporte_propio_valorado']+@costos_seguimiento[1]['aporte_propio_liquido']) * @confinanciamiento_empresa[1]) / 100), precision: 0, delimiter: '.')
                    %td#apoyo_general_empresa_aporte_postulante_cumple.contenido-form-center
                      - if @costos_seguimiento[1]['aporte_propio_valorado']+@costos_seguimiento[1]['aporte_propio_liquido'] >= ((((@costos_seguimiento[1]['aporte_solicitado_al_fondo']+@costos_seguimiento[1]['aporte_propio_valorado']+@costos_seguimiento[1]['aporte_propio_liquido']) * Gasto::PORCENTAJE_APORTE_POSTULANTE)/100)) && @costos_seguimiento[1]['aporte_propio_valorado'] != ''
                        %span{ class: 'text-success' } SI
                      - else
                        %span{ class: 'text-danger' } NO
                  - else
                    %td#apoyo_general_empresa_aporte_postulante_monto.contenido-form-costo $0
                    %td#apoyo_general_empresa_aporte_postulante_porcentaje.contenido-form Mayor o igual al #{number_to_percentage((@confinanciamiento_empresa[1]).round(2), precision: 2)} del total Actividades Tipo B
                    %td#apoyo_general_empresa_aporte_postulante_limite.contenido-form-costo  $0
                    %td#apoyo_general_empresa_aporte_postulante_cumple.contenido-form-center  
                      %span{ class: 'text-danger' } NO        
                %tr
                  %td.contenido-form{style: 'text-align: left; vertical-align: middle;'} Cofinanciamiento CPL
                  - if @costos_seguimiento[1].present?
                    %td#apoyo_general_empresa_cofinanciamiento_cpl_monto.contenido-form-costo=number_to_currency(@costos_seguimiento[1]['aporte_solicitado_al_fondo'].to_f)
                    %td#apoyo_general_empresa_cofinanciamiento_cpl_porcentaje.contenido-form{style: 'text-align: left; vertical-align: middle;'} Menor o igual a #{number_to_currency(@confinanciamiento_empresa[0])}
                    %td#apoyo_general_empresa_cofinanciamiento_cpl_limite.contenido-form-costo=number_to_currency(@confinanciamiento_empresa[0])
                    %td#apoyo_general_empresa_cofinanciamiento_cpl_cumple.contenido-form-center
                      - if @costos_seguimiento[1]['aporte_propio_valorado'].to_f <= tope_maximo_solicitar_diagnostico(@tarea_pendiente.flujo_id) && @costos_seguimiento[1]['aporte_propio_valorado'].to_f != ''
                        %span{ class: 'text-success' } SI
                      - else
                        %span{ class: 'text-danger' } NO
                  - else
                    %td#apoyo_general_empresa_cofinanciamiento_cpl_monto.contenido-form-costo $0
                    %td#apoyo_general_empresa_cofinanciamiento_cpl_porcentaje.contenido-form Menor o igual a #{number_to_currency(@confinanciamiento_empresa[0])}
                    %td#apoyo_general_empresa_cofinanciamiento_cpl_limite.contenido-form-costo  $0
                    %td#apoyo_general_empresa_cofinanciamiento_cpl_cumple.contenido-form-center  
                      %span{ class: 'text-danger' } NO      
                %tr
                  %td.contenido-form{style: 'text-align: left; vertical-align: middle;', rowspan: 2} Total Proyecto
                  %td.contenido-form{style: 'text-align: left; vertical-align: middle;'} Aporte líquido del postulante
                  - if @costos.present?
                    %td#total_proyecto_aporte_liquido_postulante_monto.contenido-form-costo=number_to_currency @costos.aporte_propio_liquido
                    %td.contenido-form Mayor o igual al #{(Gasto::PORCENTAJE_APORTE_LIQUIDO_MINIMO_DIAGNOSTICO)}% del total del proyecto
                    %td#total_proyecto_aporte_liquido_postulante_limite.contenido-form-costo=number_to_currency(((@costos['costo_total_de_la_propuesta'].to_f * Gasto::PORCENTAJE_APORTE_LIQUIDO_MINIMO_DIAGNOSTICO)/100))
                    %td#total_proyecto_aporte_liquido_postulante_cumple.contenido-form-center
                      - if @costos.aporte_propio_liquido >= (((@costos['costo_total_de_la_propuesta'].to_f * Gasto::PORCENTAJE_APORTE_LIQUIDO_MINIMO_DIAGNOSTICO)/100)) && @costos.costo_total_de_la_propuesta != ''
                        %span{ class: 'text-success' } SI
                      - else
                        %span{ class: 'text-danger' } NO
                  - else
                    %td#total_proyecto_aporte_liquido_postulante_monto.contenido-form-costo $0
                    %td.contenido-form Mayor o igual al #{(Gasto::PORCENTAJE_APORTE_LIQUIDO_MINIMO_DIAGNOSTICO)}% del total del proyecto
                    %td#total_proyecto_aporte_liquido_postulante_limite.contenido-form-costo $0
                    %td#total_proyecto_aporte_liquido_postulante_cumple.contenido-form-center 
                      %span{ class: 'text-danger' } NO  
                %tr
                  %td.contenido-form{style: 'text-align: left; vertical-align: middle;'} Gastos de Administración
                  - if @costos.present?
                    %td#total_proyecto_gastos_administracion_monto.contenido-form-costo=number_to_currency @costos.gastos_administrativos
                    %td.contenido-form Menor o igual al #{(Gasto::PORCENTAJE_GASTO_ADMINISTRACION_DIAGNOSTICO)}% del total del proyecto
                    %td#total_proyecto_gastos_administracion_limite.contenido-form-costo=number_to_currency(((@costos['costo_total_de_la_propuesta'].to_f * Gasto::PORCENTAJE_GASTO_ADMINISTRACION_DIAGNOSTICO)/100))
                    %td#total_proyecto_gastos_administracion_cumple.contenido-form-center
                      - if @costos.gastos_administrativos <= (((@costos['costo_total_de_la_propuesta'].to_f * Gasto::PORCENTAJE_GASTO_ADMINISTRACION_DIAGNOSTICO)/100)) && @costos.costo_total_de_la_propuesta != ''
                        %span{ class: 'text-success' } SI
                      - else
                        %span{ class: 'text-danger' } NO
                  - else
                    %td#total_proyecto_gastos_administracion_monto.contenido-form-costo $0
                    %td.contenido-form Menor o igual al #{(Gasto::PORCENTAJE_GASTO_ADMINISTRACION_DIAGNOSTICO)}% del total del proyecto
                    %td#total_proyecto_gastos_administracion_limite.contenido-form-costo $0
                    %td#total_proyecto_gastos_administracion_cumple.contenido-form-center 
                      %span{ class: 'text-danger' } NO            
  - if @revisor      
    #asignar-revisor.tab-pane.fade{"aria-expanded" => (tabs[:"asignar-revisor"] ? 'true' : 'false'), "aria-labelledby" => "asignar-revisor-tab", :role => "tabpanel", class: ("show active" if tabs[:"asignar-revisor"])}
      .card
        .card-body
          .row
            .col-12.col-lg-6
              -#= f.input :codigo_proyecto, as: :text, label: t(:codigo_proyecto), input_html: {class: "required-field", maxlength: 12, size: 12, style: 'width: 20%; line-height: 0.5;'}, required: true, id: 'codigo_proyecto'
              %label.label-estilo{ for: 'codigo_proyecto' }
                %abbr{ title: "Campo requerido" } *
                = t(:codigo_proyecto)
              %br
              = f.text_field :codigo_proyecto, class: "required-field", maxlength: 12, size: 12, style: 'width: 20%; line-height: 1; border: 1px solid #ced4da; border-radius: 0.25rem;', required: true, id: 'codigo_proyecto'
            .col-12.col-lg-6
              -#= f.input :revisor_tecnico_id, collection: @revisores_tecnicos.map{|p| [p.user.nombre_completo, p.id]}, required: true, input_html: {class: "required-field chosen-control", type: :string, "data-placeholder"=>"Seleccione un revisor técnico", id: 'revisor_tecnico_fpl_id'}, label: t(:revisor_tecnico)
              %label.label-estilo{ for: 'revisor_tecnico_id' }
                %abbr{ title: "Campo requerido" } *
                = t(:revisor_tecnico)
              %br
              = f.select :revisor_tecnico_id, [['Seleccione un revisor técnico', '']] + @revisores_tecnicos.map { |p| [p.user.nombre_completo, p.user.id] }, {}, { class: "required-field chosen-control", "data-placeholder" => "Seleccione un revisor técnico", id: 'revisor_tecnico_fpl_id' }
            .col-12.col-lg-6
              -#= f.input :revisor_financiero_id, collection: @revisores_financieros.map{|p| [p.user.nombre_completo, p.user.id]}, required: true, input_html: {class: "required-field chosen-control", type: :string, "data-placeholder"=>"Seleccione un revisor financiero", id: 'revisor_financiero_fpl_id'}, label: t(:revisor_financiero)
              %label.label-estilo{ for: 'revisor_financiero_id' }
                %abbr{ title: "Campo requerido" } *
                = t(:revisor_financiero)
              %br
              = f.select :revisor_financiero_id, [['Seleccione un revisor financiero', '']] + @revisores_financieros.map { |p| [p.user.nombre_completo, p.user.id] }, {}, { class: "required-field chosen-control", "data-placeholder" => "Seleccione un revisor financiero", id: 'revisor_financiero_fpl_id' }
            .col-12.col-lg-6
              -#= f.input :revisor_juridico_id, collection: @revisores_juridicos.map{|p| [p.user.nombre_completo, p.user.id]}, required: true, input_html: {class: "required-field chosen-control", type: :string, "data-placeholder"=>"Seleccione un revisor jurídico", id: 'revisor_juridico_fpl_id'}, label: t(:revisor_juridico)
              %label.label-estilo{ for: 'revisor_juridico_id' }
                %abbr{ title: "Campo requerido" } *
                = t(:revisor_juridico)
              %br
              = f.select :revisor_juridico_id, [['Seleccione un revisor jurídico', '']] + @revisores_juridicos.map { |p| [p.user.nombre_completo, p.user.id] }, {}, { class: "required-field chosen-control", "data-placeholder" => "Seleccione un revisor jurídico", id: 'revisor_juridico_fpl_id' }
            .col-12
              -#= f.input :comentario_asignar_revisor, as: :text, label: t(:comentario), input_html: {class: "required-field", id: 'comentario_asignar_revisor_fpl'}, required: true
              %label.label-estilo{ for: 'comentario_asignar_revisor' }
                %abbr{ title: "Campo requerido" } *
                = t(:comentario)
              %br
              -#= f.text_field :comentario_asignar_revisor, class: "required-field", id: 'comentario_asignar_revisor_fpl', required: true, style: 'width: 50%; line-height: 1; border: 1px solid #ced4da; border-radius: 0.25rem;'
              = f.text_area :comentario_asignar_revisor, class: "required-field", id: 'comentario_asignar_revisor_fpl', required: true, style: 'width: 50%; line-height: 1; border: 1px solid #ced4da; border-radius: 0.25rem; font-size: 12px; border-bottom: 2px solid #dee2e6; border-right: 2px solid #dee2e6; border-left: 2px solid #dee2e6;'
          .col-12
            .float-right
              = link_to t(:back), root_path, class: 'btn btn-sm btn-warning ml-1'
              = button_tag t(:save), 'data-disable-with' => "<i class='fa fa-spinner fa-spin'></i> Guardando...".html_safe, class: "btn btn-sm btn-primary", id: "guardar_button_revisor", onclick: 'guardarAsignarRevisores(); return false;'

  - if @admisibilidad  
    #admisibilidad.tab-pane.fade{"aria-expanded" => (tabs[:"admisibilidad"] ? 'true' : 'false'), "aria-labelledby" => "admisibilidad-tab", :role => "tabpanel", class: ("show active" if tabs[:"admisibilidad"])}
      .card
        .card-header
          .card-body
            = form_with(model: @cuestionario_fpl, url: new_cuestionario_fpl_fondo_produccion_limpia_path(@tarea_pendiente), method: :post, remote: true, html: { class: 'ajax-form' }) do |f|
              %div.table-responsive
                %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
                  %thead
                    %tr
                      %th.encabezado-form{colspan: 3}Criterio 4: COSTOS </br> Consistencia de los costos de las actividades con los aspectos técnicos abordados, cantidad y tamaño de empresas y cobertura geográfica. </br>  Se evaluará positivamente el aporte liquido del postulante, cantidad de empresas no socias y el (%) de empresas Mipymes participantes
                    %tr
                      %th.encabezado2-form Subcriterios
                      %th.encabezado2-form Nota
                      %th.encabezado2-form Justificación
                    %tr
                      %th.contenido1-form Los ítems que componen los gastos de operación y de administración son financiables de acuerdo a las bases del Fondo PL y corresponden a productos específicos e identificables
                      %th.contenido2-form
                        = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-financiera', id: 'nota_input_id_1', onchange: "habilitaObservacionesFinanciera('nota_input_id_1','obs_input_id_1')", style: 'width: 100%; text-align: center;' }
                      %th.contenido3-form
                        = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_id_1', style: 'visibility: hidden; width: 100%; text-align: center;'
                    %tr
                      %th.contenido1-form El valor de las HH de los profesionales es cercano al valor de mercado
                      %th.contenido2-form
                        = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-financiera', id: 'nota_input_id_2', onchange: "habilitaObservacionesFinanciera('nota_input_id_2','obs_input_id_2')", style: 'width: 100%; text-align: center;' }
                      %th.contenido3-form
                        = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_id_2', style: 'visibility: hidden; width: 100%; text-align: center;'
                    %tr
                      %th.contenido1-form Los costos por actividades son consistentes con los aspectos técnicos abordados, la cantidad y tamaño de las instalaciones, y su cobertura geográfica
                      %th.contenido2-form
                        = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-financiera', id: 'nota_input_id_3', onchange: "habilitaObservacionesFinanciera('nota_input_id_3','obs_input_id_3')", style: 'width: 100%; text-align: center;' }
                      %th.contenido3-form
                        = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_id_3', style: 'visibility: hidden; width: 100%; text-align: center;'
                    %tr
                      %th.contenido1-form El proyecto cuenta con participación de empresas no socias y con un alto porcentaje de empresas de menor tamaño (Se evalúa positivamente en caso de cumplimiento)
                      %th.contenido2-form
                        = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-financiera', id: 'nota_input_id_4', onchange: "habilitaObservacionesFinanciera('nota_input_id_4','obs_input_id_4')", style: 'width: 100%; text-align: center;' }
                      %th.contenido3-form
                        = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_id_4', style: 'visibility: hidden; width: 100%; text-align: center;'   
                    %tr
                      %th.contenido1-form Las actividades están correctamente formuladas en relación a las bases del Fondo PL y permiten realizar un análisis de costos
                      %th.contenido2-form
                        = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-financiera', id: 'nota_input_id_5', onchange: "habilitaObservacionesFinanciera('nota_input_id_5','obs_input_id_5')", style: 'width: 100%; text-align: center;' }
                      %th.contenido3-form
                        = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_id_5', style: 'visibility: hidden; width: 100%; text-align: center;'
                    %tr
                    %th.contenido1-form Puntaje Otorgado
                    %th.contenido2-form#promedio-notas-financiera
                    %th.contenido3-form    
          %br                                
          .col-12
            .float-right
              = link_to t(:back), root_path, class: 'btn btn-sm btn-warning ml-1'
              = button_tag t(:save), 'data-disable-with' => "<i class='fa fa-spinner fa-spin'></i> Guardando...".html_safe, class: "btn btn-sm btn-primary", id: "guardar_button", onclick: 'guardarAdmisibilidadFinanciera(); return false;'
              = button_tag 'data-disable-with' => "<i class='fa fa-spinner fa-spin'></i> Enviando...".html_safe, class: "btn btn-sm btn-success", id: "enviar_admisibilidad_financiera_button", onclick: 'enviarAdmisibilidadFinanciera(); return false;' do
                %i.fa.fa-arrow-circle-right
                =t(:enviar) 
  #observaciones-admisibilidad.tab-pane.fade{"aria-expanded" => (tabs[:"observaciones-admisibilidad"] ? 'true' : 'false'), "aria-labelledby" => "observaciones-admisibilidad-tab", :role => "tabpanel", class: ("show active" if tabs[:"observaciones-admisibilidad"])}
    .card
      .card-header
        .card-body
          = form_with(model: @cuestionario_fpl, url: new_cuestionario_fpl_fondo_produccion_limpia_path(@tarea_pendiente), method: :post, remote: true, html: { class: 'ajax-form' }) do |f|
            %div.table-responsive
              %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
                %thead
                  %tr
                    %th.encabezado-form{colspan: 3}Criterio 4: COSTOS </br> Consistencia de los costos de las actividades con los aspectos técnicos abordados, cantidad y tamaño de empresas y cobertura geográfica. </br>  Se evaluará positivamente el aporte liquido del postulante, cantidad de empresas no socias y el (%) de empresas Mipymes participantes
                  %tr
                    %th.encabezado2-form Subcriterios
                    %th.encabezado2-form Nota
                    %th.encabezado2-form Justificación
                  %tr
                    %th.contenido1-det-form Solicitud de cofinanciamiento
                    %th.contenido2-det-form#nota_input_obs_id_1 
                    %th.contenido3-det-form#obs_input_obs_id_1
                  %tr
                    %th.contenido1-form El valor de las HH de los profesionales es cercano al valor de mercado
                    %th.contenido2-det-form#nota_input_obs_id_2 
                    %th.contenido3-det-form#obs_input_obs_id_2
                  %tr
                    %th.contenido1-form Los costos por actividades son consistentes con los aspectos técnicos abordados, la cantidad y tamaño de las instalaciones, y su cobertura geográfica
                    %th.contenido2-det-form#nota_input_obs_id_3 
                    %th.contenido3-det-form#obs_input_obs_id_3
                  %tr
                    %th.contenido1-form El proyecto cuenta con participación de empresas no socias y con un alto porcentaje de empresas de menor tamaño (Se evalúa positivamente en caso de cumplimiento)
                    %th.contenido2-det-form#nota_input_obs_id_4
                    %th.contenido3-det-form#obs_input_obs_id_4 
                  %tr
                    %th.contenido1-form Las actividades están correctamente formuladas en relación a las bases del Fondo PL y permiten realizar un análisis de costos
                    %th.contenido2-det-form#nota_input_obs_id_5
                    %th.contenido3-det-form#obs_input_obs_id_5
                  %tr
                  %th.contenido1-form Puntaje Otorgado
                  %th.contenido2-form#promedio-notas-financiera
                  %th.contenido3-form    
        %br                                
        .col-12
          .float-right
            = link_to t(:back), root_path, class: 'btn btn-sm btn-warning ml-1'
            -#= button_tag t(:save), 'data-disable-with' => "<i class='fa fa-spinner fa-spin'></i> Guardando...".html_safe, class: "btn btn-sm btn-primary", id: "guardar_button", onclick: 'guardarAdmisibilidadFinanciera(); return false;'
            = button_tag 'data-disable-with' => "<i class='fa fa-spinner fa-spin'></i> Enviando...".html_safe, class: "btn btn-sm btn-success", id: "enviar_admisibilidad_financiera_button", onclick: 'enviarObservacionesAdmisibilidadFinanciera(); return false;' do
              %i.fa.fa-arrow-circle-right
              =t(:enviar)                 
  #admisibilidad-tecnica.tab-pane.fade{"aria-expanded" => (tabs[:"admisibilidad-tecnica"] ? 'true' : 'false'), "aria-labelledby" => "admisibilidad-tecnica-tab", :role => "tabpanel", class: ("show active" if tabs[:"admisibilidad-tecnica"])}
    .card
      .card-header
        .card-body
          = form_with(model: @cuestionario_fpl, url: new_cuestionario_fpl_fondo_produccion_limpia_path(@tarea_pendiente), method: :post, remote: true, html: { class: 'ajax-form' }) do |f|
            %div.table-responsive
              %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
                %thead
                  %tr
                    %th.encabezado-form{colspan: 3} Criterio 1: FORMULACION TECNICA DEL PROYECTO </br> Mérito y calidad técnica del proyecto en cuanto a su formulación, consistencia con los objetivos, metodología, plan de trabajo y resultados esperados
                  %tr
                    %th.encabezado2-form Subcriterios
                    %th.encabezado2-form Nota
                    %th.encabezado2-form Justificación
                  %tr
                    %th.contenido1-form Los objetivos están correctamente planteados y su cumplimiento es verificable al finalizar el proyecto
                    %th.contenido2-form 
                      = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-tecnica', id: 'nota_input_tecnica_id_1', onchange: "habilitaObservacionesTecnica('nota_input_tecnica_id_1','obs_input_tecnica_id_1')", style: 'width: 100%; text-align: center;' }
                    %th.contenido3-form                             
                      = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_tecnica_id_1', style: 'visibility: hidden; width: 100%; text-align: center;'
                  %tr
                    %th.contenido1-form La metodología es consistente con el cumplimiento de los objetivos. ( Incluye la definición del tamaño muestral)
                    %th.contenido2-form 
                      = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-tecnica', id: 'nota_input_tecnica_id_2', onchange: "habilitaObservacionesTecnica('nota_input_tecnica_id_2','obs_input_tecnica_id_2')", style: 'width: 100%; text-align: center;' }
                    %th.contenido3-form  
                      = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_tecnica_id_2', style: 'visibility: hidden; width: 100%; text-align: center;'
                  %tr
                    %th.contenido1-form Las actividades propuestas son adecuadas y pertinentes para conseguir los productos y objetivos del proyecto
                    %th.contenido2-form 
                      = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-tecnica', id: 'nota_input_tecnica_id_3', onchange: "habilitaObservacionesTecnica('nota_input_tecnica_id_3','obs_input_tecnica_id_3')", style: 'width: 100%; text-align: center;' }
                    %th.contenido3-form         
                      = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_tecnica_id_3', style: 'visibility: hidden; width: 100%; text-align: center;'
                  %tr
                    %th.contenido1-form La organización del equipo de trabajo y las horas destinadas están acorde con las actividades del proyecto
                    %th.contenido2-form 
                      = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-tecnica', id: 'nota_input_tecnica_id_4', onchange: "habilitaObservacionesTecnica('nota_input_tecnica_id_4','obs_input_tecnica_id_4')", style: 'width: 100%; text-align: center;' }
                    %th.contenido3-form     
                      = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_tecnica_id_4', style: 'visibility: hidden; width: 100%; text-align: center;'
                  %tr
                    %th.contenido1-form Puntaje Otorgado
                    %th.contenido2-form#promedio-notas-tecnica 
                    %th.contenido3-form   
                %thead
                  %tr
                    %th{colspan: 3, style: 'background-color: #fff;'}
                  %tr
                    %th.encabezado-form{colspan: 3} Criterio 2: INDICADORES Y RESULTADOS </br> Se evaluaran los indicadores de impacto y resultados en cuanto cumplan con los objetivos planteados y el valor agregado en términos ambientales, </br> productivos y económicos y sobre los trabajadores
                  %tr
                    %th.encabezado2-form Subcriterios
                    %th.encabezado2-form Nota
                    %th.encabezado2-form Justificación
                  %tr
                    %th.contenido1-form Los indicadores de resultado están correcta y claramente planteados
                    %th.contenido2-form 
                      = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-tecnica-2', id: 'nota_input_tecnica_id_5', onchange: "habilitaObservacionesTecnica2('nota_input_tecnica_id_5','obs_input_tecnica_id_5')", style: 'width: 100%; text-align: center;' }
                    %th.contenido3-form 
                      = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_tecnica_id_5', style: 'visibility: hidden; width: 100%; text-align: center;'
                  %tr
                    %th.contenido1-form Puntaje Otorgado
                    %th.contenido2-form#promedio-notas-tecnica-2
                    %th.contenido3-form   
                %thead
                  %tr
                    %th{colspan: 3, style: 'background-color: #fff;'}
                  %tr
                    %th.encabezado-form{colspan: 3} Criterio 3: IDONEIDAD Y COMPETENCIA DE CONSULTORIA Y/O AUDITORIAS </br> Evaluar si la consultora o auditores contratados por el beneficiario son idóneos y correspondientes a las labores del proyecto
                  %tr
                    %th.encabezado2-form Subcriterios
                    %th.encabezado2-form Nota
                    %th.encabezado2-form Justificación
                  %tr
                    %th.contenido1-form La empresa consultora y el equipo de trabajo reúnen la formación y especialización necesaria para abordar las temáticas del proyecto
                    %th.contenido2-form 
                      = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-tecnica-3', id: 'nota_input_tecnica_id_6', onchange: "habilitaObservacionesTecnica3('nota_input_tecnica_id_6','obs_input_tecnica_id_6')", style: 'width: 100%; text-align: center;'}
                    %th.contenido3-form 
                      = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_tecnica_id_6', style: 'visibility: hidden; width: 100%; text-align: center;'
                  %tr
                    %th.contenido1-form La empresa consultora y el equipo de trabajo reúnen la experiencia en el desarrollo de proyectos en ámbitos productivos, ambientales y en el sector productivo abordado
                    %th.contenido2-form 
                      = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-tecnica-3', id: 'nota_input_tecnica_id_7', onchange: "habilitaObservacionesTecnica3('nota_input_tecnica_id_7','obs_input_tecnica_id_7')", style: 'width: 100%; text-align: center;' }
                    %th.contenido3-form  
                      = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_tecnica_id_7', style: 'visibility: hidden; width: 100%; text-align: center;'
                  %tr
                    %th.contenido1-form El equipo de trabajo resulta suficiente para abordar el proyecto
                    %th.contenido2-form 
                      = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-tecnica-3', id: 'nota_input_tecnica_id_8', onchange: "habilitaObservacionesTecnica3('nota_input_tecnica_id_8','obs_input_tecnica_id_8')", style: 'width: 100%; text-align: center;' }
                    %th.contenido3-form    
                      = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_tecnica_id_8', style: 'visibility: hidden; width: 100%; text-align: center;'
                  %tr
                    %th.contenido1-form Puntaje Otorgado
                    %th.contenido2-form#promedio-notas-tecnica-3
                    %th.contenido3-form
          %br             
          .col-12
            .float-right
              = link_to t(:back), root_path, class: 'btn btn-sm btn-warning ml-1'
              = button_tag t(:save), 'data-disable-with' => "<i class='fa fa-spinner fa-spin'></i> Guardando...".html_safe, class: "btn btn-sm btn-primary", id: "guardar_button_admisibilidad_tecnica", onclick: 'guardarAdmisibilidadTecnica(); return false;'
              = button_tag 'data-disable-with' => "<i class='fa fa-spinner fa-spin'></i> Enviando...".html_safe, class: "btn btn-sm btn-success", id: "enviar_admisibilidad_tecnica_button", onclick: 'enviarAdmisibilidadTecnica(); return false;' do
                %i.fa.fa-arrow-circle-right
                =t(:enviar)            
  #admisibilidad-juridica.tab-pane.fade{"aria-expanded" => (tabs[:"admisibilidad-juridica"] ? 'true' : 'false'), "aria-labelledby" => "admisibilidad-juridica-tab", :role => "tabpanel", class: ("show active" if tabs[:"admisibilidad-juridica"])}
    .card
      .card-header
        .card-body
          = form_with(model: @cuestionario_fpl, url: new_cuestionario_fpl_fondo_produccion_limpia_path(@tarea_pendiente), method: :post, remote: true, html: { class: 'ajax-form' }) do |f|
            %div.table-responsive
              %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
                %thead
                  %tr
                    %th.encabezado2-form Criterios
                    %th.encabezado2-form ¿Cumple?
                    %th.encabezado2-form Observación
                  %tr
                    %th.contenido1-form Solicitud de cofinanciamiento
                    %th.contenido2-form 
                      = f.select :nota, [['Cumple', '1'],['No Cumple', '2']], {}, { required: true, label: false, class: 'required-field nota_input_juridica_id_1', id: 'nota_input_juridica_id_1', onchange: "habilitaObservacionesJuridica('nota_input_juridica_id_1','obs_input_juridica_id_1')", style: 'width: 100%; text-align: center;' }
                    %th.contenido3-form 
                      = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_juridica_id_1', style: 'visibility: hidden; width: 100%; text-align: center;'
                  %tr
                    %th.contenido1-form Certificado de vigencia otorgado por la Entidad que lo tutela con fecha no anterior a 60 días de la fecha de postulación
                    %th.contenido2-form 
                      = f.select :nota, [['Cumple', '1'],['No Cumple', '2']], {}, { required: true, label: false, class: 'required-field nota_input_juridica_id_2', id: 'nota_input_juridica_id_2', onchange: "habilitaObservacionesJuridica('nota_input_juridica_id_2','obs_input_juridica_id_2')", style: 'width: 100%; text-align: center;' }
                    %th.contenido3-form                           
                      = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_juridica_id_2', style: 'visibility: hidden; width: 100%; text-align: center;'
                  %tr
                    %th.contenido1-form Copia simple del Rol Único Tributario de la organización postulante
                    %th.contenido2-form 
                      = f.select :nota, [['Cumple', '1'],['No Cumple', '2']], {}, { required: true, label: false, class: 'required-field nota_input_juridica_id_3', id: 'nota_input_juridica_id_3', onchange: "habilitaObservacionesJuridica('nota_input_juridica_id_3','obs_input_juridica_id_3')", style: 'width: 100%; text-align: center;' }
                    %th.contenido3-form   
                      = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_juridica_id_3', style: 'visibility: hidden; width: 100%; text-align: center;'
                  %tr
                    %th.contenido1-form Copia simple de la cédula de identidad del o los representantes legales
                    %th.contenido2-form 
                      = f.select :nota, [['Cumple', '1'],['No Cumple', '2']], {}, { required: true, label: false, class: 'required-field nota_input_juridica_id_4', id: 'nota_input_juridica_id_4', onchange: "habilitaObservacionesJuridica('nota_input_juridica_id_4','obs_input_juridica_id_4')", style: 'width: 100%; text-align: center;' }
                    %th.contenido3-form         
                      = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_juridica_id_4', style: 'visibility: hidden; width: 100%; text-align: center;'
                  %tr
                    %th.contenido1-form Declaración jurada firmada por el representante legal de la fundación que acredite que se encuentra al día en el pago de las cotizaciones previsionales, se encuentra al día en el pago de las cotizaciones del seguro de desempleo y su propuesta no presenta duplicidad de financiamiento con otras iniciativas equivalentes financiables, ya sea por la Corporación de Fomento de la Producción u otras fuentes de financiamiento públicas
                    %th.contenido2-form 
                      = f.select :nota, [['Cumple', '1'],['No Cumple', '2']], {}, { required: true, label: false, class: 'required-field nota_input_juridica_id_5', id: 'nota_input_juridica_id_5', onchange: "habilitaObservacionesJuridica('nota_input_juridica_id_5','obs_input_juridica_id_5')", style: 'width: 100%; text-align: center;' }
                    %th.contenido3-form      
                      = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_juridica_id_5', style: 'visibility: hidden; width: 100%; text-align: center;'
                  %tr
                    %th.contenido1-form Declaración jurada suscrita por el representante legal de la organización postulante que acredite que la entidad no incurre en ninguna de las siguientes prohibiciones: a) Haber sido condenada por prácticas antisindicales o infracción a los derechos fundamentales del trabajador, dentro de los 2 años anteriores; y b) Tratarse de una entidad de la que formen parte de modo alguno, funcionarios directivos del Consejo Nacional de Producción Limpia, o personas que tengan la calidad de cónyuge, hijo, adoptado, o pariente hasta el tercer grado de consanguinidad y segundo de afinidad, inclusive, respecto de un directivo del Consejo Nacional de Producción Limpia
                    %th.contenido2-form 
                      = f.select :nota, [['Cumple', '1'],['No Cumple', '2']], {}, { required: true, label: false, class: 'required-field nota_input_juridica_id_6', id: 'nota_input_juridica_id_6', onchange: "habilitaObservacionesJuridica('nota_input_juridica_id_6','obs_input_juridica_id_6')", style: 'width: 100%; text-align: center;' }
                    %th.contenido3-form    
                      = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_juridica_id_6', style: 'visibility: hidden; width: 100%; text-align: center;'
                  %tr
                    %th.contenido1-form Empresas consultoras: Copia de la escritura en la que consta su constitución legal, personería o representación legal vigente, y modificaciones posteriores, si las hubiere; copia de las publicaciones en extracto en el Diario Oficial y de las inscripciones en los Registros correspondientes, de las escrituras señaladas; y certificado de vigencia del Registro de Comercio, con fecha no anterior a tres meses contados desde la fecha de su presentación
                    %th.contenido2-form 
                      = f.select :nota, [['Cumple', '1'],['No Cumple', '2']], {}, { required: true, label: false, class: 'required-field nota_input_juridica_id_7', id: 'nota_input_juridica_id_7', onchange: "habilitaObservacionesJuridica('nota_input_juridica_id_7','obs_input_juridica_id_7')", style: 'width: 100%; text-align: center;' }
                    %th.contenido3-form    
                      = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_juridica_id_7', style: 'visibility: hidden; width: 100%; text-align: center;'
                  %tr
                    %th.contenido1-form Empresas consultoras: declaración jurada suscrita por el representante legal que acredite que la empresa no incurre en ninguna de las siguientes prohibiciones: a) Haber sido condenada por prácticas antisindicales o infracción a los derechos fundamentales del trabajador; b) Tratarse de una sociedad de personas de la que formen parte funcionarios directivos del Consejo Nacional de Producción Limpia; c) Tratarse de una sociedad comandita por acciones o anónima cerrada en que sean accionistas funcionarios directivos del Consejo Nacional de Producción Limpia; y d) Tratarse de una sociedad anónima abierta en que un funcionario directivo del Consejo Nacional de Producción Limpia sea dueño de acciones que representen el 10% o más del capital
                    %th.contenido2-form 
                      = f.select :nota, [['Cumple', '1'],['No Cumple', '2']], {}, { required: true, label: false, class: 'required-field nota_input_juridica_id_8', id: 'nota_input_juridica_id_8', onchange: "habilitaObservacionesJuridica('nota_input_juridica_id_8','obs_input_juridica_id_8')", style: 'width: 100%; text-align: center;' }
                    %th.contenido3-form 
                      = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_juridica_id_8', style: 'visibility: hidden; width: 100%; text-align: center;'
          %br 
          .col-12
            .float-right
              = link_to t(:back), root_path, class: 'btn btn-sm btn-warning ml-1'
              = button_tag t(:save), 'data-disable-with' => "<i class='fa fa-spinner fa-spin'></i> Guardando...".html_safe, class: "btn btn-sm btn-primary", id: "guardar_button_admisibilidad_juridica", onclick: 'guardarAdmisibilidadJuridica(); return false;'
              = button_tag 'data-disable-with' => "<i class='fa fa-spinner fa-spin'></i> Enviando...".html_safe, class: "btn btn-sm btn-success", id: "enviar_admisibilidad_juridica_button" , onclick: 'enviarAdmisibilidadJuridica(); return false;' do
                %i.fa.fa-arrow-circle-right
                =t(:enviar) 
  #observaciones-admisibilidad-tecnica.tab-pane.fade{"aria-expanded" => (tabs[:"observaciones-admisibilidad-tecnica"] ? 'true' : 'false'), "aria-labelledby" => "observaciones-admisibilidad-tecnica-tab", :role => "tabpanel", class: ("show active" if tabs[:"observaciones-admisibilidad-tecnica"])}
    .card
      .card-header
        .card-body
          = form_with(model: @cuestionario_fpl, url: new_cuestionario_fpl_fondo_produccion_limpia_path(@tarea_pendiente), method: :post, remote: true, html: { class: 'ajax-form' }) do |f|
            %div.table-responsive
              %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
                %thead
                  %tr
                    %th.encabezado-form{colspan: 3} Criterio 1: FORMULACION TECNICA DEL PROYECTO </br> Mérito y calidad técnica del proyecto en cuanto a su formulación, consistencia con los objetivos, metodología, plan de trabajo y resultados esperados
                  %tr
                    %th.encabezado2-form Subcriterios
                    %th.encabezado2-form Nota
                    %th.encabezado2-form Justificación
                  %tr
                    %th.contenido1-form Los objetivos están correctamente planteados y su cumplimiento es verificable al finalizar el proyecto
                    %th.contenido2-form#nota_input_tecnica_obs_id_1
                    %th.contenido3-form#obs_input_tecnica_obs_id_1
                  %tr
                    %th.contenido1-form La metodología es consistente con el cumplimiento de los objetivos. ( Incluye la definición del tamaño muestral)
                    %th.contenido2-form#nota_input_tecnica_obs_id_2
                    %th.contenido3-form#obs_input_tecnica_obs_id_2
                  %tr
                    %th.contenido1-form Las actividades propuestas son adecuadas y pertinentes para conseguir los productos y objetivos del proyecto
                    %th.contenido2-form#nota_input_tecnica_obs_id_3
                    %th.contenido3-form#obs_input_tecnica_obs_id_3
                  %tr
                    %th.contenido1-form La organización del equipo de trabajo y las horas destinadas están acorde con las actividades del proyecto
                    %th.contenido2-form#nota_input_tecnica_obs_id_4
                    %th.contenido3-form#obs_input_tecnica_obs_id_4
                  %tr
                    %th.contenido1-form Puntaje Otorgado
                    %th.contenido2-form#promedio-notas-tecnica 
                    %th.contenido3-form   
                %thead
                  %tr
                    %th{colspan: 3, style: 'background-color: #fff;'}
                  %tr
                    %th.encabezado-form{colspan: 3} Criterio 2: INDICADORES Y RESULTADOS </br> Se evaluaran los indicadores de impacto y resultados en cuanto cumplan con los objetivos planteados y el valor agregado en términos ambientales, </br> productivos y económicos y sobre los trabajadores
                  %tr
                    %th.encabezado2-form Subcriterios
                    %th.encabezado2-form Nota
                    %th.encabezado2-form Justificación
                  %tr
                    %th.contenido1-form Los indicadores de resultado están correcta y claramente planteados
                    %th.contenido2-form#nota_input_tecnica_obs_id_5
                    %th.contenido3-form#obs_input_tecnica_obs_id_5
                  %tr
                    %th.contenido1-form Puntaje Otorgado
                    %th.contenido2-form#promedio-notas-tecnica-2
                    %th.contenido3-form   
                %thead
                  %tr
                    %th{colspan: 3, style: 'background-color: #fff;'}
                  %tr
                    %th.encabezado-form{colspan: 3} Criterio 3: IDONEIDAD Y COMPETENCIA DE CONSULTORIA Y/O AUDITORIAS </br> Evaluar si la consultora o auditores contratados por el beneficiario son idóneos y correspondientes a las labores del proyecto
                  %tr
                    %th.encabezado2-form Subcriterios
                    %th.encabezado2-form Nota
                    %th.encabezado2-form Justificación
                  %tr
                    %th.contenido1-form La empresa consultora y el equipo de trabajo reúnen la formación y especialización necesaria para abordar las temáticas del proyecto
                    %th.contenido2-form#nota_input_tecnica_obs_id_6
                    %th.contenido3-form#obs_input_tecnica_obs_id_6
                  %tr
                    %th.contenido1-form La empresa consultora y el equipo de trabajo reúnen la experiencia en el desarrollo de proyectos en ámbitos productivos, ambientales y en el sector productivo abordado
                    %th.contenido2-form#nota_input_tecnica_obs_id_7
                    %th.contenido3-form#obs_input_tecnica_obs_id_7
                  %tr
                    %th.contenido1-form El equipo de trabajo resulta suficiente para abordar el proyecto
                    %th.contenido2-form#nota_input_tecnica_obs_id_8
                    %th.contenido3-form#obs_input_tecnica_obs_id_8
                  %tr
                    %th.contenido1-form Puntaje Otorgado
                    %th.contenido2-form#promedio-notas-tecnica-3
                    %th.contenido3-form
          %br             
          .col-12
            .float-right
              = link_to t(:back), root_path, class: 'btn btn-sm btn-warning ml-1'
              -#= button_tag t(:save), 'data-disable-with' => "<i class='fa fa-spinner fa-spin'></i> Guardando...".html_safe, class: "btn btn-sm btn-primary", id: "guardar_button", onclick: 'guardarAdmisibilidadTecnica(); return false;'
              = button_tag 'data-disable-with' => "<i class='fa fa-spinner fa-spin'></i> Enviando...".html_safe, class: "btn btn-sm btn-success", id: "enviar_admisibilidad_tecnica_button", onclick: 'enviarObservacionesAdmisibilidadTecnica(); return false;' do
                %i.fa.fa-arrow-circle-right
                =t(:enviar) 

  #observaciones-admisibilidad-juridica.tab-pane.fade{"aria-expanded" => (tabs[:"observaciones-admisibilidad-juridica"] ? 'true' : 'false'), "aria-labelledby" => "observaciones-admisibilidad-juridica-tab", :role => "tabpanel", class: ("show active" if tabs[:"observaciones-admisibilidad-juridica"])}
    .card
      .card-header
        .card-body
          = form_with(model: @cuestionario_fpl, url: new_cuestionario_fpl_fondo_produccion_limpia_path(@tarea_pendiente), method: :post, remote: true, html: { class: 'ajax-form' }) do |f|
            %div.table-responsive
              %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
                %thead
                  %tr
                    %th.encabezado2-form Criterios
                    %th.encabezado2-form ¿Cumple?
                    %th.encabezado2-form Observación
                  %tr
                    %th.contenido1-det-form Solicitud de cofinanciamiento
                    %th.contenido2-det-form#nota_input_juridica_obs_id_1 
                    %th.contenido3-det-form#obs_input_juridica_obs_id_1
                  %tr
                    %th.contenido1-det-form Certificado de vigencia otorgado por la Entidad que lo tutela con fecha no anterior a 60 días de la fecha de postulación
                    %th.contenido2-det-form#nota_input_juridica_obs_id_2 
                    %th.contenido3-det-form#obs_input_juridica_obs_id_2                           
                  %tr
                    %th.contenido1-det-form Copia simple del Rol Único Tributario de la organización postulante
                    %th.contenido2-det-form#nota_input_juridica_obs_id_3
                    %th.contenido3-det-form#obs_input_juridica_obs_id_3   
                  %tr
                    %th.contenido1-det-form Copia simple de la cédula de identidad del o los representantes legales
                    %th.contenido2-det-form#nota_input_juridica_obs_id_4
                    %th.contenido3-det-form#obs_input_juridica_obs_id_4          
                  %tr
                    %th.contenido1-det-form Declaración jurada firmada por el representante legal de la fundación que acredite que se encuentra al día en el pago de las cotizaciones previsionales, se encuentra al día en el pago de las cotizaciones del seguro de desempleo y su propuesta no presenta duplicidad de financiamiento con otras iniciativas equivalentes financiables, ya sea por la Corporación de Fomento de la Producción u otras fuentes de financiamiento públicas
                    %th.contenido2-det-form#nota_input_juridica_obs_id_5
                    %th.contenido3-det-form#obs_input_juridica_obs_id_5       
                  %tr
                    %th.contenido1-det-form Declaración jurada suscrita por el representante legal de la organización postulante que acredite que la entidad no incurre en ninguna de las siguientes prohibiciones: a) Haber sido condenada por prácticas antisindicales o infracción a los derechos fundamentales del trabajador, dentro de los 2 años anteriores; y b) Tratarse de una entidad de la que formen parte de modo alguno, funcionarios directivos del Consejo Nacional de Producción Limpia, o personas que tengan la calidad de cónyuge, hijo, adoptado, o pariente hasta el tercer grado de consanguinidad y segundo de afinidad, inclusive, respecto de un directivo del Consejo Nacional de Producción Limpia
                    %th.contenido2-det-form#nota_input_juridica_obs_id_6 
                    %th.contenido3-det-form#obs_input_juridica_obs_id_6    
                  %tr
                    %th.contenido1-det-form Empresas consultoras: Copia de la escritura en la que consta su constitución legal, personería o representación legal vigente, y modificaciones posteriores, si las hubiere; copia de las publicaciones en extracto en el Diario Oficial y de las inscripciones en los Registros correspondientes, de las escrituras señaladas; y certificado de vigencia del Registro de Comercio, con fecha no anterior a tres meses contados desde la fecha de su presentación
                    %th.contenido2-det-form#nota_input_juridica_obs_id_7
                    %th.contenido3-det-form#obs_input_juridica_obs_id_7     
                  %tr
                    %th.contenido1-det-form Empresas consultoras: declaración jurada suscrita por el representante legal que acredite que la empresa no incurre en ninguna de las siguientes prohibiciones: a) Haber sido condenada por prácticas antisindicales o infracción a los derechos fundamentales del trabajador; b) Tratarse de una sociedad de personas de la que formen parte funcionarios directivos del Consejo Nacional de Producción Limpia; c) Tratarse de una sociedad comandita por acciones o anónima cerrada en que sean accionistas funcionarios directivos del Consejo Nacional de Producción Limpia; y d) Tratarse de una sociedad anónima abierta en que un funcionario directivo del Consejo Nacional de Producción Limpia sea dueño de acciones que representen el 10% o más del capital
                    %th.contenido2-det-form#nota_input_juridica_obs_id_8
                    %th.contenido3-det-form#obs_input_juridica_obs_id_8  
          %br 
          .col-12
            .float-right
              = link_to t(:back), root_path, class: 'btn btn-sm btn-warning ml-1'
              -#= button_tag t(:save), 'data-disable-with' => "<i class='fa fa-spinner fa-spin'></i> Guardando...".html_safe, class: "btn btn-sm btn-primary", id: "guardar_button", onclick: 'guardarObservacionesAdmisibilidadJuridica(); return false;'
              = button_tag 'data-disable-with' => "<i class='fa fa-spinner fa-spin'></i> Enviando...".html_safe, class: "btn btn-sm btn-success", id: "enviar_admisibilidad_juridica_button" , onclick: 'enviarObservacionesAdmisibilidadJuridica(); return false;' do
                %i.fa.fa-arrow-circle-right
                =t(:enviar)   
  #pertinencia-factibilidad.tab-pane.fade{"aria-expanded" => (tabs[:"pertinencia-factibilidad"] ? 'true' : 'false'), "aria-labelledby" => "pertinencia-factibilidad-tab", :role => "tabpanel", class: ("show active" if tabs[:"pertinencia-factibilidad"])}
    .card
      .card-body
        = form_with(model: @cuestionario_fpl, url: new_cuestionario_fpl_fondo_produccion_limpia_path(@tarea_pendiente), method: :post, remote: true, html: { class: 'ajax-form' }) do |f| 
          <h1>1.- Evaluación del proyecto</h1>
          %div.table-responsive
            %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
              %thead
                %tr
                  %th.encabezado-form{colspan: 3} Criterio 1: FORMULACION TECNICA DEL PROYECTO </br> Mérito y calidad técnica del proyecto en cuanto a su formulación, consistencia con los objetivos, metodología, plan de trabajo y resultados esperados
                %tr
                  %th.encabezado2-form Subcriterios
                  %th.encabezado2-form Nota
                  %th.encabezado2-form Justificación
                %tr
                  %th.contenido1-form Los objetivos están correctamente planteados y su cumplimiento es verificable al finalizar el proyecto
                  %th.contenido2-form 
                    = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-pert-tecnica', id: 'nota_input_pert_tecnica_id_1', onchange: "habilitaObservacionesPertinenciaTecnica('nota_input_pert_tecnica_id_1','obs_input_pert_tecnica_id_1')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form                             
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_pert_tecnica_id_1', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form La metodología es consistente con el cumplimiento de los objetivos. ( Incluye la definición del tamaño muestral)
                  %th.contenido2-form 
                    = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-pert-tecnica', id: 'nota_input_pert_tecnica_id_2', onchange: "habilitaObservacionesPertinenciaTecnica('nota_input_pert_tecnica_id_2','obs_input_pert_tecnica_id_2')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form  
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_pert_tecnica_id_2', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form Las actividades propuestas son adecuadas y pertinentes para conseguir los productos y objetivos del proyecto
                  %th.contenido2-form 
                    = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-pert-tecnica', id: 'nota_input_pert_tecnica_id_3', onchange: "habilitaObservacionesPertinenciaTecnica('nota_input_pert_tecnica_id_3','obs_input_pert_tecnica_id_3')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form         
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_pert_tecnica_id_3', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form La organización del equipo de trabajo y las horas destinadas están acorde con las actividades del proyecto
                  %th.contenido2-form 
                    = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-pert-tecnica', id: 'nota_input_pert_tecnica_id_4', onchange: "habilitaObservacionesPertinenciaTecnica('nota_input_pert_tecnica_id_4','obs_input_pert_tecnica_id_4')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form     
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_pert_tecnica_id_4', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form Puntaje Otorgado
                  %th.contenido2-form#promedio-notas-pert-tecnica
                  %th.contenido3-form   
              %thead
                %tr
                  %th{colspan: 3, style: 'background-color: #fff;'}
                %tr
                  %th.encabezado-form{colspan: 3} Criterio 2: INDICADORES Y RESULTADOS </br> Se evaluaran los indicadores de impacto y resultados en cuanto cumplan con los objetivos planteados y el valor agregado en términos ambientales, </br> productivos y económicos y sobre los trabajadores
                %tr
                  %th.encabezado2-form Subcriterios
                  %th.encabezado2-form Nota
                  %th.encabezado2-form Justificación
                %tr
                  %th.contenido1-form Los indicadores de resultado están correcta y claramente planteados
                  %th.contenido2-form 
                    = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-pert-tecnica-2', id: 'nota_input_pert_tecnica_id_5', onchange: "habilitaObservacionesPertinenciaTecnica2('nota_input_pert_tecnica_id_5','obs_input_pert_tecnica_id_5')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form 
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_pert_tecnica_id_5', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form Puntaje Otorgado
                  %th.contenido2-form#promedio-notas-pert-tecnica-2
                  %th.contenido3-form   
              %thead
                %tr
                  %th{colspan: 3, style: 'background-color: #fff;'}
                %tr
                  %th.encabezado-form{colspan: 3} Criterio 3: IDONEIDAD Y COMPETENCIA DE CONSULTORIA Y/O AUDITORIAS </br> Evaluar si la consultora o auditores contratados por el beneficiario son idóneos y correspondientes a las labores del proyecto
                %tr
                  %th.encabezado2-form Subcriterios
                  %th.encabezado2-form Nota
                  %th.encabezado2-form Justificación
                %tr
                  %th.contenido1-form La empresa consultora y el equipo de trabajo reúnen la formación y especialización necesaria para abordar las temáticas del proyecto
                  %th.contenido2-form 
                    = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-pert-tecnica-3', id: 'nota_input_pert_tecnica_id_6', onchange: "habilitaObservacionesPertinenciaTecnica3('nota_input_pert_tecnica_id_6','obs_input_pert_tecnica_id_6')", style: 'width: 100%; text-align: center;'}
                  %th.contenido3-form 
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_pert_tecnica_id_6', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form La empresa consultora y el equipo de trabajo reúnen la experiencia en el desarrollo de proyectos en ámbitos productivos, ambientales y en el sector productivo abordado
                  %th.contenido2-form 
                    = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-pert-tecnica-3', id: 'nota_input_pert_tecnica_id_7', onchange: "habilitaObservacionesPertinenciaTecnica3('nota_input_pert_tecnica_id_7','obs_input_pert_tecnica_id_7')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form  
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_pert_tecnica_id_7', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form El equipo de trabajo resulta suficiente para abordar el proyecto
                  %th.contenido2-form 
                    = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-pert-tecnica-3', id: 'nota_input_pert_tecnica_id_8', onchange: "habilitaObservacionesPertinenciaTecnica3('nota_input_pert_tecnica_id_8','obs_input_pert_tecnica_id_8')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form    
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_pert_tecnica_id_8', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form Puntaje Otorgado
                  %th.contenido2-form#promedio-notas-pert-tecnica-3
                  %th.contenido3-form 

          %br
          %div.table-responsive
            %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
              %thead
                %tr
                  %th.encabezado-form{colspan: 3}Criterio 4: COSTOS </br> Consistencia de los costos de las actividades con los aspectos técnicos abordados, cantidad y tamaño de empresas y cobertura geográfica. </br>  Se evaluará positivamente el aporte liquido del postulante, cantidad de empresas no socias y el (%) de empresas Mipymes participantes
                %tr
                  %th.encabezado2-form Subcriterios
                  %th.encabezado2-form Nota
                  %th.encabezado2-form Justificación
                %tr
                  %th.contenido1-form Los ítems que componen los gastos de operación y de administración son financiables de acuerdo a las bases del Fondo PL y corresponden a productos específicos e identificables
                  %th.contenido2-form
                    = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-pert-financiera', id: 'nota_input_pert_id_1', onchange: "habilitaObservacionesPertinenciaFinanciera('nota_input_pert_id_1','obs_input_pert_id_1')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_pert_id_1', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form El valor de las HH de los profesionales es cercano al valor de mercado
                  %th.contenido2-form
                    = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-pert-financiera', id: 'nota_input_pert_id_2', onchange: "habilitaObservacionesPertinenciaFinanciera('nota_input_pert_id_2','obs_input_pert_id_2')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_pert_id_2', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form Los costos por actividades son consistentes con los aspectos técnicos abordados, la cantidad y tamaño de las instalaciones, y su cobertura geográfica
                  %th.contenido2-form
                    = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-pert-financiera', id: 'nota_input_pert_id_3', onchange: "habilitaObservacionesPertinenciaFinanciera('nota_input_pert_id_3','obs_input_pert_id_3')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_pert_id_3', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form El proyecto cuenta con participación de empresas no socias y con un alto porcentaje de empresas de menor tamaño (Se evalúa positivamente en caso de cumplimiento)
                  %th.contenido2-form
                    = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-pert-financiera', id: 'nota_input_pert_id_4', onchange: "habilitaObservacionesPertinenciaFinanciera('nota_input_pert_id_4','obs_input_pert_id_4')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_pert_id_4', style: 'visibility: hidden; width: 100%; text-align: center;'   
                %tr
                  %th.contenido1-form Las actividades están correctamente formuladas en relación a las bases del Fondo PL y permiten realizar un análisis de costos
                  %th.contenido2-form
                    = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-pert-financiera', id: 'nota_input_pert_id_5', onchange: "habilitaObservacionesPertinenciaFinanciera('nota_input_pert_id_5','obs_input_pert_id_5')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_pert_id_5', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                %th.contenido1-form Puntaje Otorgado
                %th.contenido2-form#promedio-notas-pert-financiera
                %th.contenido3-form          
          %br
          <h1>2.Tabla resumen de puntuación otorgada al proyecto</h1>
          %br
          %div.table-responsive
            %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
              %thead
                %tr
                  %th.encabezado2-form Criterios
                  %th.encabezado2-form Puntajes Otorgados
                  %th.encabezado2-form Factor de ponderación
                  %th.encabezado2-form Puntaje ponderado
                %tr
                  %th.contenido-form C1. FORMULACION TECNICA DEL PROYECTO
                  %th.contenido-form#promedio-notas-pert-tecnica-total
                  %th.contenido-form 35,00%
                  %th.contenido-form#puntaje-ponderado-tecnica-total
                %tr
                  %th.contenido-form C2. INDICADORES Y RESULTADOS
                  %th.contenido-form#promedio-notas-pert-tecnica-total-2
                  %th.contenido-form 25,00%
                  %th.contenido-form#puntaje-ponderado-tecnica-total-2    
                %tr
                  %th.contenido-form C3. IDONEIDAD Y COMPETENCIA DE CONSULTORIA Y/O AUDITORIAS
                  %th.contenido-form#promedio-notas-pert-tecnica-total-3
                  %th.contenido-form 15,00%
                  %th.contenido-form#puntaje-ponderado-tecnica-total-3    
                %tr
                  %th.contenido-form C4. COSTOS
                  %th.contenido-form#promedio-notas-pert-financiera-total
                  %th.contenido-form 25,00%
                  %th.contenido-form#puntaje-ponderado-financiera-total
                %tr
                  %th.total_verde Total
                  %th.total_verde
                  %th.total_verde
                  %th.total_verde#pertinencia-total             
          %br
          <h1>3.- Estado de la evaluación</h1>
          %br
          %div.table-responsive
            %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
              %tr
                %th
                  %label.label-estilo{ for: 'resultado_de_la_pertinencia' }
                    %abbr{ title: "Campo requerido" } *
                    = t(:resultado_de_la_pertinencia)
                  %br

                  = f.select :nota, options_for_select([['Aceptada', '1'],['Con Observaciones', '2'],['Rechazada', '3']],@nota), {}, { required: true, label: false, class: 'required-field nota_input_pertinencia', id: 'nota_input_pertinencia', style: 'font-size: 14px;' }
              %tr
                %th
                  %label.label-estilo{ for: 'observaciones_y_comentarios' }
                    %abbr{ title: "Campo requerido" } *
                    = t(:observaciones_y_comentarios)
                  %br
                  = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_pertinencia', style: 'width: 100%; font-size: 14px;'
        %br 
          .col-12
            .float-right
              = link_to t(:back), root_path, class: 'btn btn-sm btn-warning ml-1'
              = button_tag t(:save), 'data-disable-with' => "<i class='fa fa-spinner fa-spin'></i> Guardando...".html_safe, class: "btn btn-sm btn-primary", id: "guardar_button_pertinencia_factibilidad", onclick: 'guardarPertinenciaFactibilidad(); return false;'
              = button_tag 'data-disable-with' => "<i class='fa fa-spinner fa-spin'></i> Enviando...".html_safe, class: "btn btn-sm btn-success", id: "enviar_pertinencia_factibilidad_button", onclick: 'enviarPertinenciaFactibilidad(); return false;' do
                %i.fa.fa-arrow-circle-right
                =t(:enviar)
  #evaluacion-general.tab-pane.fade{"aria-expanded" => (tabs[:"evaluacion-general"] ? 'true' : 'false'), "aria-labelledby" => "evaluacion-general-tab", :role => "tabpanel", class: ("show active" if tabs[:"evaluacion-general"])}
    .card
      .card-body
        = form_with(model: @cuestionario_fpl, url: new_cuestionario_fpl_fondo_produccion_limpia_path(@tarea_pendiente), method: :post, remote: true, html: { class: 'ajax-form' }) do |f| 
          <h1>1.- Evaluación del proyecto</h1>
          %div.table-responsive
            %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
              %thead
                %tr
                  %th.encabezado-form{colspan: 3} Criterio 1: FORMULACION TECNICA DEL PROYECTO </br> Mérito y calidad técnica del proyecto en cuanto a su formulación, consistencia con los objetivos, metodología, plan de trabajo y resultados esperados
                %tr
                  %th.encabezado2-form Subcriterios
                  %th.encabezado2-form Nota
                  %th.encabezado2-form Justificación
                %tr
                  %th.contenido1-form Los objetivos están correctamente planteados y su cumplimiento es verificable al finalizar el proyecto
                  %th.contenido2-form 
                    = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-pert-tecnica-general', id: 'nota_input_pert_tecnica_general_id_1', onchange: "habilitaObservacionesPertinenciaTecnicaGeneral('nota_input_pert_tecnica_general_id_1','obs_input_pert_tecnica_general_id_1')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form                             
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_pert_tecnica_general_id_1', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form La metodología es consistente con el cumplimiento de los objetivos. ( Incluye la definición del tamaño muestral)
                  %th.contenido2-form 
                    = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-pert-tecnica-general', id: 'nota_input_pert_tecnica_general_id_2', onchange: "habilitaObservacionesPertinenciaTecnicaGeneral('nota_input_pert_tecnica_general_id_2','obs_input_pert_tecnica_general_id_2')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form  
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_pert_tecnica_general_id_2', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form Las actividades propuestas son adecuadas y pertinentes para conseguir los productos y objetivos del proyecto
                  %th.contenido2-form 
                    = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-pert-tecnica-general', id: 'nota_input_pert_tecnica_general_id_3', onchange: "habilitaObservacionesPertinenciaTecnicaGeneral('nota_input_pert_tecnica_general_id_3','obs_input_pert_tecnica_general_id_3')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form         
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_pert_tecnica_general_id_3', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form La organización del equipo de trabajo y las horas destinadas están acorde con las actividades del proyecto
                  %th.contenido2-form 
                    = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-pert-tecnica-general', id: 'nota_input_pert_tecnica_general_id_4', onchange: "habilitaObservacionesPertinenciaTecnicaGeneral('nota_input_pert_tecnica_general_id_4','obs_input_pert_tecnica_general_id_4')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form     
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_pert_tecnica_general_id_4', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form Puntaje Otorgado
                  %th.contenido2-form#promedio-notas-pert-tecnica-general 
                  %th.contenido3-form   
              %thead
                %tr
                  %th{colspan: 3, style: 'background-color: #fff;'}
                %tr
                  %th.encabezado-form{colspan: 3} Criterio 2: INDICADORES Y RESULTADOS </br> Se evaluaran los indicadores de impacto y resultados en cuanto cumplan con los objetivos planteados y el valor agregado en términos ambientales, </br> productivos y económicos y sobre los trabajadores
                %tr
                  %th.encabezado2-form Subcriterios
                  %th.encabezado2-form Nota
                  %th.encabezado2-form Justificación
                %tr
                  %th.contenido1-form Los indicadores de resultado están correcta y claramente planteados
                  %th.contenido2-form 
                    = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-pert-tecnica-general-2', id: 'nota_input_pert_tecnica_general_id_5', onchange: "habilitaObservacionesPertinenciaTecnicaGeneral2('nota_input_pert_tecnica_general_id_5','obs_input_pert_tecnica_general_id_5')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form 
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_pert_tecnica_general_id_5', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form Puntaje Otorgado
                  %th.contenido2-form#promedio-notas-pert-tecnica-general-2
                  %th.contenido3-form   
              %thead
                %tr
                  %th{colspan: 3, style: 'background-color: #fff;'}
                %tr
                  %th.encabezado-form{colspan: 3} Criterio 3: IDONEIDAD Y COMPETENCIA DE CONSULTORIA Y/O AUDITORIAS </br> Evaluar si la consultora o auditores contratados por el beneficiario son idóneos y correspondientes a las labores del proyecto
                %tr
                  %th.encabezado2-form Subcriterios
                  %th.encabezado2-form Nota
                  %th.encabezado2-form Justificación
                %tr
                  %th.contenido1-form La empresa consultora y el equipo de trabajo reúnen la formación y especialización necesaria para abordar las temáticas del proyecto
                  %th.contenido2-form 
                    = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-pert-tecnica-general-3', id: 'nota_input_pert_tecnica_general_id_6', onchange: "habilitaObservacionesPertinenciaTecnicaGeneral3('nota_input_pert_tecnica_general_id_6','obs_input_pert_tecnica_general_id_6')", style: 'width: 100%; text-align: center;'}
                  %th.contenido3-form 
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_pert_tecnica_general_id_6', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form La empresa consultora y el equipo de trabajo reúnen la experiencia en el desarrollo de proyectos en ámbitos productivos, ambientales y en el sector productivo abordado
                  %th.contenido2-form 
                    = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-pert-tecnica-general-3', id: 'nota_input_pert_tecnica_general_id_7', onchange: "habilitaObservacionesPertinenciaTecnicaGeneral3('nota_input_pert_tecnica_general_id_7','obs_input_pert_tecnica_general_id_7')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form  
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_pert_tecnica_general_id_7', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form El equipo de trabajo resulta suficiente para abordar el proyecto
                  %th.contenido2-form 
                    = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-pert-tecnica-general-3', id: 'nota_input_pert_tecnica_general_id_8', onchange: "habilitaObservacionesPertinenciaTecnicaGeneral3('nota_input_pert_tecnica_general_id_8','obs_input_pert_tecnica_general_id_8')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form    
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_pert_tecnica_general_id_8', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form Puntaje Otorgado
                  %th.contenido2-form#promedio-notas-pert-tecnica-general-3
                  %th.contenido3-form 

          %br
          %div.table-responsive
            %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
              %thead
                %tr
                  %th.encabezado-form{colspan: 3}Criterio 4: COSTOS </br> Consistencia de los costos de las actividades con los aspectos técnicos abordados, cantidad y tamaño de empresas y cobertura geográfica. </br>  Se evaluará positivamente el aporte liquido del postulante, cantidad de empresas no socias y el (%) de empresas Mipymes participantes
                %tr
                  %th.encabezado2-form Subcriterios
                  %th.encabezado2-form Nota
                  %th.encabezado2-form Justificación
                %tr
                  %th.contenido1-form Los ítems que componen los gastos de operación y de administración son financiables de acuerdo a las bases del Fondo PL y corresponden a productos específicos e identificables
                  %th.contenido2-form
                    = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-pert-financiera-general', id: 'nota_input_pert_general_id_1', onchange: "habilitaObservacionesPertinenciaFinancieraGeneral('nota_input_pert_general_id_1','obs_input_pert_general_id_1')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_pert_general_id_1', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form El valor de las HH de los profesionales es cercano al valor de mercado
                  %th.contenido2-form
                    = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-pert-financiera-general', id: 'nota_input_pert_general_id_2', onchange: "habilitaObservacionesPertinenciaFinancieraGeneral('nota_input_pert_general_id_2','obs_input_pert_general_id_2')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_pert_general_id_2', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form Los costos por actividades son consistentes con los aspectos técnicos abordados, la cantidad y tamaño de las instalaciones, y su cobertura geográfica
                  %th.contenido2-form
                    = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-pert-financiera-general', id: 'nota_input_pert_general_id_3', onchange: "habilitaObservacionesPertinenciaFinancieraGeneral('nota_input_pert_general_id_3','obs_input_pert_general_id_3')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_pert_general_id_3', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form El proyecto cuenta con participación de empresas no socias y con un alto porcentaje de empresas de menor tamaño (Se evalúa positivamente en caso de cumplimiento)
                  %th.contenido2-form
                    = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-pert-financiera-general', id: 'nota_input_pert_general_id_4', onchange: "habilitaObservacionesPertinenciaFinancieraGeneral('nota_input_pert_general_id_4','obs_input_pert_general_id_4')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_pert_general_id_4', style: 'visibility: hidden; width: 100%; text-align: center;'   
                %tr
                  %th.contenido1-form Las actividades están correctamente formuladas en relación a las bases del Fondo PL y permiten realizar un análisis de costos
                  %th.contenido2-form
                    = f.select :nota, (1..7), {}, { required: true, label: false, class: 'required-field nota-input-pert-financiera-general', id: 'nota_input_pert_general_id_5', onchange: "habilitaObservacionesPertinenciaFinancieraGeneral('nota_input_pert_general_id_5','obs_input_pert_general_id_5')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_pert_general_id_5', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                %th.contenido1-form Puntaje Otorgado
                %th.contenido2-form#promedio-notas-pert-financiera-general
                %th.contenido3-form          
          %br
          %div.table-responsive
            %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
              %thead
                %tr
                  %th.encabezado-form{colspan: 3} Admisibilidad Jurídica
                %tr
                  %th.encabezado2-form Criterios
                  %th.encabezado2-form ¿Cumple?
                  %th.encabezado2-form Observación
                %tr
                  %th.contenido1-form Solicitud de cofinanciamiento
                  %th.contenido2-form 
                    = f.select :nota, [['Cumple', '1'],['No Cumple', '2']], {}, { required: true, label: false, class: 'required-field nota_input_juridica_general_id_1', id: 'nota_input_juridica_general_id_1', onchange: "habilitaObservacionesJuridica('nota_input_juridica_general_id_1','obs_input_juridica_general_id_1')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form 
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_juridica_general_id_1', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form Certificado de vigencia otorgado por la Entidad que lo tutela con fecha no anterior a 60 días de la fecha de postulación
                  %th.contenido2-form 
                    = f.select :nota, [['Cumple', '1'],['No Cumple', '2']], {}, { required: true, label: false, class: 'required-field nota_input_juridica_general_id_2', id: 'nota_input_juridica_general_id_2', onchange: "habilitaObservacionesJuridica('nota_input_juridica_general_id_2','obs_input_juridica_general_id_2')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form                           
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_juridica_general_id_2', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form Copia simple del Rol Único Tributario de la organización postulante
                  %th.contenido2-form 
                    = f.select :nota, [['Cumple', '1'],['No Cumple', '2']], {}, { required: true, label: false, class: 'required-field nota_input_juridica_general_id_3', id: 'nota_input_juridica_general_id_3', onchange: "habilitaObservacionesJuridica('nota_input_juridica_general_id_3','obs_input_juridica_general_id_3')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form   
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_juridica_general_id_3', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form Copia simple de la cédula de identidad del o los representantes legales
                  %th.contenido2-form 
                    = f.select :nota, [['Cumple', '1'],['No Cumple', '2']], {}, { required: true, label: false, class: 'required-field nota_input_juridica_general_id_4', id: 'nota_input_juridica_general_id_4', onchange: "habilitaObservacionesJuridica('nota_input_juridica_general_id_4','obs_input_juridica_general_id_4')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form         
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_juridica_general_id_4', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form Declaración jurada firmada por el representante legal de la fundación que acredite que se encuentra al día en el pago de las cotizaciones previsionales, se encuentra al día en el pago de las cotizaciones del seguro de desempleo y su propuesta no presenta duplicidad de financiamiento con otras iniciativas equivalentes financiables, ya sea por la Corporación de Fomento de la Producción u otras fuentes de financiamiento públicas
                  %th.contenido2-form 
                    = f.select :nota, [['Cumple', '1'],['No Cumple', '2']], {}, { required: true, label: false, class: 'required-field nota_input_juridica_general_id_5', id: 'nota_input_juridica_general_id_5', onchange: "habilitaObservacionesJuridica('nota_input_juridica_general_id_5','obs_input_juridica_general_id_5')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form      
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_juridica_general_id_5', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form Declaración jurada suscrita por el representante legal de la organización postulante que acredite que la entidad no incurre en ninguna de las siguientes prohibiciones: a) Haber sido condenada por prácticas antisindicales o infracción a los derechos fundamentales del trabajador, dentro de los 2 años anteriores; y b) Tratarse de una entidad de la que formen parte de modo alguno, funcionarios directivos del Consejo Nacional de Producción Limpia, o personas que tengan la calidad de cónyuge, hijo, adoptado, o pariente hasta el tercer grado de consanguinidad y segundo de afinidad, inclusive, respecto de un directivo del Consejo Nacional de Producción Limpia
                  %th.contenido2-form 
                    = f.select :nota, [['Cumple', '1'],['No Cumple', '2']], {}, { required: true, label: false, class: 'required-field nota_input_juridica_general_id_6', id: 'nota_input_juridica_general_id_6', onchange: "habilitaObservacionesJuridica('nota_input_juridica_general_id_6','obs_input_juridica_general_id_6')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form    
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_juridica_general_id_6', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form Empresas consultoras: Copia de la escritura en la que consta su constitución legal, personería o representación legal vigente, y modificaciones posteriores, si las hubiere; copia de las publicaciones en extracto en el Diario Oficial y de las inscripciones en los Registros correspondientes, de las escrituras señaladas; y certificado de vigencia del Registro de Comercio, con fecha no anterior a tres meses contados desde la fecha de su presentación
                  %th.contenido2-form 
                    = f.select :nota, [['Cumple', '1'],['No Cumple', '2']], {}, { required: true, label: false, class: 'required-field nota_input_juridica_general_id_7', id: 'nota_input_juridica_general_id_7', onchange: "habilitaObservacionesJuridica('nota_input_juridica_general_id_7','obs_input_juridica_general_id_7')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form    
                    = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_juridica_general_id_7', style: 'visibility: hidden; width: 100%; text-align: center;'
                %tr
                  %th.contenido1-form Empresas consultoras: declaración jurada suscrita por el representante legal que acredite que la empresa no incurre en ninguna de las siguientes prohibiciones: a) Haber sido condenada por prácticas antisindicales o infracción a los derechos fundamentales del trabajador; b) Tratarse de una sociedad de personas de la que formen parte funcionarios directivos del Consejo Nacional de Producción Limpia; c) Tratarse de una sociedad comandita por acciones o anónima cerrada en que sean accionistas funcionarios directivos del Consejo Nacional de Producción Limpia; y d) Tratarse de una sociedad anónima abierta en que un funcionario directivo del Consejo Nacional de Producción Limpia sea dueño de acciones que representen el 10% o más del capital
                  %th.contenido2-form 
                    = f.select :nota, [['Cumple', '1'],['No Cumple', '2']], {}, { required: true, label: false, class: 'required-field nota_input_juridica_general_id_8', id: 'nota_input_juridica_general_id_8', onchange: "habilitaObservacionesJuridica('nota_input_juridica_general_id_8','obs_input_juridica_general_id_8')", style: 'width: 100%; text-align: center;' }
                  %th.contenido3-form 
          %br
          <h1>2.Tabla resumen de puntuación otorgada al proyecto</h1>
          %br
          %div.table-responsive
            %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
              %thead
                %tr
                  %th.encabezado2-form Criterios
                  %th.encabezado2-form Puntajes Otorgados
                  %th.encabezado2-form Factor de ponderación
                  %th.encabezado2-form Puntaje ponderado
                %tr
                  %th.contenido-form C1. FORMULACION TECNICA DEL PROYECTO
                  %th.contenido-form#promedio-notas-pert-tecnica-total-general
                  %th.contenido-form 35,00%
                  %th.contenido-form#puntaje-ponderado-tecnica-total-general   
                %tr
                  %th.contenido-form C2. INDICADORES Y RESULTADOS
                  %th.contenido-form#promedio-notas-pert-tecnica-total-general-2
                  %th.contenido-form 25,00%
                  %th.contenido-form#puntaje-ponderado-tecnica-total-general-2
                %tr
                  %th.contenido-form C3. IDONEIDAD Y COMPETENCIA DE CONSULTORIA Y/O AUDITORIAS
                  %th.contenido-form#promedio-notas-pert-tecnica-total-general-3
                  %th.contenido-form 15,00%
                  %th.contenido-form#puntaje-ponderado-tecnica-total-general-3    
                %tr
                  %th.contenido-form C4. COSTOS
                  %th.contenido-form#promedio-notas-pert-financiera-total-general
                  %th.contenido-form 25,00%
                  %th.contenido-form#puntaje-ponderado-financiera-total-general
                %tr
                  %th.total_verde Total
                  %th.total_verde
                  %th.total_verde
                  %th.total_verde#pertinencia-total-general            
          %br
          <h1>3.- Estado de la evaluación</h1>
          %br
          %div.table-responsive
            %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
              %tr
                %th
                  %label.label-estilo{ for: 'resultado_de_la_pertinencia' }
                    %abbr{ title: "Campo requerido" } *
                    = t(:resultado_de_la_pertinencia)
                  %br

                  = f.select :nota, [['Aceptada', '1'],['Con Observaciones', '2'],['Rechazada', '3']], {}, { required: true, label: false, class: 'required-field nota_input_pertinencia_general', id: 'nota_input_pertinencia_general', style: 'font-size: 14px;' }
              %tr
                %th
                  %label.label-estilo{ for: 'observaciones_y_comentarios' }
                    %abbr{ title: "Campo requerido" } *
                    = t(:observaciones_y_comentarios)
                  %br
                  = f.text_area :justificacion, required: true, label: false, class: 'required-field-text', id: 'obs_input_pertinencia_general', style: 'width: 100%; font-size: 14px;'
        %br 
          .col-12
            .float-right
              = link_to t(:back), root_path, class: 'btn btn-sm btn-warning ml-1'
              -#= button_tag t(:save), 'data-disable-with' => "<i class='fa fa-spinner fa-spin'></i> Guardando...".html_safe, class: "btn btn-sm btn-primary", id: "guardar_button", onclick: 'guardarPertinenciaFactibilidad(); return false;'
              = button_tag 'data-disable-with' => "<i class='fa fa-spinner fa-spin'></i> Enviando...".html_safe, class: "btn btn-sm btn-success", id: "enviar_evaluacion_general_button", onclick: 'enviarEvaluacionGeneral(); return false;' do
                %i.fa.fa-arrow-circle-right
                =t(:enviar)                                               
  #modal_objetivos-form.modal.fade{tabindex: -1, role: 'dialog', 'aria-labelledby' => 'exampleModalLabel', 'aria-hidden' => 'true'}
    .modal-dialog
      .modal-content
        .modal-body
          = form_with(model: @objetivo_especifico, url: new_objetivo_especifico_fondo_produccion_limpia_path, method: :get, remote: true, html: { class: 'ajax-form' }) do |f|
            .row
              .col-12
                .card
                  .card-header
                    %h5.no-margin
                      Crear nuevo objetivo
                  .card-body
                    %div.table-responsive
                      %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}

                        = hidden_field_tag 'flujo_id', @tarea_pendiente.id, id: 'flujo_id'
                        
                        %tr
                          %td.contenido-popup-form(style='width: 33.33%;')=t(:descripcion)
                          %td.contenido-popup-form(style='width: 66.67%;')  
                            = f.text_area  :descripcion, class: 'required-field', id: 'descripcion', style: 'border: 1px solid #ced4da; border-radius: 0.25rem; width: 100%;'
                        %tr
                          %td.contenido-popup-form(style='width: 33.33%;')=t(:metodologia)
                          %td.contenido-popup-form(style='width: 66.67%;')
                            = f.text_area :metodologia, required: true, id: 'metodologia', class: 'required-field', style: 'border: 1px solid #ced4da; border-radius: 0.25rem; width: 100%;' 
                        %tr
                          %td.contenido-popup-form(style='width: 33.33%;')=t(:resultado)
                          %td.contenido-popup-form(style='width: 66.67%;')
                            = f.text_area :resultado, required: true, id: 'resultado' , class: 'required-field', style: 'border: 1px solid #ced4da; border-radius: 0.25rem; width: 100%;'
                        %tr
                          %td.contenido-popup-form(style='width: 33.33%;')=t(:indicadores)
                          %td.contenido-popup-form(style='width: 66.67%;')
                            = f.text_area :indicadores, class: 'required-field', id: 'indicadores', style: 'border: 1px solid #ced4da; border-radius: 0.25rem; width: 100%;' 
          .modal-footer
            %button.btn.btn-secondary{"data-dismiss" => "modal"} Cerrar
            = button_to 'Guardar', '#', class: 'btn btn-primary', onclick: 'guardarObjetivo(); return false;'
            
  #modal_objetivos-edit-form.modal.fade{tabindex: -1, role: 'dialog', 'aria-labelledby' => 'exampleModalLabel', 'aria-hidden' => 'true'}
    .modal-dialog
      .modal-content
        .modal-body
          = form_with(model: @objetivo_especifico, url: new_objetivo_especifico_fondo_produccion_limpia_path, method: :post, remote: true, html: { class: 'ajax-form' }) do |f|
            .row
              .col-12
                .card
                  .card-header
                    %h5.no-margin
                      Editar objetivo
                  .card-body
                    %div.table-responsive
                      %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
                        = hidden_field_tag 'flujo_id', @tarea_pendiente.id, id: 'flujo_id'
                        = hidden_field_tag 'id_edit', @tarea_pendiente.id, id: 'id_edit'                       
                        %tr
                          %td.contenido-popup-form(style='width: 33.33%;')=t(:descripcion)
                          %td.contenido-popup-form(style='width: 66.67%;')
                            = f.text_area :descripcion_edit, class: 'required-field', id: 'descripcion_edit', style: 'border: 1px solid #ced4da; border-radius: 0.25rem; width: 100%;'
                        %tr
                          %td.contenido-popup-form(style='width: 33.33%;')=t(:metodologia)
                          %td.contenido-popup-form(style='width: 66.67%;')
                            = f.text_area :metodologia, required: true, id: 'metodologia_edit', class: 'required-field', style: 'border: 1px solid #ced4da; border-radius: 0.25rem; width: 100%;'
                        %tr
                          %td.contenido-popup-form(style='width: 33.33%;')=t(:resultado)
                          %td.contenido-popup-form(style='width: 66.67%;')
                            = f.text_area :resultado, required: true, id: 'resultado_edit', class: 'required-field', style: 'border: 1px solid #ced4da; border-radius: 0.25rem; width: 100%;'
                        %tr
                          %td.contenido-popup-form(style='width: 33.33%;')=t(:indicadores)
                          %td.contenido-popup-form(style='width: 66.67%;')
                            = f.text_area :indicadores, class: 'required-field', id: 'indicadores_edit', style: 'border: 1px solid #ced4da; border-radius: 0.25rem; width: 100%;'
          .modal-footer
            %button.btn.btn-secondary{"data-dismiss" => "modal"} Cerrar
            = button_to 'Guardar', '#', class: 'btn btn-primary', onclick: 'actualizarObjetivo(); return false;'

  -# POPUP EQUIPO DE TRABAJO POSTULANTE
  #modal_postulante_create-form.modal.fade{tabindex: -1, role: 'dialog', 'aria-labelledby' => 'exampleModalLabel', 'aria-hidden' => 'true'}
    .modal-dialog
      .modal-content
        .modal-body
          = form_with(model: @objetivo_especifico, url: new_objetivo_especifico_fondo_produccion_limpia_path, method: :get, remote: true, html: { class: 'ajax-form' }) do |f|
            .row
              .col-12
                .card
                  .card-header
                    %h5.no-margin
                      Crear nuevo postulante
                  .card-body
                    %div.table-responsive
                      %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
                        = hidden_field_tag 'flujo_id', @tarea_pendiente.id, id: 'flujo_id'
                        %tr
                          %td.contenido-popup-form=t(:nombre_completo_persona)
                          %td.contenido-popup-form 
                            = f.text_field :descripcion, class: 'required-field', id: 'descripcion', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:rut)
                          %td.contenido-popup-form
                            = f.text_field :metodologia, required: true, id: 'metodologia', class: 'required-field', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                        %tr
                          %td.contenido-popup-form=t(:teléfono)
                          %td.contenido-popup-form
                            -# = f.text_field :resultado, required: true, id: 'resultado' , class: 'required-field numero', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;', maxlength: 8
                            = f.text_field :resultado, required: true, id: 'resultado', class: 'required-field numero', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:email)
                          %td.contenido-popup-form
                            = f.text_field :email, class: 'required-field', id: 'indicadores' , style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                            -#= f.input :email, required: true, label: t(:email), placeholder: "Ingresar email", input_html: { class: 'required-field' }
                        %tr
                          %td.contenido-popup-form=t(:profesion)
                          %td.contenido-popup-form 
                            = f.text_field :descripcion, class: 'required-field', id: 'descripcion', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        -# %tr
                        -#   %td.contenido-popup-form=t(:cargo)
                        -#   %td.contenido-popup-form 
                        -#     = f.text_field :descripcion, class: 'required-field', id: 'descripcion', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:funciones_proyecto)
                          %td.contenido-popup-form
                            = f.text_field :metodologia, required: true, id: 'metodologia', class: 'required-field', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                        %tr
                          %td.contenido-popup-form=t(:valor_hh_)
                          %td.contenido-popup-form
                            = f.text_field :resultado, required: true, id: 'resultado' , class: 'required-field numero', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:copia_cédula_identidad)
                          %td.contenido-popup-form
                            = f.file_field :indicadores, class: 'form-control', label: false, placeholder: 'Seleccione un archivo', name: 'nombre_del_campo', 'data-placeholder' => 'Seleccione un archivo', 'data-btn-text' => 'Elegir archivo'
                        %tr
                          %td.contenido-popup-form=t(:curriculum_vitae)
                          %td.contenido-popup-form
                            = f.file_field :indicadores, class: 'form-control', label: false, placeholder: 'Seleccione un archivo', name: 'nombre_del_campo', 'data-placeholder' => 'Seleccione un archivo', 'data-btn-text' => 'Elegir archivo'
          .modal-footer
            %button.btn.btn-secondary{"data-dismiss" => "modal"} Cerrar
            = button_to 'Guardar', '#', class: 'btn btn-primary', onclick: 'guardarObjetivo(); return false;'

  #modal_postulante_edit-form.modal.fade{tabindex: -1, role: 'dialog', 'aria-labelledby' => 'exampleModalLabel', 'aria-hidden' => 'true'}
    .modal-dialog
      .modal-content
        .modal-body
          = form_with(model: @objetivo_especifico, url: new_objetivo_especifico_fondo_produccion_limpia_path, method: :get, remote: true, html: { class: 'ajax-form' }) do |f|
            .row
              .col-12
                .card
                  .card-header
                    %h5.no-margin
                      Crear nuevo postulante
                  .card-body
                    %div.table-responsive
                      %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
                        = hidden_field_tag 'flujo_id', @tarea_pendiente.id, id: 'flujo_id'
                        %tr
                          %td.contenido-popup-form=t(:nombre_completo_persona)
                          %td.contenido-popup-form 
                            = f.text_field :descripcion, class: 'required-field', id: 'descripcion', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:rut)
                          %td.contenido-popup-form
                            = f.text_field :metodologia, required: true, id: 'metodologia', class: 'required-field', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                        %tr
                          %td.contenido-popup-form=t(:teléfono)
                          %td.contenido-popup-form
                            -# = f.text_field :resultado, required: true, id: 'resultado' , class: 'required-field numero', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;', maxlength: 8
                            = f.text_field :resultado, required: true, id: 'resultado', class: 'required-field numero', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:email)
                          %td.contenido-popup-form
                            = f.text_field :email, class: 'required-field', id: 'indicadores' , style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                            -#= f.input :email, required: true, label: t(:email), placeholder: "Ingresar email", input_html: { class: 'required-field' }
                        %tr
                          %td.contenido-popup-form=t(:profesion)
                          %td.contenido-popup-form 
                            = f.text_field :descripcion, class: 'required-field', id: 'descripcion', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        -# %tr
                        -#   %td.contenido-popup-form=t(:cargo)
                        -#   %td.contenido-popup-form 
                        -#     = f.text_field :descripcion, class: 'required-field', id: 'descripcion', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:funciones_proyecto)
                          %td.contenido-popup-form
                            = f.text_field :metodologia, required: true, id: 'metodologia', class: 'required-field', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                        %tr
                          %td.contenido-popup-form=t(:valor_hh_)
                          %td.contenido-popup-form
                            = f.text_field :resultado, required: true, id: 'resultado' , class: 'required-field numero', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:copia_cédula_identidad)
                          %td.contenido-popup-form
                            = f.file_field :indicadores, class: 'form-control', label: false, placeholder: 'Seleccione un archivo', name: 'nombre_del_campo', 'data-placeholder' => 'Seleccione un archivo', 'data-btn-text' => 'Elegir archivo'
                        %tr
                          %td.contenido-popup-form=t(:curriculum_vitae)
                          %td.contenido-popup-form
                            = f.file_field :indicadores, class: 'form-control', label: false, placeholder: 'Seleccione un archivo', name: 'nombre_del_campo', 'data-placeholder' => 'Seleccione un archivo', 'data-btn-text' => 'Elegir archivo'
          .modal-footer
            %button.btn.btn-secondary{"data-dismiss" => "modal"} Cerrar
            = button_to 'Guardar', '#', class: 'btn btn-primary', onclick: 'guardarObjetivo(); return false;'
  -# POPUP EQUIPO DE TRABAJO CONSULTORES
  #modal_consultora_create-form.modal.fade{tabindex: -1, role: 'dialog', 'aria-labelledby' => 'exampleModalLabel', 'aria-hidden' => 'true'}
    .modal-dialog
      .modal-content
        .modal-body
          = form_with(model: @objetivo_especifico, url: new_objetivo_especifico_fondo_produccion_limpia_path, method: :get, remote: true, html: { class: 'ajax-form' }) do |f|
            .row
              .col-12
                .card
                  .card-header
                    %h5.no-margin
                      Crear nuevo consultora
                  .card-body
                    %div.table-responsive
                      %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
                        = hidden_field_tag 'flujo_id', @tarea_pendiente.id, id: 'flujo_id'
                        %tr
                          %td.contenido-popup-form=t(:nombre_completo_persona)
                          %td.contenido-popup-form 
                            = f.text_field :descripcion, class: 'required-field', id: 'descripcion', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:rut)
                          %td.contenido-popup-form
                            = f.text_field :metodologia, required: true, id: 'metodologia', class: 'required-field', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                        %tr
                          %td.contenido-popup-form=t(:teléfono)
                          %td.contenido-popup-form
                            -# = f.text_field :resultado, required: true, id: 'resultado' , class: 'required-field numero', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;', maxlength: 8
                            = f.text_field :resultado, required: true, id: 'resultado', class: 'required-field numero', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:email)
                          %td.contenido-popup-form
                            = f.text_field :email, class: 'required-field', id: 'indicadores' , style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                            -#= f.input :email, required: true, label: t(:email), placeholder: "Ingresar email", input_html: { class: 'required-field' }
                        %tr
                          %td.contenido-popup-form=t(:profesion)
                          %td.contenido-popup-form 
                            = f.text_field :descripcion, class: 'required-field', id: 'descripcion', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        -# %tr
                        -#   %td.contenido-popup-form=t(:cargo)
                        -#   %td.contenido-popup-form 
                        -#     = f.text_field :descripcion, class: 'required-field', id: 'descripcion', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:funciones_proyecto)
                          %td.contenido-popup-form
                            = f.text_field :metodologia, required: true, id: 'metodologia', class: 'required-field', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                        %tr
                          %td.contenido-popup-form=t(:valor_hh_)
                          %td.contenido-popup-form
                            = f.text_field :resultado, required: true, id: 'resultado' , class: 'required-field numero', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:copia_cédula_identidad)
                          %td.contenido-popup-form
                            = f.file_field :indicadores, class: 'form-control', label: false, placeholder: 'Seleccione un archivo', name: 'nombre_del_campo', 'data-placeholder' => 'Seleccione un archivo', 'data-btn-text' => 'Elegir archivo'
                        %tr
                          %td.contenido-popup-form=t(:curriculum_vitae)
                          %td.contenido-popup-form
                            = f.file_field :indicadores, class: 'form-control', label: false, placeholder: 'Seleccione un archivo', name: 'nombre_del_campo', 'data-placeholder' => 'Seleccione un archivo', 'data-btn-text' => 'Elegir archivo'
          .modal-footer
            %button.btn.btn-secondary{"data-dismiss" => "modal"} Cerrar
            = button_to 'Guardar', '#', class: 'btn btn-primary', onclick: 'guardarObjetivo(); return false;'
  -# POPUP PLAN DE ACTIVIDADES
  #modal_create_plan_actividades-form.modal.fade{tabindex: -1, role: 'dialog', 'aria-labelledby' => 'exampleModalLabel', 'aria-hidden' => 'true'}
    .modal-dialog
      .modal-content
        .modal-body
          = form_with(model: @plan_actividades, url: new_objetivo_especifico_fondo_produccion_limpia_path, method: :get, remote: true, html: { class: 'ajax-form' }) do |f|
            .row
              .col-12
                .card
                  .card-header
                    %h5.no-margin
                      Actividades
                  .card-body
                    %div.table-responsive  
                      %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
                        = hidden_field_tag 'flujo_id', @tarea_pendiente.id, id: 'flujo_id'
                        = hidden_field_tag 'plan_id', id: 'plan_id'
                        %tr
                          %td.contenido-popup-form=t(:nombre_actividades)
                          %td.contenido-popup-form 
                            = f.text_area  :descripcion, value: @nombre_actividad, class: 'required-field', id: 'nombre_actividad', style: 'border: 1px solid #ced4da; border-radius: 0.25rem; width: 100%;', disabled: true
                            -#= f.text_area :descripcion, value: @nombre_actividad, class: 'required-field', id: 'nombre_actividad', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;', required: true, disabled: true
                        %tr
                          %td.contenido-popup-form=t(:objetivos_específicos)
                          %td.contenido-popup-form 
                            - if @plan_actividades.present?
                              = f.select :objetivos_especifico_id, options_for_select(@objetivos_options, @plan_actividades.objetivos_especifico_id), { include_blank: 'Seleccione una opción' }, class: 'required-field', id: 'objetivos_especifico_id', style: 'border: 1px solid #ced4da; border-radius: 0.25rem; width: 100%;'
                            - else
                              = f.select :objetivos_especifico_id, options_for_select(@objetivos_options, include_blank: 'Seleccione una opción'), { include_blank: 'Seleccione una opción' }, class: 'required-field', id: 'objetivos_especifico_id', style: 'border: 1px solid #ced4da; border-radius: 0.25rem; width: 100%;'
                        %tr
                          %td.contenido-popup-form{colspan: @duracion}
                            %div#div_duracion.table-responsive
                              %table.table.table-striped.usuarios.no-margin
                                %thead
                                  %tr.contenido-popup-form{colspan: @duracion}=t(:duracion)
                                  %tr.contenido-popup-form{colspan: @duracion}
                                    - if @duracion.present? && @duracion.to_i > 0
                                      - (1..@duracion.to_i).each do |mes|
                                        %td.sub-contenido-popup-form= mes
                                    - else
                                      %td.sub-contenido-popup-form{:colspan => @duracion} No checkboxes
                                %tbody
                        %tr
                          %td.contenido-popup-form{colspan: 4}
                            %div.table-responsive  
                            %div#div_plan_recursos_propios.table-responsive  
                              %table.table.table-striped.usuarios.no-margin
                                %thead
                                  %tr.contenido-popup-form{colspan: 4}= t(:recursos_humanos_propios)
                                  %tr.contenido-popup-form{colspan: 4}
                                    %td.sub-contenido-popup-form Nombre
                                    %td.sub-contenido-popup-form HH
                                    %td.sub-contenido-popup-form Valor HH
                                    %td.sub-contenido-popup-form Costo
                                %tbody
                              - if !solo_lectura
                                %table
                                  %thead
                                    %tr.contenido-popup-form{colspan: 4}
                                      %td{style: 'text-align: left; background-color: #fff;'}
                                        %a{href: "#-1", onclick: "modalRrhhPropios(document.getElementById('plan_id').value); return false;", id: "agregar_rr_pp", style: 'color: #5d759e;'} Agregar
                                        %i.fa.fa-plus-square.icono-celeste
                        %tr
                          %td.contenido-popup-form{colspan: 4}
                            %div.table-responsive  
                            %div#div_plan_recursos_externos.table-responsive  
                              %table.table.table-striped.usuarios.no-margin
                                %thead
                                  %tr.contenido-popup-form{colspan: 4}= t(:recursos_humanos_externos)
                                  %tr.contenido-popup-form{colspan: 4}
                                    %td.sub-contenido-popup-form Nombre
                                    %td.sub-contenido-popup-form HH
                                    %td.sub-contenido-popup-form Valor HH
                                    %td.sub-contenido-popup-form Costo
                                %tbody
                              - if !solo_lectura  
                                %table
                                  %thead
                                    %tr.contenido-popup-form{colspan: 4}
                                      %td{style: 'text-align: left; background-color: #fff;'}
                                        %a{href: "#-1", onclick: "modalRrhhExternos(document.getElementById('plan_id').value); return false;", id: "agregar_rr_ex", style: 'color: #5d759e;'} Agregar
                                        %i.fa.fa-plus-square.icono-celeste

                        %tr 
                          %td.contenido-popup-form{colspan: 6}
                            %div.table-responsive  
                            %div#div_plan_gastos_operacion.table-responsive  
                              %table.table.table-striped.usuarios.no-margin
                                %thead
                                  %tr.contenido-popup-form{colspan: 6}=t(:gasto_operacion)
                                  %tr.contenido-popup-form{colspan: 6}
                                    %td.sub-contenido-popup-form Ítem
                                    %td.sub-contenido-popup-form Valor Unitario
                                    %td.sub-contenido-popup-form Cantidad
                                    %td.sub-contenido-popup-form Unidad
                                    %td.sub-contenido-popup-form Total
                                    - if !solo_lectura 
                                      %td.sub-contenido-popup-form
                                %tbody
                              - if !solo_lectura  
                                %table
                                  %thead  
                                    %tr.contenido-popup-form{colspan: 6}
                                      %td{colspan: 6,style: 'text-align: right; background-color: #fff;'}
                                        %a{href: "#-1", onclick: "modalGastosOperacion(document.getElementById('plan_id').value); return false;", id: "agregar_gas_ope", style: 'color: #5d759e;'} Agregar Fila
                                        %i.fa.fa-plus-square.icono-celeste
                        %tr 
                          %td.contenido-popup-form{colspan: 6}
                            %div.table-responsive  
                            %div#div_plan_gastos_administracion.table-responsive 
                              %table.table.table-striped.usuarios.no-margin
                                %thead
                                  %tr.contenido-popup-form{colspan: 6}=t(:gasto_administracion)
                                  %tr.contenido-popup-form{colspan: 6}
                                    %td.sub-contenido-popup-form Ítem
                                    %td.sub-contenido-popup-form Valor Unitario
                                    %td.sub-contenido-popup-form Cantidad
                                    %td.sub-contenido-popup-form Unidad
                                    %td.sub-contenido-popup-form Total
                                    - if !solo_lectura
                                      %td.sub-contenido-popup-form
                                %tbody
                              - if !solo_lectura  
                                %table
                                  %thead  
                                    %tr.contenido-popup-form{colspan: 6}
                                      %td{colspan: 6, style: 'text-align: right; background-color: #fff;'}
                                        %a{href: "#-1", onclick: "modalGastosAdministrativos(document.getElementById('plan_id').value); return false;", id: "agregar_gas_adm", style: 'color: #5d759e;'} Agregar Fila
                                        %i.fa.fa-plus-square.icono-celeste
                          
          .modal-footer
            %button.btn.btn-secondary{"data-dismiss" => "modal"} Cerrar
            - if !solo_lectura
              -#= button_to #button_name, '#', class: 'btn btn-primary', onclick: "guardarPlanActividad(document.getElementById('plan_id').value); return false;"
              = button_to 'Crear Actividad', '#', id: 'button_id', class: 'btn btn-primary', onclick: "guardarPlanActividad(document.getElementById('plan_id').value); return false;" 

  -# POPUP RRHH PROPIOS
  #modal_rrhh_propios-form.modal.fade{tabindex: -1, role: 'dialog', 'aria-labelledby' => 'exampleModalLabel', 'aria-hidden' => 'true'}
    .modal-dialog
      .modal-content
        .modal-body
          = form_with(model: @objetivo_especifico, url: new_objetivo_especifico_fondo_produccion_limpia_path, method: :get, remote: true, html: { class: 'ajax-form' }) do |f|
            .row
              .col-12
                .card
                  .card-header
                    %h5.no-margin
                      Recursos Humanos Propios
                  .card-body
                    %div#div_postulantes_faltantes.table-responsive  
                      %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
                        = hidden_field_tag 'flujo_id', @tarea_pendiente.id, id: 'flujo_id'
                        %thead
                          %tr
                            -#%td.sub-contenido-popup-form ID
                            %td.sub-contenido-popup-form Nombre
                            %td.sub-contenido-popup-form HH en la actividad
                        %tbody
          .modal-footer
            %button.btn.btn-secondary{"data-dismiss" => "modal"} Cerrar
            = button_to 'Continuar', '#', class: 'btn btn-primary', onclick: "guardarRrhhPropioshh(document.getElementById('plan_id').value); return false;"
  -# POPUP RRHH EXTERNOS
  #modal_rrhh_externos-form.modal.fade{tabindex: -1, role: 'dialog', 'aria-labelledby' => 'exampleModalLabel', 'aria-hidden' => 'true'}
    .modal-dialog
      .modal-content
        .modal-body
          = form_with(model: @objetivo_especifico, url: new_objetivo_especifico_fondo_produccion_limpia_path, method: :get, remote: true, html: { class: 'ajax-form' }) do |f|
            .row
              .col-12
                .card
                  .card-header
                    %h5.no-margin
                      Recursos Humanos Externos
                  .card-body
                    %div#div_consultor_faltantes_externos.table-responsive  
                      %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
                        = hidden_field_tag 'flujo_id', @tarea_pendiente.id, id: 'flujo_id'
                        %thead
                          %tr
                            -#%td.sub-contenido-popup-form ID
                            %td.sub-contenido-popup-form Nombre
                            %td.sub-contenido-popup-form HH en la actividad
                        %tbody
          .modal-footer
            %button.btn.btn-secondary{"data-dismiss" => "modal"} Cerrar
            = button_to 'Continuar', '#', class: 'btn btn-primary', onclick: "guardarRrhhExternoshh(document.getElementById('plan_id').value); return false;"

  -# POPUP GASTOS OPERACION
  #modal_gastos_operacion-form.modal.fade{tabindex: -1, role: 'dialog', 'aria-labelledby' => 'exampleModalLabel', 'aria-hidden' => 'true'}
    .modal-dialog
      .modal-content
        .modal-body
          = form_with(model: @gastos_operaciones, url: new_objetivo_especifico_fondo_produccion_limpia_path, method: :get, remote: true, html: { class: 'ajax-form' }) do |f|
            .row
              .col-12
                .card
                  .card-header
                    %h5.no-margin
                      Gastos Operación
                  .card-body
                    %div#div_consultor_faltantes.table-responsive  
                      %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
                        = hidden_field_tag 'flujo_id', @tarea_pendiente.flujo_id, id: 'flujo_id'
                        %thead
                          %tr
                            %td.contenido-form Ítem:
                            %td.contenido-form
                              = f.text_field :nombre, class: 'required-field', id: 'nombre', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                          %tr
                            %td.contenido-form Valor Unitario:
                            %td.contenido-form
                              = f.text_field :valor_unitario, class: 'required-field', id: 'valor_unitario', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;', maxlength: 10, onKeyPress: 'return soloNumeros(event)'
                          %tr
                            %td.contenido-form Cantidad:
                            %td.contenido-form
                              = f.text_field :cantidad, class: 'required-field', id: 'cantidad', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;', maxlength: 3, onKeyPress: 'return soloNumeros(event)'
                          %tr
                            %td.contenido-form Unidad de medida:
                            %td.contenido-form
                              = select_tag(:tipo, options_for_select([['Unidad', 1], ['Global', 2]]), id: 'unidad_medida', class: 'required-field', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;')
                          %tr
                            %td.contenido-form Fuente de financiamiento
                            %td.contenido-form
                              -#= f.text_field :tipo_aporte_id, class: 'required-field', id: 'tipo_aporte_id', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                              - if @tipo_aporte.present?  
                                = select_tag :tipo_aporte_id, options_for_select(@tipo_aporte.map { |tipo| [tipo.nombre, tipo.id] }), class: 'required-field', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tbody
          .modal-footer
            %button.btn.btn-secondary{"data-dismiss" => "modal"} Cerrar
            = button_to 'Guardar', '#', class: 'btn btn-primary', onclick: "insertGastosOperacion(document.getElementById('plan_id').value); return false;"

  -# POPUP GASTOS ADMINISTRACION
  #modal_gastos_administracion-form.modal.fade{tabindex: -1, role: 'dialog', 'aria-labelledby' => 'exampleModalLabel', 'aria-hidden' => 'true'}
    .modal-dialog
      .modal-content
        .modal-body
          = form_with(model: @objetivo_especifico, url: new_objetivo_especifico_fondo_produccion_limpia_path, method: :get, remote: true, html: { class: 'ajax-form' }) do |f|
            .row
              .col-12
                .card
                  .card-header
                    %h5.no-margin
                      Gastos Administración
                  .card-body
                    %div#div_consultor_faltantes.table-responsive  
                      %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
                        = hidden_field_tag 'flujo_id', @tarea_pendiente.flujo_id, id: 'flujo_id'
                        %thead
                          %tr
                            %td.contenido-form Ítem:
                            %td.contenido-form
                              = f.text_field :nombre, class: 'required-field', id: 'nombre_adm', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                          %tr
                            %td.contenido-form Valor Unitario:
                            %td.contenido-form
                              = f.text_field :valor_unitario, class: 'required-field', id: 'valor_unitario_adm', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;', maxlength: 10, onKeyPress: 'return soloNumeros(event)'
                          %tr
                            %td.contenido-form Cantidad:
                            %td.contenido-form
                              = f.text_field :cantidad, class: 'required-field', id: 'cantidad_adm', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;', maxlength: 3, onKeyPress: 'return soloNumeros(event)'
                          %tr
                            %td.contenido-form Unidad de medida:
                            %td.contenido-form
                              = select_tag(:tipo, options_for_select([['Unidad', 1], ['Global', 2]]), id: 'unidad_medida_2', class: 'required-field', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;')
                          %tr
                            %td.contenido-form Fuente de financiamiento
                            %td.contenido-form
                              -#= f.text_field :tipo_aporte_id, class: 'required-field', id: 'tipo_aporte_id', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                              - if @tipo_aporte.present?  
                                = select_tag :tipo_aporte_id_2, options_for_select(@tipo_aporte.map { |tipo| [tipo.nombre, tipo.id] }), class: 'required-field', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tbody
          .modal-footer
            %button.btn.btn-secondary{"data-dismiss" => "modal"} Cerrar
            = button_to 'Continuar', '#', class: 'btn btn-primary', onclick: "insertGastosAdministracion(document.getElementById('plan_id').value); return false;"
            
-# POPUP BUSCAR CONTRIBUYENTE
- custom_id = custom_id.blank? ? nil : custom_id
- data_table = data_table.nil? ? true : data_table
- es_maquinaria = es_maquinaria.blank? ? false : es_maquinaria
- es_para_seleccion = es_para_seleccion.blank? ? false : es_para_seleccion
- seleccion_basica = seleccion_basica.nil? ? false : seleccion_basica
- buscar_por_actividad_economica = buscar_por_actividad_economica.blank? ? false : buscar_por_actividad_economica
- resultado_mostrados = resultado_mostrados.nil? ? 30 : resultado_mostrados
- tipo_instrumento = tipo_instrumento.nil? ? TipoInstrumento::PPP_EJECUTADOS_POR_TERCEROS : tipo_instrumento
- solo_tabla = solo_tabla.nil? ? false : solo_tabla
- lista_contribuyentes = lista_contribuyentes.nil? ? (@contribuyentes.nil? ? [] : @contribuyentes) : lista_contribuyentes
.modal.fade{id: :"buscar-contribuyente-fpl", tabindex: "-1", role: :dialog, "aria-labelledby": :buscarContribuyenteLabel, "aria-hidden": true}
  .modal-dialog.modal-dialog-centered.modal-lg.modal-lg-fix.animated{role: :document}
    .modal-content
      .modal-body
        .container-fluid{id: "body-contribuyente-fpl-buscador"}
          =render 'fondo_produccion_limpias/contribuyentes/buscador_form', custom_id: custom_id, data_table: data_table, es_maquinaria: es_maquinaria, es_para_seleccion: es_para_seleccion, seleccion_basica: seleccion_basica, buscar_por_actividad_economica: buscar_por_actividad_economica, resultado_mostrados: resultado_mostrados, tipo_instrumento: tipo_instrumento, solo_tabla: solo_tabla, lista_contribuyentes: lista_contribuyentes
      .modal-footer
        %button.btn.btn-secondary{type: :button, "data-dismiss"=>:modal}
          Cerrar
  =yield
- ue =  @manifestacion_de_interes.ubicacion_exacta.blank? ? [] : @manifestacion_de_interes.ubicacion_exacta.split(",")
:javascript  

  $(document).ready(function() {
    $('.parent-checkbox').on('click', function() {
      ancestorBlock=$(this).parent();
      childControl=ancestorBlock.children('i[class^="fa"]');
      if((this).checked){
        childGroup=ancestorBlock.children('.group-hide');
      }else{
        childGroup=ancestorBlock.children('.group-show');
        $(this).siblings('ul').find("input[type='checkbox']").prop('checked', this.checked);
      }
      __show_hide_(childGroup,childControl);
    });

    $('.p-chevron').on('click', function(){
      ancestorBlock=$(this).parent().parent().parent();
      childGroup=ancestorBlock.children('.ae-subgroup');
      childControl=$(this).children('.fa');
        __show_hide_(childGroup,childControl);      
    });

    if(#{@flujo.tipo_instrumento_id} == 11) {
      init_coordenadas_territorios();
    }  
      
    document_ready = true;
    if(typeof google != "undefined"){
      mapLoaded();
    }
  });

  $(document).on('click','#nuevo-usuario-fpl-button', function(e){
    const tipo_equipo = this.getAttribute('data-tipo-equipo');
    $.ajax({
      url: "#{insert_fondo_produccion_limpia_path}",
      type: "POST",
      data: {
        id: #{@tarea_pendiente.id},
        flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}",
        tipo_equipo: tipo_equipo,
        estado: 'new'
      }
    }).fail(function(a, b, c) {
      alert( "Error: Verifique su conexión a internet y vuelva a intentar" );
      $('.loading-data').hide();
    }).success(function(data){
      $('#buscar-usuario .body-usuario-buscador').html(data);
      $('.loading-data').hide();
    });
  });

  $(document).on('change keyup', '.form-temporal-boton-guardar-fpl-usuario', function(){
    nuevo_usuario_temporal_fpl_validaciones();
  });

  $(document).on('click', '.seleccionar-y-actualizar-usuario-fpl-button', function(){
    var radioSeleccionado = document.querySelector('input[name="usuario_buscar-usuario"]:checked');
    var valorSeleccionado = radioSeleccionado.value;
    data=JSON.parse(valorSeleccionado);
    var tipo_equipo = $('#tipo_equipo').val();
    $('.loading-data').show();
    $.ajax({
      url: "#{edit_modal_fondo_produccion_limpia_path}",
      type: "GET",
      data: {
        id: "#{@tarea_pendiente.nil? ? '' : @tarea_pendiente.id}",
        flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}",
        user_id: data.id,
        tipo_equipo: tipo_equipo,
        estado: 'update'
      }
    }).fail(function(a, b, c) {
      alert( "El usuario seleccionado ya se encuentra asociado al listado de consultores" );
      $('.loading-data').hide();
    }).success(function(data){
      $('#buscar-usuario .body-usuario-buscador').html(data);
      $('.loading-data').hide();
    });
  });

  $(document).on('click','#deshacer-usuario-fpl-button', function(e){
    e.preventDefault();    
    $('#buscar-usuario .body-usuario-buscador').html("#{j render 'fondo_produccion_limpias/buscador_form'}");
  });

  function nuevo_usuario_temporal_fpl_validaciones(){
    var rut = $('#user_rut').val() != "";
    var nombre_completo = $('#user_nombre_completo').val() != "";
    var email = $('#user_email').val() != "";
    var telefono = $('#user_telefono').val() != "";

    var profesión = document.getElementById('profesión');
    var funciones_proyecto = document.getElementById('funciones_proyecto');
    var valor_hh = document.getElementById('valor_hh');
    var copia_ci = document.getElementById('copia_ci');
    var curriculum_vitae = document.getElementById('curriculum_vitae');

    if(rut && nombre_completo && email && telefono && profesión && funciones_proyecto && valor_hh && copia_ci && curriculum_vitae){
      $('.guarda-usuario-fpl-button').removeAttr("disabled");
    }else{
      $('.guarda-usuario-fpl-button').attr("disabled", true);
    }
  }

  $(document).on('change keyup', '.form-temporal-boton-equipo-trabajo-fpl-usuario', function(){
    nuevo_equipo_trabajo_fpl_validaciones();
  });

  function nuevo_equipo_trabajo_fpl_validaciones() {
    var rut = $('#user_rut').val() != "";
    var nombre_completo = $('#user_nombre_completo').val() != "";
    var email = $('#user_email').val() != "";
    var telefono = $('#user_telefono').val() != "";

    var profesión = $('#profesión').val() != "";
    var funciones_proyecto = $('#funciones_proyecto').val() != "";
    var valor_hh = $('#valor_hh').val() != "";

    var archivoInput = document.getElementById('copia_ci');
    var archivo = archivoInput.files[0];
    var copia_ci = '';
    if (archivo) {
      copia_ci = archivo.name;
    }

    var archivoInput1 = document.getElementById('curriculum');
    var archivo1 = archivoInput1.files[0];
    var curriculum_vitae = '';
    if (archivo1) {
      curriculum_vitae = archivo1.name;
    }

    if (rut && nombre_completo && email && telefono && profesión && funciones_proyecto && valor_hh && copia_ci && curriculum_vitae) {
      $('.guarda-equipo-fpl-button').removeAttr("disabled");
    } else {
      $('.guarda-equipo-fpl-button').attr("disabled", true);
    }
  }

  $('body').on('change','.contribuyente-radio',function() {
    $('.seleccionar-contribuyente-fpl-button').removeAttr('disabled'); 
  });

  $('.seleccionar-contribuyente-fpl-button').click(function() {
    data=JSON.parse($('table.contribuyentes').DataTable().$('.contribuyente-radio:checked').val());
    $.ajax({
      url: "#{insert_modal_contribuyente_fondo_produccion_limpia_path}",
      type: "PATCH",
      data: {
        id: data.id,
        flujo_id: "#{@fondo_produccion_limpia.nil? ? '' : @fondo_produccion_limpia.flujo.id}"
      }
    }).fail(function(a, b, c) {
      alert( "El contribuyente seleccionado ya se encuentra asociado al proyecto" );
      $('.loading-data').hide();
    }).success(function(data){
      $('#buscar-contribuyente-fpl .body-contribuyente-fpl-buscador').html(data);
      $('#buscar-contribuyente-fpl').modal('hide');
      $('.loading-data').hide();
    });
  }); 
