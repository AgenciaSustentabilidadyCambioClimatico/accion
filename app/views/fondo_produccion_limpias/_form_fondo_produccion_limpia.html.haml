:javascript
  var variable = 1;
  function cargarSubLineas(valorLinea) {
     $.ajax({
        url: "#{get_sub_lineas_seleccionadas_path}",
        method: 'get',
        data: {id: valorLinea},
        success: function(data) {
          // Manipula los datos recibidos, por ejemplo, actualiza el combo de sublíneas
          var comboSublineas = $('#fondo_produccion_limpia_sub_linea_id');
          comboSublineas.empty();

          $.each(data.sublineas, function(index, value) {
            comboSublineas.append($('<option>').text(value.descripcion).attr('value', value.id));
          });
        },
        error: function(error) {
          console.error('Error al obtener sublíneas:', error);
        }
      });
  }
  var pais = 'Chile';//aún no se sabe como se manejará la internalización de este proyecto
  var desc = #{raw json_escape(@tipo_instrumentos.inject({}){|h,ti|h[ti.id]=ti.descripcion;h}.to_json)}

  // DZC 2019-07-12 12:22:18 se agregan validaciones
  var validaciones = #{raw json_escape(@validaciones.to_json)};
  var clases = Object.keys(validaciones);
  var descargables = #{raw json_escape(@descargables.to_json)}

  $(document).on('click focus mouseover', '*',function(e){
    if(!$(this).is('abbr')){
      metodo = ['click','focus'].includes(e.type) ? 'hide' : 'enable';
      $(this).tooltip(metodo);
    }
  });

  $(document).on('click', '.x-remove-selection', function(){
    elemento_a_quitar = $(this).attr('value');
    arr_valores = $('#manifestacion_de_interes_programas_o_proyectos_relacionados_ids').val();
    $(this).parent().remove();
    arr_valores = jQuery.grep(arr_valores, function(value) {
      return value != elemento_a_quitar;
    });
    $('#manifestacion_de_interes_programas_o_proyectos_relacionados_ids').val(arr_valores);
    $('#manifestacion_de_interes_programas_o_proyectos_relacionados_ids').select2('close');
  });

  /*$(document).on('click', '.seleccionar-contribuyente-button', function() {
    try {
      //alert('entro contribuyente seleccion');
      //DZC 2019-06-17 13:44:59 se modifica para considerar el contribuyente que ha sido escogido en otra página
      //data=JSON.parse($('.contribuyente-radio:checked').val());
      //data=JSON.parse($('table.contribuyentes').DataTable().$('.contribuyente-radio:checked').val());
      //$("#manifestacion_de_interes_contribuyente_id").val(data.id);
      //$("#manifestacion_de_interes_contribuyente_id").change();
      //$("#manifestacion_de_interes_representante_institucion_para_solicitud_id").val("");
      //$("#manifestacion_de_interes_representante_institucion_para_solicitud_id").change();
    } catch(e) {
      alert("Ocurrió un error. Intente nuevamente o contáctese con el administrador del sitio.\n\nMensaje de error: "+e);
    }
  });*/

  $('.seleccionar-contribuyente-button').click(function() {
    try {
      //DZC 2019-06-17 13:44:59 se modifica para considerar el contribuyente que ha sido escogido en otra página
      //data=JSON.parse($('.contribuyente-radio:checked').val());
      data=JSON.parse($('table.contribuyentes').DataTable().$('.contribuyente-radio:checked').val());

      $("select#responsable_contribuyente_id").append($("<option selected='selected' value='"+data.id+"'>"+data.razon_social+"</option>"));
      $("input#responsable_contribuyente_id").val(data.id);
      checkFieldValidity($("select#responsable_contribuyente_id"));
      $("i.deseleccionar-contribuyente").show();
      reset_actectos_tipo_contribuyente();
      //rellena_tipo_contribuyente(tipos_contr, data.tipo_contribuyentes);
      $.each($("select#responsable_actividad_economica_id option"),function(k,v) {
        if ( $.inArray( parseInt( $(v).val() ), data.actividades_economicas) == -1 ) { $(v).remove(); }
      });
      $.each($("select#responsable_tipo_contribuyente_id option"),function(k,v) {
        if ( $.inArray(parseInt( $(v).val() ), data.tipo_contribuyentes) == -1 ) { $(v).remove(); }
      });
      $("select#responsable_actividad_economica_id").trigger("chosen:updated");
      $("select#responsable_tipo_contribuyente_id").trigger("chosen:updated");
    } catch(e) {
      alert("Ocurrió un error. Intente nuevamente o contáctese con el administrador del sitio.\n\nMensaje de error: "+e);
    }

    $('.chosen-control').on('chosen:showing_dropdown', function(evt, params) {
      console.log('lala');
      console.log($(this).find('option'));
      //compress()
    });

  });   

  //Permite que al seleccionar un usuario desde el modal se adjunte su información
  $(document).on('click' , '.seleccionar-usuario-button', function() {
    try {
      data=JSON.parse($('table.usuarios').DataTable().$('.contribuyente-radio:checked').val());
      $("#manifestacion_de_interes_representante_institucion_para_solicitud_id").append(new Option("--", data.id));
      $("#manifestacion_de_interes_representante_institucion_para_solicitud_id").val(data.id);
      $("#manifestacion_de_interes_representante_institucion_para_solicitud_id").change();
    } catch(e) {
      alert("Ocurrió un error. Intente nuevamente o contáctese con el administrador del sitio.\n\nMensaje de error: "+e);
    }
  });

  $(document).ready(function(){
    sumarTrabajadoresPermanentes();
    sumarTrabajadoresTemporales();
    sumarValores(); 
    sumarValoresTec();
    
    valida_div();

    //var divEquipoConsultora = document.getElementById('div_equipo_consultora');
    //divEquipoConsultora.style.display = 'none';
    
    //var divEquipoConsultoraEmpresa = document.getElementById('div_equipo_consultora_empresa');
    //divEquipoConsultoraEmpresa.style.display = 'none';
    
    $("#intitucion_cogestora").click(function(){
      alert('entro a buscador');
      $('#buscador-contribuyente').html("#{j render 'admin/contribuyentes/buscador', es_para_seleccion: true, seleccion_basica: true, tipo_instrumento: 28, resultado_mostrados: 10}");
    });

    $("#institucion_cogestora").click(function(){
    });

    $('#open-modal-button').click(function(){
      $('#modal_objetivos-form').modal('show');
    });

    $('#open-modal-button_crear_equipo_receptora').click(function(){
      $('#modal_postulante_create-form').modal('show');
    });

    $('#open-modal-button_crear_equipo_consultora').click(function(){
      $('#modal_consultora_create-form').modal('show');
    });

    //$('#open-modal-button_crear_plan_actividades').click(function(){
    //  $('#modal_plan_actividades-form').modal('show');
    //});
    
    
    /*$('#open-modal-button_buscar_usuario').click(function(){
      var modalBuscarUsuario = document.getElementById("buscar-usuario");
      $(modalBuscarUsuario).modal('show');
    });*/

    $('#open-modal-button_buscar_usuario').click(function(){
      $('#buscar-usuario .body-usuario-buscador').html("#{j render('fondo_produccion_limpias/buscador_form', modal_id: 'buscar-usuario', tipo_equipo: '1')}");
      $('#buscar-usuario').modal("show");
    });

    $('#open-modal-button_buscar_contribuyente').click(function(){
        $("#buscar-contribuyente").modal('show');
    });

    $('#open-modal-button_buscar_usuario_consultora').click(function(){
      $('#buscar-usuario .body-usuario-buscador').html("#{j render('fondo_produccion_limpias/buscador_form', modal_id: 'buscar-usuario', tipo_equipo: '2')}");
      $('#buscar-usuario').modal("show");
    });

    $('#open-modal-button_buscar_usuario_postulante').click(function(){
        $('#buscar-usuario .body-usuario-buscador').html("#{j render('fondo_produccion_limpias/buscador_form', modal_id: 'buscar-usuario', tipo_equipo: '3')}");
        $('#buscar-usuario').modal("show");
    });

    if(#{!solo_lectura}){
      $('#manifestacion_de_interes_acuerdo_previo_con_informe_id').select2({
        placeholder: 'Seleccione un Acuerdo previo',
        allowClear: true,
        width: '100%'
      });
      $('#manifestacion_de_interes_estandar_de_certificacion_id').select2({
        placeholder: 'Seleccione un estándar',
        allowClear: true,
        width: '100%'
      });
      $('#manifestacion_de_interes_diagnostico_id').select2({
        placeholder: 'Seleccione un diagnóstico',
        allowClear: true,
        width: '100%'
      });
      $('#manifestacion_de_interes_programas_o_proyectos_relacionados_ids').select2({
        placeholder: 'Seleccione uno o varios programas',
        width: '100%'
      }); 
    } 

    $('#manifestacion_de_interes_programas_o_proyectos_relacionados_ids').on('select2:select', function(e){
      var data = e.params.data;
      create_span_de_selector_ppp(data.id);
    });

    $('#manifestacion_de_interes_programas_o_proyectos_relacionados_ids').on('select2:unselect', function(e){
      var data = e.params.data;
      $(".selection-list-boxes[value=" + data.id +"]").remove();
    });    

    function create_span_de_selector_ppp(id){
      selector_ppp = $('#manifestacion_de_interes_programas_o_proyectos_relacionados_ids');
      op = selector_ppp.children("[value=" + id + "]");
      x_span = "<a class='x-remove-selection' value='" + id + "'><span style='color: #999;'>×</span></a>";
      $('#selection-container').append("<span class='selection-list-boxes' value='"+id+"'>" + x_span + op.text() + "</span>");
    };

    verificarModal();
    process_mantenedor_campos();
    //activa_validaciones();

    $('body').on('change','.usuario-radio',function() {
      $('.seleccionar-usuario-button').removeAttr('disabled');
      $('.seleccionar-y-actualizar-usuario-fpl-button').removeAttr('disabled');
    });


    // ## 
    // # DOSSA 2019-09-10 16:48
    // # Se comenta función ya que el tab Datos Proyecto debe disponibilizarse siempre.
    //verificarPreinversion();
    //$("#area-influencia-proyecto-mapa").focusout(function(e){
      //if( $(document.activeElement).parents('div#area-influencia-proyecto-mapa').length ) {
        //console.log("yes");
      //}else{
        //console.log("no");
      //}

      //$('#manifestacion_de_interes_area_influencia_proyecto_data').trigger("change");
    //});

    $('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
      $('#manifestacion_de_interes_current_tab').val($(this).attr('id'));
    });
    $('#manifestacion_de_interes_tipo_instrumento_id').change(function(){
      if ( $(this).val() !== "" ) {
        $('#manifestacion_de_interes_descripcion_acuerdo').html(desc[$(this).val()]);
      }
    });

    function checkbox_related_element(c) {
      element = $('#'+$(c).parents('.form-group').find('label.boolean').attr('for'));
      if (element === undefined) {
        return jQuery.extend();
      } else {
        return element;
      }
    }

    function when_checkbox_is_true(checkbox) {
      relement=checkbox_related_element(checkbox);
      if ( relement.prop('tagName') == 'DIV' ) {
        relement.show('slow');
      } else {
        relement.removeAttr('readonly');
      }
    }

    function when_checkbox_is_false(checkbox) {
      relement=checkbox_related_element(checkbox);
      if ( relement.prop('tagName') == 'DIV' ) {
        relement.hide('slow');
      } else {
        relement.attr('readonly','readonly');
      }
    }

    __enable_fieds_if_checkbox_is_true($('[type="radio"]:checked'), when_checkbox_is_true, when_checkbox_is_false);
    $('[type="radio"]').click(function(){
      __enable_fieds_if_checkbox_is_true($(this), when_checkbox_is_true, when_checkbox_is_false);
    });

    $('#enviar-manifestacion-button').click(function(e){
      $('#manifestacion_de_interes_temporal').val("");
    });

    if(#{!solo_lectura}){
      $(".radios-selector-subida").on("change", function(){
        padre = $(this).closest('.radios-selector-subida-padre');
        check = $(this).val(); 
        if( check == 0 ){
          padre.find("input[type='file']").attr("disabled",false);
          padre.find("select").attr("disabled",true);
          padre.find(".descargable-file").removeClass("d-none");
          padre.find(".descargable-select").addClass("d-none");
        }
        else if( check == 1 ){
          padre.find("input[type='file']").attr("disabled",true);
          padre.find("select").attr("disabled",false);
          padre.find(".descargable-file").addClass("d-none");
          padre.find(".descargable-select").removeClass("d-none");
        };
      });
      $(".radios-selector-subida:checked").trigger("change");
    }
    
    //# DOSSA 2019-09-24 17:00 se comenta ya que no es necesaria esta validación
    //Validar que solo se leccione o un diagnostico o un estandar, no ambos.-
    //if($('#manifestacion_de_interes_diagnostico_id').val() != '' && $('#manifestacion_de_interes_diagnostico_id').val() != null){
      //console.log($('#manifestacion_de_interes_diagnostico_id').val())
      //$('#manifestacion_de_interes_estandar_de_certificacion_id').attr('disabled', true);
      //$('#manifestacion_de_interes_estandar_de_certificacion_id').val("");
    //}
    //if($('#manifestacion_de_interes_estandar_de_certificacion_id').val() != '' && $('#manifestacion_de_interes_estandar_de_certificacion_id').val() != null){
      //$('#manifestacion_de_interes_diagnostico_id').attr('disabled', true);
      //$('#manifestacion_de_interes_diagnostico_id').val("");
    //}

    //DZC 2019-02-28 20:01:23 configura la visualización del mensaje recuerde_guardar

    //DZC 2019-03-01 12:58:16 elimina los timeouts pendientes
    var id = window.setTimeout(function() {}, 0);
    while (id--) {
      window.clearTimeout(id);
    };
    //DZC 2019-03-01 12:58:34 crea un nuevo timeout
    var minutos = "#{@recuerde_guardar_minutos}";
    setTimeout(function showModal() {
      $('#mensaje_recuerde_guardar').modal('show');
      var minutos = "#{@recuerde_guardar_minutos}";
      setTimeout(showModal, ((+minutos)*60*1000));
      }, ((+minutos)*60*1000)
    );

    $(".show-ayuda").on("click",function(){
      id_campo_boton = $(this).attr("campo");
      $(".ayuda-campo-div-"+id_campo_boton).toggle(700);
    });

    $(".card-wrap").each(function(){
      $(this).addClass("card");
      $(this).css("margin-bottom", "0");
    });

    // Manejar el clic en el enlace para abrir el modal
    /*$('#open-modal-link').on('click', function(e) {
      e.preventDefault();

      // Realizar una solicitud AJAX para obtener el formulario
      $.ajax({
        url: '/objetivo_especificos/new',
        method: 'GET',
        dataType: 'html',
        success: function(response) {
          alert(response);
          // Agregar el formulario al contenedor del modal
          $('#modal-container').html(response);

          // Mostrar el modal
          //$('#myModal').modal('show');
          $('#tuModal').html(response).modal('show');
        },
        error: function() {
          alert('Error al cargar el formulario.');
        }
      });

    $('#open-modal-linkxxx').on('click', function(e) {
      e.preventDefault(); // Evita la acción predeterminada (por ejemplo, seguir un enlace)

        // Realiza la solicitud AJAX
        $.ajax({
          type: 'GET', // Puedes cambiarlo según tus necesidades
          url: '/objetivo_especificos/new', // Ruta a la acción del controlador
          success: function(response) {
            alert(response);
            // La respuesta del servidor. Aquí puedes manipular la respuesta, por ejemplo, mostrarla en un modal.
            console.log(response);
            $('#tuModal').html(response).modal('show');
            // Agrega el código aquí para manejar la respuesta, por ejemplo, mostrarla en un modal.
          },
          error: function(error) {
            // Manejo de errores, si es necesario.
            console.error(error);
          }
        });
      });
    });*/
  });
  //DZC 2019-07-17 22:02:04 activa los listeners para las validaciones por incumplimiento de cantidades minimas y maximas de caracteres
  function activa_validaciones(){
    elementos_ids = id_elementos_a_validar();
    elementos_validaciones = validaciones_por_elemento();
    elementos_ids.forEach(function(elemento_id, index, arr){
      var validaciones_activas = elementos_validaciones[elemento_id]["validaciones_activas"];
      if (validaciones_activas && #{!solo_lectura}){
        var max_activa = elementos_validaciones[elemento_id]["validacion_max_activa"];
        var min_activa = elementos_validaciones[elemento_id]["validacion_min_activa"];
        var max = elementos_validaciones[elemento_id]["validacion_max"];
        var min = elementos_validaciones[elemento_id]["validacion_min"];
        var tipo = elementos_validaciones[elemento_id]["tipo"];
        largo_campo = $(elemento_id).text().length;
        condicional = (((min_activa && largo_campo < min) || (max_activa && largo_campo > max)) && largo_campo > 0);
        label_inicial = condicional ? "\u26a0 Caracteres: " : "Caracteres: ";
        label_max = (max_activa) ? "de " + max : "";
        label_min = (min_activa) ? " (mínimo " + min + ")" : "";
        $(elemento_id).after(label_contador(label_inicial, label_min, label_max, largo_campo, condicional));
        // # DOSSA 2019-07-29 se cambia función para cuando se agreguen valores en el input ya que la función "keyup" sólo reconocía los cambios al presionar y soltar una tecla, esta nueva función reconoce todos los cambios en el input.
        $(elemento_id).on("input propertychange",function (){
          // DOSSA 2019-07-29 se hace condición única para mínimo y máximo, ya que ambas hacen lo mismo
          largo_actual = $(this).val().length;
          if ( (min_activa && largo_actual < min) || (max_activa && largo_actual > max) ){
            // # DOSSA 2019-07-29 label que agrega símbolo unicode en caso de que el texto ingresado sea menor al mínimo o mayor al máximo.
            label_inicial_m = "\u26a0 Caracteres: "
            // # DOSSA 2019-07-29 en caso de que la validación máxima esté activa, la variable label_max tendrá un valor específico.
            label_max_m = (max_activa) ? "de " + max : "";
            // # DOSSA 2019-07-29 en caso de que la validación mínima esté activa, la variable label_min tendrá un valor específico.
            label_min_m = (min_activa) ? " (mínimo " + min + ")" : "";
            $(this).next().remove();
            $(this).after(label_contador( label_inicial_m, label_min_m, label_max_m, largo_actual, true ));
          }else{
            label_max_m = (max_activa) ? "de " + max : "";
            label_min_m = (min_activa) ? " (mínimo " + min + ")" : "";
            $(this).css('color','#495057');
            $(this).next().remove();
            $(this).after(label_contador( label_inicial, label_min_m, label_max_m, largo_actual, false ));
          };
        });
      }else if (tipo == "text" || tipo == "integer" || tipo == "double"){
        $(elemento_id).after("<label class='float-right control-label' style='color: #0000'><br></label>")
      }
    });
  };

  // DZC 2019-07-17 19:44:46 retorna los ids de los doms a validar
  function id_elementos_a_validar(){
    elementos = [];
    for (var modelo in validaciones){
      for (var campo in validaciones[modelo]){
        elementos.push("#" + modelo + "_" + campo);
      };
    };
    return elementos;
  };

  //DZC 2019-07-17 19:46:42 retorna un hash con el id del dom, y sus validaciones asociadas
  function validaciones_por_elemento(){
    elementos = {};
    for (var modelo in validaciones){
      for (var campo in validaciones[modelo]){
        elementos["#" + modelo + "_" + campo]={};
        for (var validacion in validaciones[modelo][campo]){
          elementos["#" + modelo + "_" + campo][validacion] = validaciones[modelo][campo][validacion];
        };
      };
    };
    return elementos;
  };

  //DZC 2019-07-17 19:59:04 retorna los elementos del dom a validar
  function elementos_a_validar_dom(){
    elementos = {};
    $.each(clases, function(index, value){
      texto = "[id*='";
      texto += value;
      texto += "']";
      elementos[value] = $(texto);
    });
    return elementos;
  };

  // # DOSSA 2019-07-29 función que crea label que muestra el contador, máximo y mínimo de caracteres en caso de que corresponda, además agrega un label inicial el cual contendra
  //    un símbolo unicode cuando sea necesario.
  function label_contador( label_inicial, label_min, label_max, largo = 0, cond){
    if(cond){
      color = "red";
    }else{
      color = "#5d759e";
    };
    label = "<label class='float-right control-label' style='color:" + color + "'>" + label_inicial + "<b>" + largo + "</b>" + " " + label_max + label_min + "</label>";
    return label;
  };

  //Procesar label, ayuda y tooltip
  function process_mantenedor_campos(){
    elementos_ids = id_elementos_a_validar();
    elementos_validaciones = validaciones_por_elemento();

    var ids_a_evitar = ["#manifestacion_de_interes_area_influencia_proyecto_data", "#manifestacion_de_interes_alternativas_instalacion_data"];
    if(#{!solo_lectura}){
      ids_a_evitar.push("#manifestacion_de_interes_actividad_economicas_ids");
      ids_a_evitar.push("#manifestacion_de_interes_comunas_ids");
      ids_a_evitar.push("#manifestacion_de_interes_cuencas_ids");
    }else{
      ids_a_evitar.push("#manifestacion_de_interes_acuerdo_de_alcance_nacional");
    }

    elementos_ids.forEach(function(elemento_id, index, arr){
      var obligatorio = elementos_validaciones[elemento_id]["obligatorio_campo"];
      var nombre = elementos_validaciones[elemento_id]["nombre"];
      var ayuda_activo = elementos_validaciones[elemento_id]["ayuda_activo"];
      var ayuda = elementos_validaciones[elemento_id]["ayuda"];
      var id_campo = elementos_validaciones[elemento_id]["id_campo"];
      var tooltip_activo = elementos_validaciones[elemento_id]["tooltip_activo"];
      var texto_tooltip = elementos_validaciones[elemento_id]["tooltip"];
      var validaciones_activas = elementos_validaciones[elemento_id]["validaciones_activas"];
      var elemento_tipo = elementos_validaciones[elemento_id]["tipo"];

      elemento_padre = $(elemento_id).parent();
      label = crear_label_de_nombre(elemento_id, obligatorio, nombre);
      boton_ayuda = "";
      div_ayuda = "";
      if(ayuda_activo){
        boton_ayuda = crear_boton_de_ayuda(id_campo);
        div_ayuda = crear_div_de_ayuda(ayuda, id_campo)
      };

      //Fix para radio buttons
      row_de_radio = elemento_padre.parent().children('.align-items-end');
      if(row_de_radio.length > 0){
        row_de_radio.append("<div class='col'>"+label+"</div>");
        row_de_radio.append("<div class='col-auto pr-1'>"+boton_ayuda+"</div>");
        row_de_radio.after("<div class='row'><div class='col'>"+div_ayuda+"</div></div>");
      }else if(elemento_tipo == "list" && ayuda_activo && #{!solo_lectura}){
        $(elemento_id).after("<div class='card-body group-hide ayuda-div py-1' style='font-size: 13px;'>" + ayuda + "</div>")
      }else{
        if (!ids_a_evitar.includes(elemento_id)){
          top_input = "<div class='row align-items-end'>";
          top_input += "<div class='col'>"+label+"</div>";
          top_input += "<div class='col-auto pr-0'>"+boton_ayuda+"</div>";
          top_input += "</div>";
          top_input += "<div class='row'>";
          top_input += "<div class='col'>"+div_ayuda+"</div>";
          top_input += "</div>";
          elemento_padre.children(".control-label").first().remove();
          elemento_padre.prepend(top_input);
        }
      }

      if (tooltip_activo && (elemento_id != "#manifestacion_de_interes_descarga_formato_cartas_de_patrocinio" || ('APL-001-DES-003' in descargables))){ 
        crear_tooltip(elemento_id, texto_tooltip); 
      }
    });
    if(#{!@mantener_temporal}){
      htmlErrorToTooltip('top');
    };
    __tooltip({placement: 'top'});
  };

  // # DOSSA 2019-08-12 12:25 Función encargada de crear el div con las clases, atributos y texto el cual debe ser pasado como parámetro cuando se invoca esta función.
  function crear_div_de_ayuda(contenido, id_campo){
    div_ayuda = "<div class='ayuda-campo-div-"+id_campo+" alert ayuda-div small' style='display: none;'>" + contenido + "</div>";
    return div_ayuda;
  };

  // # DOSSA 2019-08-12 12:26 Función encargada de crear el botón para los campos que posean la ayuda activa en el mantenedor.
  function crear_boton_de_ayuda(id_campo){
    i = "<i class='fa fa-info-circle' style='color: #0c5460;'></i>";
    a = "<a class='btn show-ayuda pb-0' campo='" + id_campo + "' >" + i + "</a>";
    return a;
  };

  function crear_label_de_nombre(elemento, obligatorio, nombre){
    elemento_sin_gato = elemento.slice(1);
    if (obligatorio){
      abbr = "<abbr title='Campo requerido'>*</abbr>"
      label_nombre = "<label class='control-label label-nombre text required' for='" + elemento_sin_gato + "'>" + abbr + " " + nombre + "</label>";
    }else{
      label_nombre = "<label class='control-label label-nombre text' for='" + elemento_sin_gato + "'>" + nombre + "</label>";
    };
    return label_nombre;
  };

  function crear_tooltip(elemento_id, tooltip){
    var card_header = $('input[name="manifestacion_de_interes['+elemento_id.replace("#manifestacion_de_interes_", "")+'][]"]').closest(".card").children(".card-header");
    if(elemento_id.includes("_ids") && card_header.length > 0){
      if(!card_header.parent().hasClass("has-error")){
        card_header.addClass('tooltip-block');
        card_header.attr('data-tooltip','true');
        card_header.attr('data-original-title', tooltip);
      }
    }else if($(elemento_id).hasClass('select2-hidden-accessible')){
      $(elemento_id).parent().children('span').addClass('tooltip-block');
      $(elemento_id).parent().children('span').attr('data-tooltip','true');
      $(elemento_id).parent().children('span').attr('data-original-title', tooltip);
    }else if($(elemento_id).hasClass('file')){
      if(!$(elemento_id).parent().hasClass('has-error')){
        $(elemento_id).parent().addClass('tooltip-block');
        $(elemento_id).parent().attr('data-tooltip','true');
        $(elemento_id).parent().attr('data-original-title', tooltip);
      }
    }else{
      $(elemento_id).attr("title","");
      $(elemento_id).addClass('tooltip-block');
      $(elemento_id).attr('data-tooltip','true');
      $(elemento_id).attr('data-original-title', tooltip);
    }
  }

  function sumarValores() {
    // Obtener todos los elementos con la clase 'valor-a-sumar'
    var camposDeTexto = document.querySelectorAll('.valor-a-sumar');
    var total = document.getElementById('total');

    // Inicializar la variable para la suma
    var suma = 0;

    // Iterar sobre los campos de texto y sumar los valores
    camposDeTexto.forEach(function (campo) {
      // Obtener el valor del campo de texto y convertirlo a un número
      var valor = parseFloat(campo.value) || 0;

      // Sumar al total
      suma += valor;
    });

    // Mostrar el resultado o hacer algo con la suma
    total.textContent = suma;
  }

  function sumarValoresTec() {
    // Obtener todos los elementos con la clase 'valor-a-sumar-tec'
    var camposDeTexto = document.querySelectorAll('.valor-a-sumar-tec');
    var total = document.getElementById('total_tecnica');

    // Inicializar la variable para la suma
    var suma = 0;

    // Iterar sobre los campos de texto y sumar los valores
    camposDeTexto.forEach(function (campo) {
      // Obtener el valor del campo de texto y convertirlo a un número
      var valor = parseFloat(campo.value) || 0;

      // Sumar al total
      suma += valor;
    });

    // Mostrar el resultado o hacer algo con la suma
    total.textContent = suma;
  }

   function sumarTrabajadoresPermanentes() {
    // Obtener todos los elementos con la clase 'valor-a-sumar'
    var camposDeTexto = document.querySelectorAll('.valor-permanentes');
    var total = document.getElementById('total_permanente');

    // Inicializar la variable para la suma
    var suma = 0;

    // Iterar sobre los campos de texto y sumar los valores
    camposDeTexto.forEach(function (campo) {
      // Obtener el valor del campo de texto y convertirlo a un número
      var valor = parseFloat(campo.value) || 0;

      // Sumar al total
      suma += valor;
    });

    // Mostrar el resultado o hacer algo con la suma
    total.textContent = suma;

    sumarTrabajadoresPromedio();
  }

  function sumarTrabajadoresTemporales() {
    // Obtener todos los elementos con la clase 'valor-a-sumar'
    var camposDeTexto = document.querySelectorAll('.valor-temporales');
    var total = document.getElementById('total_temporales');

    // Inicializar la variable para la suma
    var suma = 0;

    // Iterar sobre los campos de texto y sumar los valores
    camposDeTexto.forEach(function (campo) {
      // Obtener el valor del campo de texto y convertirlo a un número
      var valor = parseFloat(campo.value) || 0;

      // Sumar al total
      suma += valor;
    });

    // Mostrar el resultado o hacer algo con la suma
    total.textContent = suma;

    sumarTrabajadoresPromedio();
  }

  function sumarTrabajadoresPromedio() {
    var permanentes_hombres = document.getElementById('permanentes_hombres');
    var temporales_hombres = document.getElementById('temporales_hombres');
    var total_hombres = document.getElementById('total_hombres');

    var permanentes_mujeres = document.getElementById('permanentes_mujeres');
    var temporales_mujeres = document.getElementById('temporales_mujeres');
    var total_mujeres = document.getElementById('total_mujeres');

    var valor_permanentes = parseFloat(permanentes_hombres.value) || 0;
    var valor_temporales = parseFloat(temporales_hombres.value) || 0;

    var resultado = valor_permanentes + valor_temporales;

    total_hombres.textContent = resultado;

    var valor_permanentes_mujeres = parseFloat(permanentes_mujeres.value) || 0;
    var valor_temporales_mujeres = parseFloat(temporales_mujeres.value) || 0;

    var resultado_mujeres = valor_permanentes_mujeres + valor_temporales_mujeres;

    total_mujeres.textContent = resultado_mujeres;

    var valor_resultado_hombres = parseFloat(resultado) || 0;
    var valor_resultado_mujeres = parseFloat(resultado_mujeres) || 0;

    var total = valor_resultado_hombres + valor_resultado_mujeres;

    total_trabajadores.textContent = total;

  }

  function duracion() {
    var duracion = document.getElementById('duracion_proyecto');
    var valorSeleccionado = duracion.value;
    var tareaPendienteId = document.getElementById('tarea_pendiente_id');

    // Realizar una solicitud AJAX al servidor
    $.ajax({
      type: 'POST',
      url: '/guardar_duracion',
      data: { duracion: valorSeleccionado, id: tareaPendienteId.value },
      success: function(response) {
        console.log('Duración guardada exitosamente en el servidor');
        //location.reload();
      },
      error: function(error) {
        console.error('Error al guardar la duración en el servidor:', error);
      }
    });  
  }

  function habilitaJustificacion() {
    // Seleccionar el elemento select
    var duracion_proyecto = document.getElementById('duracion_proyecto');
    var justificacion_duracion = document.getElementById('justificacion_duracion');
    var titulo_justificacion = document.getElementById('titulo_justificacion');
    
    // Obtener el valor seleccionado
    var valorSeleccionado = duracion_proyecto.value;
    
    // Mostrar un alert con el valor seleccionado
    if (valorSeleccionado && valorSeleccionado < 5) {
      justificacion_duracion.style.visibility = 'hidden';
      titulo_justificacion.style.visibility = 'hidden';
    } else {
      justificacion_duracion.style.visibility = 'visible';
      titulo_justificacion.style.visibility = 'visible';
    }
  }

  function guardarObjetivo() {
    var valueFlujoId = document.getElementById('flujo_id').value;
    var valueDescripcion = document.getElementById('descripcion').value;
    var valueMetodologia = document.getElementById('metodologia').value;
    var valueResultado = document.getElementById('resultado').value;
    var valueIndicadores = document.getElementById('indicadores').value;

    $.ajax({
      url: "/objetivo_especificos/create",
      data: { flujo_id: valueFlujoId, descripcion: valueDescripcion, metodologia: valueMetodologia, resultado: valueResultado, indicadores: valueIndicadores },
      method: "POST",
      dataType: "script",
      success: function(response) {
        console.log("Método del controlador llamado con éxito");
      },
      error: function(error) {
        console.error("Error al llamar al método del controlador", error);
      }
    });
  }

  /*$(document).on('click', '.crear-objetivo', function() {
      $.ajax({
      url: '/objetivo_especificos/new',
      method: "GET",
      success: function(response) {
        $('#modal_objetivos-form').modal('show');
        console.log("Método del controlador llamado con éxito");
      },
      error: function(error) {
        console.error("Error al llamar al método del controlador", error);
      }
    });
  });*/

  $(document).on('click', '.editar-objetivo', function() {
    var objetivoId = $(this).data('objetivo-id');
    editarObjetivo(objetivoId);
  });

  function editarObjetivo(id) {
    $.ajax({
      url: '/objetivo_especificos/' + id + '/edit',
      data: { id: id },
      method: "GET",
      success: function(response) {
        $('#modal_objetivos-edit-form').modal('show');
        console.log("Método del controlador llamado con éxito");
      },
      error: function(error) {
        console.error("Error al llamar al método del controlador", error);
      }
    });
  }

  function crearPlanActividades(plan_id){
    //alert(plan_id);
     //alert('entro buscador')
    $.ajax({
      url: "#{get_plan_actividades_fondo_produccion_limpia_path}",
      data: { plan_id: plan_id},
      method: "GET",
      success: function(response) {
        $('#modal_create_plan_actividades-form').modal('show');
        console.log("Método del controlador llamado con éxito");
      },
      error: function(error) {
        console.error("Error al llamar al método del controlador", error);
      }
    });
  }

  function modalRrhhPropios(id){
    //alert(id);
    $.ajax({
      url: "#{get_recursos_propios_fondo_produccion_limpia_path}",
      data: { actividad_id: id},
      method: "GET",
      success: function(response) {
        $('#modal_rrhh_propios-form').modal('show');
        console.log("Método del controlador llamado con éxito");
      },
      error: function(error) {
        console.error("Error al llamar al método del controlador", error);
      }
    });
  }

  function modalRrhhExternos(id){
    $.ajax({
      url: "#{get_recursos_externos_fondo_produccion_limpia_path}",
      data: { actividad_id: id},
      method: "GET",
      success: function(response) {
        $('#modal_rrhh_externos-form').modal('show');
        console.log("Método del controlador llamado con éxito");
      },
      error: function(error) {
        console.error("Error al llamar al método del controlador", error);
      }
    });
  }
    
  function optionSelect(tipo){
    //alert("check "+tipo);
    var divEquipoConsultora = document.getElementById('div_equipo_consultora');
    var divEmpresaConsultora = document.getElementById('div_empresa_consultora');
    var divEquipoConsultoraEmpresa = document.getElementById('div_equipo_consultora_empresa');
    
    if (tipo == 1) {
      divEquipoConsultora.style.display = 'none';
      divEmpresaConsultora.style.display = 'block';
      divEquipoConsultoraEmpresa.style.display = 'block';
      
    } else if (tipo == 2){
      divEquipoConsultora.style.display = 'block';
      divEmpresaConsultora.style.display = 'none';
      divEquipoConsultoraEmpresa.style.display = 'none'; 
    } else  if (tipo == 0){
      divEquipoConsultora.style.display = 'none';
      divEmpresaConsultora.style.display = 'block';
      divEquipoConsultoraEmpresa.style.display = 'none';
    }
  }

  function valida_div(){
    
    var divEquipoConsultora = document.getElementById('div_equipo_consultora');
    var divEmpresaConsultora = document.getElementById('div_empresa_consultora');
    var divEquipoConsultoraEmpresa = document.getElementById('div_equipo_consultora_empresa');

    var tipo = document.getElementById('tipos').getAttribute('data-tipo');
    //alert("entro check "+tipo);
    //alert(tipo);
    if (tipo == 2) {
      divEquipoConsultora.style.display = 'none';
      divEmpresaConsultora.style.display = 'block';
      divEquipoConsultoraEmpresa.style.display = 'block';
      $('#open-modal-button_buscar_contribuyente').prop('disabled', true);
    } else if (tipo == 1){
      divEquipoConsultora.style.display = 'block';
      divEmpresaConsultora.style.display = 'none';
      divEquipoConsultoraEmpresa.style.display = 'none'; 
    } else  if (tipo == 0){
      divEquipoConsultora.style.display = 'none';
      divEmpresaConsultora.style.display = 'block';
      divEquipoConsultoraEmpresa.style.display = 'none';
      $('#open-modal-button_buscar_contribuyente').prop('disabled', false);
    }
   
  }

  function actualizarObjetivo() {
    var valueId = document.getElementById('id_edit').value;
    var valueFlujoId = document.getElementById('flujo_id_edit').value;
    var valueDescripcion = document.getElementById('descripcion_edit').value;
    var valueMetodologia = document.getElementById('metodologia_edit').value;
    var valueResultado = document.getElementById('resultado_edit').value;
    var valueIndicadores = document.getElementById('indicadores_edit').value;

    $.ajax({
      url: "/objetivo_especificos/" + valueId + "/update",
      data: {
        id: valueId, 
        flujo_id: valueFlujoId, 
        descripcion: valueDescripcion,
        metodologia: valueMetodologia,
        resultado: valueResultado,
        indicadores: valueIndicadores,
        authenticity_token: $('meta[name="csrf-token"]').attr('content') // CSRF token
      },
      method: "PATCH",
      success: function(response) {
        console.log("Método del controlador llamado con éxito");
      },
      error: function(error) {
        console.error("Error al llamar al método del controlador", error);
      }
    });
  }

  $(document).ready(function() {
    // Obtén el valor de la URL para activar el tab correspondiente
    var urlParams = new URLSearchParams(window.location.search);
    var activeTab = urlParams.get('tabs');

    // Si hay un valor en 'tabs', activa el tab correspondiente
    if (activeTab) {
      $('#manifestacion a[href="#' + activeTab + '"]').tab('show');
    }
  });

  $('#buscar-usuario').on('hidden.bs.modal', function () {
    // Aquí puedes llamar a tu función JavaScript después de que el modal se haya ocultado
    tuFuncionJavaScript();
  });

  function tuFuncionJavaScript() {
    // Código de tu función aquí
    alert("entro aqui");
  }

  function iniciarBuscar(id) {
    //alert('entro buscador')
    $.ajax({
      url: "#{buscador_fondo_produccion_limpia_path}",
      data: { id2: id},
      method: "GET",
      success: function(response) {
        //$('#modal_objetivos-edit-form').modal('show');
        console.log("Método del controlador llamado con éxito");
      },
      error: function(error) {
        console.error("Error al llamar al método del controlador", error);
      }
    });
  }

%style
  :css
    .table-responsive {
      width: 100%;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      -ms-overflow-style: -ms-autohiding-scrollbar;
    }

    .table {
      width: 100%;
      max-width: 100%;
      margin-bottom: 1rem;
      background-color: transparent;
    }

    .table tbody + tbody {
      border-top: 2px solid #dee2e6;
    }

    .table .table {
      background-color: #fff;
    }

    .table thead th {
      font-size: 12px;
      border-bottom: 2px solid #dee2e6;
      border-right: 2px solid #dee2e6; 
      border-left: 2px solid #dee2e6;
    }

    .titulo-sector {
      vertical-align: middle;
      border-bottom: 2px solid #dee2e6;
      background-color: #E0EFF6;
      text-align: center;
      font-weight: bold;
      font-size: 14px; 
    }

    .encabezado-form {
      vertical-align: middle;
      border-bottom: 2px solid #dee2e6;
      background-color: #E0EFF6;
      text-align: center;
      font-weight: bold;
    }

    .encabezado-titulo-form {
      vertical-align: middle;
      border-bottom: 0px solid #dee2e6;
      background-color: #E0EFF6;
      text-align: center;
      font-weight: bold;
    }

    .encabezado2-form {
      text-align: center; 
      border-bottom: 2px solid #dee2e6;
      vertical-align: middle; 
      background-color: #E0EFF6;
      font-weight: bold;
    }

    .contenido-form {
      border-bottom: 2px solid #dee2e6;
      border-right: 2px solid #dee2e6; 
      border-left: 2px solid #dee2e6; 
      font-size: 12px; 
      vertical-align: top;
      background-color: #fff;
      color: #5d759e;
      //font-weight: 500;
      
    }

    .sub-contenido-form {
      font-size: 12px; 
      vertical-align: top;
      background-color: #fff;
      color: #5d759e !important;     
      text-align: center; 
    }

    
    .option-form {
      font-size: 12px; 
      vertical-align: top;
      background-color: #fff;
      color: #5d759e !important;     
      font-weight: bold;
    }

    .white-space {
      border-bottom: 2px solid #fff !important;
    }

    .td-popup {
      color: #0c5460 !important;
      font-size: 13px;
    }

    .contenido-popup-form {
      font-size: 12px; 
      vertical-align: top;
      background-color: #fff;
      color: #5d759e; 
      width: 100px;    
    }

    .sub-contenido-popup-form {
      font-size: 10px !important;
      vertical-align: middle;
      border-bottom: 2px solid #dee2e6;
      background-color: #E0EFF6;
      text-align: center;
      font-weight: bold;
      width: 100px;
      //height: 10px;
    }
= render 'modal_recuerde_guardar'
#fondoContent.tab-content.px-2.pt-0
  - tipo = @tipo
  %div{ id: "tipos", "data-tipo" => tipo }
  #sector.tab-pane.fade.disabled{"aria-expanded" => (tabs[:"sector"] ? 'true' : 'false'), "aria-labelledby" => "sector-tab", :role => "tabpanel", class: ("show active" if tabs[:"sector"])}  
    .card
      .card-body
        <h1>Caracterización Económica</h1>
        .alert.alert-primary
          %small  
            %i.fa.fa-question-circle.fa-1-5x
            Este punto permitirá contextualizar la importancia del sector productivo en la economía e identificar los aspectos más relevantes del o de los procesos productivos que pretenden abordarse con la realización del proyecto
       
        %div.table-responsive
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr
                %th.encabezado-titulo-form{colspan: 5, style: 'border-right: 0px solid #dee2e6; border-left: 2px solid #dee2e6;'}
                  Empresas del sector
              %tr
                %th{colspan: 9, style: 'text-align: right; border-right: 0px solid #dee2e6; border-left: 0px solid #dee2e6;'}
              %tr
                %th.encabezado-form{colspan: 6}Cantidad de empresas por tamaño <a href="http://www.sii.cl/estadisticas/empresas_tamano_ventas.htm" target="_blank">(clasificación SII)</a>

              %tr
                %th.encabezado2-form Micro
                %th.encabezado2-form Pequeña
                %th.encabezado2-form Mediana
                %th.encabezado2-form Grande
                %th.encabezado2-form Total
              %tr
                %th
                  = f.text_field :nombre_acuerdo, class: 'valor-a-sumar', type: 'number', id: 'micro_sector', onchange: 'sumarValores();', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'               
                %th
                  = f.text_field :nombre_acuerdo, class: 'valor-a-sumar', type: 'number', id: 'pequena_sector', onchange: 'sumarValores();', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'              
                %th
                  = f.text_field :nombre_acuerdo, class: 'valor-a-sumar', type: 'number', id: 'mediana_sector', onchange: 'sumarValores();', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                %th
                  = f.text_field :nombre_acuerdo, class: 'valor-a-sumar', type: 'number', id: 'grande_sector', onchange: 'sumarValores();', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                %th#total
          %br
        %div.table-responsive  
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @regiones.nil? || @regiones.size <= 0)}
            %thead
              %tr
                %th.encabezado-form{colspan: 6}Distribución Regional
              %tr
                %th.encabezado-form{style: 'width: 25%;'} Región
                %th.encabezado-form{style: 'width: 25%;'} 	N° de empresas del sector
              %tbody
                - @regiones.each do |region|
                  %tr
                    %td.contenido-form{style: 'vertical-align: middle;'}= region.nombre
                    %td.contenido-form 
                      = f.text_field :nombre_acuerdo, value: 0, type: 'number', id: 'numero_emp_reg', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
        
        %br
        %div.table-responsive
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr
                %th.encabezado-form{colspan: 11} Fuerza Laboral 
              %tr
                %th{colspan: 5, style: 'text-align: right; border-right: 0px solid #dee2e6; border-left: 0px solid #dee2e6;'}
              %tr
                %th.encabezado2-form{colspan: 3, style: 'width: 33,3%;'} 
                  Trabajadores permanentes promedio por empresa
                %th.white-space  
                %th.encabezado2-form{colspan: 3, style: 'width: 33,3%;'}  
                  Trabajadores temporales promedio por empresa
                %th.white-space
                %th.encabezado2-form{colspan: 3, style: 'width: 33,3%;'} 
                  Trabajadores promedio por empresa
              %tr
                %th.contenido-form Hombre
                %th.contenido-form Mujer
                %th.contenido-form Total
                %th.white-space
                %th.contenido-form Hombre
                %th.contenido-form Mujer
                %th.contenido-form Total
                %th.white-space
                %th.contenido-form Hombre
                %th.contenido-form Mujer
                %th.contenido-form Total
              %tr
                %th.contenido-form
                  = f.text_field :nombre_acuerdo, class: 'valor-permanentes', type: 'number', id: 'permanentes_hombres', onchange: 'sumarTrabajadoresPermanentes();', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                %th.contenido-form
                  = f.text_field :nombre_acuerdo, class: 'valor-permanentes', type: 'number', id: 'permanentes_mujeres', onchange: 'sumarTrabajadoresPermanentes();', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                %th#total_permanente
                %th.white-space
                %th.contenido-form
                  = f.text_field :nombre_acuerdo, class: 'valor-temporales', type: 'number', id: 'temporales_hombres', onchange: 'sumarTrabajadoresTemporales();', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                %th.contenido-form
                  = f.text_field :nombre_acuerdo, class: 'valor-temporales', type: 'number', id: 'temporales_mujeres', onchange: 'sumarTrabajadoresTemporales();', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                %th.contenido-form#total_temporales
                %th.white-space
                %th.contenido-form#total_hombres
                %th.contenido-form#total_mujeres
                %th.contenido-form#total_trabajadores
        %br
        %div.table-responsive
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr
                %th.encabezado-form{colspan: 6} Factores y variables de Producción (Certificación Ambiental)
              %tr
                %th.contenido-form
                  = f.input :nombre_acuerdo, as: :text, input_html: { }, label: false, required: true
        %br
        <h1>Caracterización Ambiental y Social</h1>
        .alert.alert-primary
          %small  
            %i.fa.fa-question-circle.fa-1-5x
            En este punto se deberán evidenciar externalidades ambientales y sociales que presenta el sector y que contextualizan la necesidad de desarrollar un APL
        %div.table-responsive       
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead  
              
              %tr
                %th.encabezado-form{colspan: 6} Identificación de Consumos
              %tr
                %th.contenido-form
                  = f.input :nombre_acuerdo, as: :text, input_html: { }, label: false, required: true
                              
                          
  #propuesta-tecnica.tab-pane.fade.disabled{"aria-expanded" => (tabs[:"propuesta-tecnica"] ? 'true' : 'false'), "aria-labelledby" => "propuesta-tecnica-tab", :role => "tabpanel", class: ("show active" if tabs[:"propuesta-tecnica"])}
    .card
      .card-body
        <h1>Objetivos del proyecto</h1>
        -# =f.label t(:objetivo_general)
        %div.table-responsive
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr
                %th.encabezado-form{colspan: 6}=t(:objetivo_general)
        %br
        .alert.alert-primary
          %small  
            %i.fa.fa-question-circle.fa-1-5x
            Apoyar a sectores productivos del país a la formación de Cultura de Producción Limpia a través del desarrollo de estrategias, programas o proyectos de comunicación hacia empresas, los trabajadores ya la comunidad en general y que pongan de relieve impactos, beneficios, mejores practicas, tecnicas, avances o innovaviones fruto de la implementación de Acuendos de Producción Limpia o de la aplicación de sistemas o estrategias de gestión productivas sustentable con una visión preventiva de la contaminacion y uso eficiente de los recursos. </br></br> <a href="http://fpl.cpl.cl/ayuda/guias/documentos/guia_1.pdf" target="_blank">Descargar Guía Nº1</a>

        %br
        -
        -# - if current_user.is_admin? || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA) 
        -#  = link_to t(:agregar_, item: t(:objetivo_específico).downcase), new_objetivo_especificos_path(id: @tarea_pendiente.id), class: 'btn btn-sm btn-primary margin-bottom-20 btn-sm'
        -# .card
          -#.card-header.encabezado-titulo-form
            -# %h5.no-margin
            -#  = t(:lista_de_, items: t(:objetivo_específico).downcase)
          -# .card-body
        %div.table-responsive
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr
                %th.encabezado-form{colspan: 9}=t(:objetivo_específico) 
          %br
          = button_tag 'Agregar', id: 'open-modal-button', class: 'btn btn-sm btn-primary margin-bottom-20 btn-sm', type: 'button'
        %div.table-responsive  
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr
                %th.encabezado2-form=t(:descripcion)
                %th.encabezado2-form.center=t(:metodologia)
                %th.encabezado2-form=t(:resultado)
                %th.encabezado2-form=t(:indicadores)
                -# if @acceso == :admin || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA)
                %th.encabezado2-form.dos.iconos-acciones=t(:acción)
            %tbody
              - @objetivos.each do |objetivo|
                %tr
                  %td.contenido-form=objetivo.descripcion
                  %td.contenido-form=objetivo.metodologia
                  %td.contenido-form=objetivo.resultado
                  %td.contenido-form=objetivo.indicadores
                  -# if @acceso == :admin || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA)
                  %td.contenido-form.dos.iconos-acciones
                    = link_to '#', title: "Editar los objetivos específicos", class: 'editar-objetivo', data: { objetivo_id: objetivo.id } do
                      %i.fa.fa-edit
                    -if @acceso == :admin || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA)
                      = link_to destroy_objetivo_especificos_path(objetivo), method: :delete, data: { confirm: t(:está_seguro_que_desea_borrar?, item: t(:objetivo_específico)), remote: false }, title: "Eliminar el objetivo específico" do
                        %i.fa.fa-trash
        %br
        <h1>Empresas que serán consideradas para la realizacion del diagnóstico sectorial</h1>
        -# .alert.alert-primary
        -#   %small
        -#     %i.fa.fa-question-circle.fa-1-5x
        -#     Ubicación geográfica de las empresas
        %div.table-responsive
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr
                %th.encabezado-form{colspan: 6}Cantidad y tamaño de las empresas consideradas para la realización del diagnóstico sectorial. <a href="http://www.sii.cl/estadisticas/empresas_tamano_ventas.htm" target="_blank">clasificación SII</a>

              %tr
                %th.encabezado2-form Micro
                %th.encabezado2-form Pequeña
                %th.encabezado2-form Mediana
                %th.encabezado2-form Grande
                %th.encabezado2-form Total
              %tr
                %th
                  = f.text_field :nombre_acuerdo, class: 'valor-a-sumar-tec', type: 'number', onchange: 'sumarValoresTec();', id: 'micro_tecnica', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                %th
                  = f.text_field :nombre_acuerdo, class: 'valor-a-sumar-tec', type: 'number', onchange: 'sumarValoresTec();', id: 'pequena_tecnica', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'              
                %th
                  = f.text_field :nombre_acuerdo, class: 'valor-a-sumar-tec', type: 'number', onchange: 'sumarValoresTec();', id: 'mediana_tecnica', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                %th
                  = f.text_field :nombre_acuerdo, class: 'valor-a-sumar-tec', type: 'number', onchange: 'sumarValoresTec();', id: 'grande_tecnica', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                %th#total_tecnica 
        %br   
        .row
          .col-12
            -if solo_lectura
              %label.control-label.string=@validaciones[:manifestacion_de_interes][:comunas_ids][:nombre]
              #manifestacion_de_interes_comunas_ids
            #checkbox-tree-selector-regiones-provincias-comunas.mb-3
              -card_class = ''
              -card_class += ' border-0' if solo_lectura
              -card_class += ' has-error' if f.object.errors.messages.has_key?(:comunas_ids)
              .card.m-0.card-preview-seleccionados{class: card_class}
                -if !solo_lectura
                  #manifestacion_de_interes_comunas_ids.card-header.pt-2.pb-1.pl-3.titulo-sector 
                    %h5.no-margin.float-left.display_select_title
                      %abbr{title: :required} *
                      =@validaciones[:manifestacion_de_interes][:comunas_ids][:nombre]
                    .float-right
                      %i.fa.fa-chevron-right#boton_expandir_territorios
                .card-body.py-0.required{class: (solo_lectura ? 'px-0' : 'group-hide')}
                  .row
                    .col-lg-4.pr-lg-0.p-0.beauty-tree-content{class: (solo_lectura ? 'd-none' : 'col-lg-4 col-12')}
                      =beauty_tree_selector(f.object.comunas_beauty_tree_selector ,"manifestacion_de_interes[comunas_ids][]", "comunas")
                    .col-12{class: (solo_lectura ? '' : 'col-lg-8 pl-lg-0')}
                      = f.input :proponente, as: :hidden, wrapper: false, input_html: {class: ""}
                      #representacion-seleccion-territorio-mapa{style: (solo_lectura ? 'height: 400px;' : '')}
                  - if f.object.errors.messages.has_key?(:comunas_ids)
                    %span.help-block
                      = f.object.errors.messages[:comunas_ids].first
                -if !solo_lectura
                  .card-footer.p-0
                    %ul.list-group.seleccionados_tree.m-0
                -else
                  .card-footer.px-0.pb-0.pt-1.border-0
                    %ul.list-group.seleccionados_tree_solo_lectura.m-0
          -#
            .col-lg-6.pr-lg-0.col-12
              -#
                #textarea-caracterizacion-sector-territorio.mb-3
                  .card.m-0
                    .card-header.pt-2.pb-1.pl-3
                      %h5.no-margin.float-left
                        %abbr{title: :required} *
                        = t(:caracterización_sector_territorio)
                      .float-right
                        %i.fa.fa-chevron-right
                    .card-body.p-0.group-hide
              = f.input :caracterizacion_sector_territorio, as: :text, input_html: { class: 'card-wrap' }, label: t(:caracterización_sector_territorio), wrapper_class: 'm-0', required: true
          -#
            .col-lg-6.col-12
              -#
                #textarea-principales_actores.mb-3
                  .card.m-0
                    .card-header.pt-2.pb-1.pl-3
                      %h5.no-margin.float-left
                        %abbr{title: :required} *
                        = t(:principales_actores)
                      .float-right
                        %i.fa.fa-chevron-right
                    .card-body.p-0.group-hide
              = f.input :principales_actores, as: :text, input_html: { class: 'card-wrap' }, label: t(:principales_actores), wrapper_class: 'm-0', required: true
        %div.table-responsive
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr
                %th.encabezado2-form 
                  Empresas socias de la A.G. potenciales suscriptoras del APL
                %th.encabezado2-form 
                  Empresas potenciales no socias de la A.G.       
              %tr
                %th
                  = f.text_field :nombre_acuerdo, class: 'valor-a-sumar-', required: true, label: 'Empresas socias de la A.G. potenciales suscriptoras del APL*', type: 'number', onchange: 'sumarValoresTec();', id: 'micro_tecnica', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                %th
                  = f.text_field :nombre_acuerdo, class: 'valor-a-sumar-', required: true, label: 'Empresas potenciales no socias de la A.G.*', type: 'number', onchange: 'sumarValoresTec();', id: 'micro_tecnica', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
        %br
        <h1>Duración del proyecto</h1>
        %div.table-responsive{style: 'border-bottom: 0px solid #dee2e6;'} 
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr
                %th
                  = f.input :sub_linea_id, required: true, label: t(:duracion_proyecto), collection: (1..4).map { |num| [num, num] }, input_html: { class: 'required-field', onchange: 'duracion()', id: 'duracion_proyecto'}
              -# %tr{style: 'visibility: hidden;', id: 'titulo_justificacion'}
              -#   %th
              -#    = f.input :nombre_acuerdo, as: :text, required: true, label: t(:justificacion_duracion), input_html: { class: 'required-field-text', id: 'justificacion_duracion', style: 'visibility: hidden;'}
        %br
       
  #equipo-trabajo.tab-pane.fade.disabled{"aria-expanded" => (tabs[:"equipo-trabajo"] ? 'true' : 'false'), "aria-labelledby" => "equipo-trabajo-tab", :role => "tabpanel", class: ("show active" if tabs[:"equipo-trabajo"])}
    .card
      .card-body
        %br
        <input type="hidden" id="Tipo_0_Option" name="Tipo_0_Option" value="0">
        <input type="hidden" id="Tipo_1_Option" name="Tipo_1_Option" value="1">
        - if current_user.is_admin? || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA) 
          -# = link_to 'Agregar', new_objetivo_especificos_path(id: @tarea_pendiente.id), class: 'btn btn-sm btn-primary margin-bottom-20 btn-sm'
        -# <h1>Equipo de Institución Receptora del Cofinanciamiento</h1>
        <h1>A) Equipo de Trabajo del Postulante</h1>
        %br
        %div#div_postulante.table-responsive  
          = button_tag 'Agregar Postulante', id: 'open-modal-button_buscar_usuario_postulante', class: 'btn btn-sm btn-primary margin-bottom-20 btn-sm', type: 'button' 
          %br
            %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
              %thead
                %tr
                  %th.encabezado2-form=t(:nombre_completo_persona)
                  %th.encabezado2-form.center=t(:rut)
                  %th.encabezado2-form=t(:telefono)
                  %th.encabezado2-form=t(:email)
                  %th.encabezado2-form=t(:profesion)
                  %th.encabezado2-form=t(:funciones_proyecto)
                  %th.encabezado2-form=t(:valor_hh)
                  %th.encabezado2-form=t(:copia_ci)
                  %th.encabezado2-form=t(:curriculum_vitae)
                  -# if @acceso == :admin || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA)
                  %th.encabezado2-form.dos.iconos-acciones=t(:acción)
              %tbody
                - @postulantes.each do |postulante|
                  %tr
                    %td.contenido-form= postulante.nombre_completo
                    %td.contenido-form= postulante.rut
                    %td.contenido-form= postulante.telefono
                    %td.contenido-form= postulante.email
                    %td.contenido-form= postulante.profesion
                    %td.contenido-form= postulante.funciones_proyecto
                    %td.contenido-form= postulante.valor_hh
                    %td.contenido-form= postulante.copia_ci
                    %td.contenido-form= postulante.curriculum
                    -# if @acceso == :admin || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA)
                    %td.contenido-form.dos.iconos-acciones
                      -if @acceso == :admin || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA)
                        -#= link_to eliminar_equipo_postula_fondo_produccion_limpia_path(user_id: postulante.id), data: { confirm: t(:está_seguro_que_desea_borrar?, item: t(:responsable)), remote: false }, title: "Eliminar al consultor" do
                        = link_to eliminar_equipo_postulante_fondo_produccion_limpia_path(user_id: postulante.id), remote: true, method: :delete, data: { user_id: postulante.id, confirm: t(:está_seguro_que_desea_borrar?, item: t(:responsable)) }, title: "Eliminar al consultor", class: 'eliminar-user-consultora', id: "eliminar-postulante-#{postulante.id}" do
                          %i.fa.fa-trash 
        </br>
        <h1>B) Equipo de Trabajo de la Consultora</h1>
        - if current_user.is_admin? || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA) 
          -# = link_to 'Agregar', new_admin_user_path, class: 'btn btn-sm btn-primary margin-bottom-20 btn-sm' 
        -# %div.table-responsive
        -#  %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
        -#    %thead
        -#      %tr
        -#        %th.encabezado-form{colspan: 9}=t(:equipo_trabajo_consultores) 
        -# %br
          -# = link_to 'Agregar', new_objetivo_especificos_path(id: @tarea_pendiente.id), class: 'btn btn-sm btn-primary margin-bottom-20 btn-sm'
        %br
        .alert.alert-primary
          %small  
            %i.fa.fa-question-circle.fa-1-5x
            En este punto se debe indicar si se contratarán los servicios de una empresa consultora o de un equipo de consultor(es), para realizar una parte o todo el proyecto.
        %div.table-responsive       
          %table 
            -#-if @count_user_empresa == 0 && @count_user_equipo == 0
            -if @tipo == 0
              %tr
                %td= f.radio_button :nombre_acuerdo, 'opcion_1', { checked: true, class: 'required-field', id: 'opcion_1', onclick: "optionSelect(document.getElementById('Tipo_0_Option').value);" }
                %td.option-form Empresa Consultora
              %tr
                %td= f.radio_button :nombre_acuerdo, 'opcion_2', { class: 'required-field', id: 'opcion_2', onclick: 'optionSelect(2);'  }
                %td.option-form Equipo de Consultores

            -#-if @count_user_empresa > 0
            -if @tipo == 2
              %tr
                %td= f.radio_button :nombre_acuerdo, 'opcion_1', { checked: true, class: 'required-field', id: 'opcion_1', onclick: "optionSelect(document.getElementById('Tipo_1_Option').value);" }
                %td.option-form Empresa Consultora
              %tr
                %td= f.radio_button :nombre_acuerdo, 'opcion_2', { class: 'required-field', id: 'opcion_2', onclick: 'optionSelect(2);', disabled: 'disabled'  }
                %td.option-form Equipo de Consultores
            
            -#-if @count_user_equipo > 0
            -if @tipo == 1
              %tr
                %td= f.radio_button :nombre_acuerdo, 'opcion_1', { class: 'required-field', id: 'opcion_1', onclick: "optionSelect(document.getElementById('Tipo_1_Option').value);", disabled: 'disabled' }
                %td.option-form Empresa Consultora
              %tr
                %td= f.radio_button :nombre_acuerdo, 'opcion_2', { checked: true, class: 'required-field', id: 'opcion_2', onclick: 'optionSelect(2);'  }
                %td.option-form Equipo de Consultores
        %br   
        %div#div_empresa_consultora.table-responsive  
          -#- if @count_empresa_equipo.present? && @count_empresa_equipo == 0
          = button_tag 'Agregar Empresa', id: 'open-modal-button_buscar_contribuyente', class: 'btn btn-sm btn-primary margin-bottom-20 btn-sm', type: 'button' 
          %br
            %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
              %thead
                %tr
                  %th.encabezado2-form=t(:razon_social)
                  %th.encabezado2-form.center=t(:rut)
                  -# if @acceso == :admin || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA)
                  %th.encabezado2-form.dos.iconos-acciones=t(:acción)
              %tbody
                - @empresa_equipo.each do |empresa|
                  %tr
                    %td.contenido-form=empresa.razon_social
                    %td.contenido-form=empresa.rut
                    -# if @acceso == :admin || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA)
                    %td.contenido-form.dos.iconos-acciones
                      -#= link_to edit_admin_user_path(empresa), title: "Editar los datos del usuario" do
                      -#  %i.fa.fa-edit
                      -if @acceso == :admin || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA)
                        -#= link_to admin_user_path(empresa), method: :delete, data: { confirm: t(:está_seguro_que_desea_borrar?, item: t(:responsable)), remote: false }, title: "Eliminar al usuario" do
                        -#= link_to eliminar_empresa_fondo_produccion_limpia_path(contribuyente_id: empresa.id), data: {confirm: t(:está_seguro_que_desea_borrar?, item: t(:contribuyente)), remote: false }, title: "Eliminar Contribuyente" do
                        = link_to eliminar_empresa_fondo_produccion_limpia_path(contribuyente_id: empresa.id), remote: true, method: :delete, data: { contribuyente_id: empresa.id, confirm: t(:está_seguro_que_desea_borrar?, item: t(:contribuyente)) }, title: "Eliminar Contribuyente", class: 'eliminar-empresa', id: "eliminar-empresa-#{empresa.id}" do
                          %i.fa.fa-trash 
        -#- if @count_empresa_equipo.present? && @count_empresa_equipo > 0
        %div#div_equipo_consultora_empresa.table-responsive{ style: 'display: none;' }
          = button_tag 'Agregar Consultor', id: 'open-modal-button_buscar_usuario_consultora', class: 'btn btn-sm btn-primary margin-bottom-20 btn-sm', type: 'button' 
          %br
            %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
              %thead
                %tr
                  %th.encabezado2-form=t(:nombre_completo_persona)
                  %th.encabezado2-form.center=t(:rut)
                  %th.encabezado2-form=t(:telefono)
                  %th.encabezado2-form=t(:email)
                  %th.encabezado2-form=t(:profesion)
                  %th.encabezado2-form=t(:funciones_proyecto)
                  %th.encabezado2-form=t(:valor_hh)
                  %th.encabezado2-form=t(:copia_ci)
                  %th.encabezado2-form=t(:curriculum_vitae)
                  -# if @acceso == :admin || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA)
                  %th.encabezado2-form.dos.iconos-acciones=t(:acción)
              %tbody
                - @user_equipo.each do |user|
                  %tr
                    %td.contenido-form= user.nombre_completo
                    %td.contenido-form= user.rut
                    %td.contenido-form= user.telefono
                    %td.contenido-form= user.email
                    %td.contenido-form= user.profesion
                    %td.contenido-form= user.funciones_proyecto
                    %td.contenido-form= user.valor_hh
                    %td.contenido-form= user.copia_ci
                    %td.contenido-form= user.curriculum
                    -# if @acceso == :admin || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA)
                    %td.contenido-form.dos.iconos-acciones
                      -if @acceso == :admin || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA)
                        -#= link_to eliminar_equipo_fondo_produccion_limpia_path(user_id: user.id), data: { user_id: user.id, confirm: t(:está_seguro_que_desea_borrar?, item: t(:responsable)), remote: false }, title: "Eliminar al consultor" do
                        = link_to eliminar_consultor_empresa_fondo_produccion_limpia_path(user_id: user.id), remote: true, method: :delete, data: { user_id: user.id, confirm: t(:está_seguro_que_desea_borrar?, item: t(:responsable)) }, title: "Eliminar al consultor", class: 'eliminar-user-consultora_empresa', id: "eliminar-usuario_empresa-#{user.id}" do
                          %i.fa.fa-trash 
        </br>
        %div#div_equipo_consultora.table-responsive{ style: 'display: none;' }
          = button_tag 'Agregar Consultor', id: 'open-modal-button_buscar_usuario', class: 'btn btn-sm btn-primary margin-bottom-20 btn-sm', type: 'button' 
          %br
            %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
              %thead
                %tr
                  %th.encabezado2-form=t(:nombre_completo_persona)
                  %th.encabezado2-form.center=t(:rut)
                  %th.encabezado2-form=t(:telefono)
                  %th.encabezado2-form=t(:email)
                  %th.encabezado2-form=t(:profesion)
                  %th.encabezado2-form=t(:funciones_proyecto)
                  %th.encabezado2-form=t(:valor_hh)
                  %th.encabezado2-form=t(:copia_ci)
                  %th.encabezado2-form=t(:curriculum_vitae)
                  -# if @acceso == :admin || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA)
                  %th.encabezado2-form.dos.iconos-acciones=t(:acción)
              %tbody
                - @user_equipo.each do |user|
                  %tr
                    %td.contenido-form= user.nombre_completo
                    %td.contenido-form= user.rut
                    %td.contenido-form= user.telefono
                    %td.contenido-form= user.email
                    %td.contenido-form= user.profesion
                    %td.contenido-form= user.funciones_proyecto
                    %td.contenido-form= user.valor_hh
                    %td.contenido-form= user.copia_ci
                    %td.contenido-form= user.curriculum
                    -# if @acceso == :admin || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA)
                    %td.contenido-form.dos.iconos-acciones
                      -if @acceso == :admin || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA)
                        -#= link_to eliminar_equipo_fondo_produccion_limpia_path(user_id: user.id), remote: true, method: :delete, data: { confirm: t(:está_seguro_que_desea_borrar?, item: t(:responsable)) }, title: "Eliminar al consultor", class: 'eliminar-user-consultora', id: "eliminar-usuario-#{user.id}" do
                        = link_to eliminar_equipo_fondo_produccion_limpia_path(user_id: user.id), remote: true, method: :delete, data: { user_id: user.id, confirm: t(:está_seguro_que_desea_borrar?, item: t(:responsable)) }, title: "Eliminar al consultor", class: 'eliminar-user-consultora', id: "eliminar-usuario-#{user.id}" do
                          %i.fa.fa-trash 
        </br>
        %div.table-responsive       
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead  
              %tr
                %th.encabezado-form{colspan: 6} Indicar fortalezas del o los consultores
              %tr
                %th
                  = f.input :nombre_acuerdo, as: :text, input_html: { }, label: @validaciones[:manifestacion_de_interes][:nombre_acuerdo][:nombre], required: true                        
  #plan-de-actividades.tab-pane.fade.disabled{"aria-expanded" => (tabs[:"plan-de-actividades"] ? 'true' : 'false'), "aria-labelledby" => "plan-de-actividades-tab", :role => "tabpanel", class: ("show active" if tabs[:"plan-de-actividades"])}
    .card
      .card-header
      .card-body
        <h1>Plan de Actividades</h1>
        .alert.alert-primary
          %small  
            %i.fa.fa-question-circle.fa-1-5x
            El plan ofrece un enfoque estructurado y detallado para planificar y gestionar las diversas etapas y actividades de un proyecto, incluyendo la asignación de costos. Además, la capacidad de editar, eliminar y agregar actividades proporciona flexibilidad en la adaptación del plan a las necesidades cambiantes del proyecto.
        %div.table-responsive
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr
                -#%th.encabezado-form{style: 'text-align: center; vertical-align: middle;', rowspan: 2}=t(:n°)
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle;', rowspan: 2}=t(:etapa_actividades)
                %th.encabezado-form{colspan: @duracion, style: 'text-align: center; border-right: 1px solid #dee2e6;'}=t(:duracion)
                %th.encabezado-form{colspan: 4, style: 'text-align: center; border-right: 1px solid #dee2e6;'}=t(:costos)
                -# if @acceso == :admin || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA)
                %th.encabezado-form.dos.iconos-acciones{style: 'vertical-align: middle;', rowspan: 2}=t(:acción)
              %tr
                - if @duracion == 1
                  %th.encabezado-form="1"
                - elsif @duracion == 2
                  %th.encabezado-form="1"
                  %th.encabezado-form="2"
                - elsif @duracion == 3
                  %th.encabezado-form="1"
                  %th.encabezado-form="2"
                  %th.encabezado-form="3"
                - elsif @duracion == 4
                  %th.encabezado-form="1"
                  %th.encabezado-form="2"
                  %th.encabezado-form="3"
                  %th.encabezado-form="4"
                - elsif @duracion == 5
                  %th.encabezado-form="1"
                  %th.encabezado-form="2"
                  %th.encabezado-form="3"
                  %th.encabezado-form="4"
                  %th.encabezado-form="5"
                - elsif @duracion == 6
                  %th.encabezado-form="1"
                  %th.encabezado-form="2"
                  %th.encabezado-form="3"
                  %th.encabezado-form="4"
                  %th.encabezado-form="5"
                  %th.encabezado-form="6"
                %th.encabezado-form="Recursos Humanos Propios"
                %th.encabezado-form="Recursos Humanos Externos"
                %th.encabezado-form="Gastos de Operación"
                %th.encabezado-form="Gastos de Administración"
              %tbody
                -#%tr{style: 'background-color: #E0EFF6;'}
                -#  %td{colspan: 5+@duracion, style: 'color: #5d759e; font-weight: bold;'}
                -#    %span ETAPA 1.Coordinación y Difusión Inicial
                -#  %td{colspan: 2, style: 'text-align: right;'}
                -#    %a{href: "#-1", onclick: 'crearPlanActividades(1); return false;', style: 'color: #5d759e;'}
                -#      Agregar actividad etapa 1
                -#      %img{src: "/assets/agregar.gif", border: "0"}
              - @actividad_x_linea.each do |actividad|
                %tr
                  %td.contenido-form=actividad.nombre
                  -#%td.contenido-form
                  - if @duracion == 1
                    %td.contenido-form#duracion
                  - elsif @duracion == 2
                    %td.contenido-form#duracion
                    %td.contenido-form=""
                  - elsif @duracion == 3
                    %td.contenido-form#duracion
                    %td.contenido-form=""
                    %td.contenido-form=""
                  - elsif @duracion == 4
                    %td.contenido-form#duracion
                    %td.contenido-form=""
                    %td.contenido-form=""
                    %td.contenido-form=""
                  - elsif @duracion == 5
                    %td.contenido-form#duracion
                    %td.contenido-form=""
                    %td.contenido-form=""
                    %td.contenido-form=""
                    %td.contenido-form=""
                  - elsif @duracion == 6
                    %td.contenido-form#duracion
                    %td.contenido-form=""
                    %td.contenido-form=""
                    %td.contenido-form=""
                    %td.contenido-form=""
                    %td.contenido-form=""
                  %td.contenido-form
                  %td.contenido-form
                  %td.contenido-form
                  %td.contenido-form
                  -# if @acceso == :admin || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA)
                  %td.contenido-form.dos.iconos-acciones
                    = link_to "#", title: "Editar", onclick: "crearPlanActividades(#{actividad.id})" do
                      %i.fa.fa-edit
                    -if @acceso == :admin || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA)
                      -# = link_to admin_user_path(actividad), method: :delete, data: { confirm: t(:está_seguro_que_desea_borrar?, item: t(:responsable)), remote: false }, title: "Eliminar al usuario" do
                        %i.fa.fa-trash  

              -#%tr{style: 'background-color: #E0EFF6;'}
              -#  %td{colspan: 5+@duracion, style: 'color: #5d759e; font-weight: bold;'}
              -#    %span ETAPA 2.Recopilación de Información Primaria y Secundaria
              -#  %td{colspan: 2, style: 'text-align: right;'}
              -#    %a{href: "#-1", onclick: "ventana_campo_13('fila=-1&amp;etapa=2')", style: 'color: #5d759e;'}
              -#      Agregar actividad etapa 2
              -#      %img{src: "/assets/agregar.gif", border: "0"}
              -#- @objetivos.each do |objetivo|
              -#  %tr
              -#    %td.contenido-form=objetivo.descripcion
              -#    %td.contenido-form=objetivo.metodologia
              -#    - if @duracion == 1
              -#      %td.contenido-form#duracion
              -#    - elsif @duracion == 2
              -#      %td.contenido-form#duracion
              -#      %td.contenido-form=""
              -#    - elsif @duracion == 3
              -#      %td.contenido-form#duracion
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#    - elsif @duracion == 4
              -#      %td.contenido-form#duracion
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#    - elsif @duracion == 5
              -#      %td.contenido-form#duracion
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#    - elsif @duracion == 6
              -#      %td.contenido-form#duracion
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#    %td.contenido-form=objetivo.resultado
              -#    %td.contenido-form=objetivo.indicadores
              -#    %td.contenido-form=objetivo.indicadores
              -#    %td.contenido-form=objetivo.indicadores
              -#    -# if @acceso == :admin || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA)
              -#    %td.contenido-form.dos.iconos-acciones
              -#      = link_to edit_admin_user_path(objetivo), title: "Editar los datos del usuario" do
              -#        %i.fa.fa-edit
              -#      -if @acceso == :admin || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA)
              -#        = link_to admin_user_path(objetivo), method: :delete, data: { confirm: t(:está_seguro_que_desea_borrar?, item: t(:responsable)), remote: false }, title: "Eliminar al usuario" do
              -#          %i.fa.fa-trash  

              -#%tr{style: 'background-color: #E0EFF6;'}
              -#  %td{colspan: 5+@duracion, style: 'color: #5d759e; font-weight: bold;'}
              -#    %span ETAPA 3.Análisis de Información y Desarrollo del Diagnóstico Preliminar
              -#  %td{colspan: 2, style: 'text-align: right;'}
              -#    %a{href: "#-1", onclick: "ventana_campo_13('fila=-1&amp;etapa=3')", style: 'color: #5d759e;'}
              -#      Agregar actividad etapa 3
              -#      %img{src: "/assets/agregar.gif", border: "0"}
              -#- @objetivos.each do |objetivo|
              -#  %tr
              -#    %td.contenido-form=objetivo.descripcion
              -#    %td.contenido-form=objetivo.metodologia
              -#    - if @duracion == 1
              -#      %td.contenido-form#duracion
              -#    - elsif @duracion == 2
              -#      %td.contenido-form#duracion
              -#      %td.contenido-form=""
              -#    - elsif @duracion == 3
              -#      %td.contenido-form#duracion
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#    - elsif @duracion == 4
              -#      %td.contenido-form#duracion
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#    - elsif @duracion == 5
              -#      %td.contenido-form#duracion
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#    - elsif @duracion == 6
              -#      %td.contenido-form#duracion
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#    %td.contenido-form=objetivo.resultado
              -#    %td.contenido-form=objetivo.indicadores
              -#    %td.contenido-form=objetivo.indicadores
              -#    %td.contenido-form=objetivo.indicadores
              -#    -# if @acceso == :admin || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA)
              -#    %td.contenido-form.dos.iconos-acciones
              -#      = link_to edit_admin_user_path(objetivo), title: "Editar los datos del usuario" do
              -#       %i.fa.fa-edit
              -#      -if @acceso == :admin || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA)
              -#        = link_to admin_user_path(objetivo), method: :delete, data: { confirm: t(:está_seguro_que_desea_borrar?, item: t(:responsable)), remote: false }, title: "Eliminar al usuario" do
              -#          %i.fa.fa-trash  
  
              -#%tr{style: 'background-color: #E0EFF6;'}
              -#  %td{colspan: 5+@duracion, style: 'color: #5d759e; font-weight: bold;'}
              -#    %span ETAPA 4.Difusión del Diagnóstico Preliminar y Entrega Diagnóstico Final
              -#  %td{colspan: 2, style: 'text-align: right;'}
              -#    %a{href: "#-1", onclick: "ventana_campo_13('fila=-1&amp;etapa=4')", style: 'color: #5d759e;'}
              -#      Agregar actividad etapa 4
              -#      %img{src: "/assets/agregar.gif", border: "0"}
              -#- @objetivos.each do |objetivo|
              -#  %tr
              -#    %td.contenido-form=objetivo.descripcion
              -#    %td.contenido-form=objetivo.metodologia
              -#    - if @duracion == 1
              -#      %td.contenido-form#duracion
              -#    - elsif @duracion == 2
              -#      %td.contenido-form#duracion
              -#      %td.contenido-form=""
              -#    - elsif @duracion == 3
              -#      %td.contenido-form#duracion
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#    - elsif @duracion == 4
              -#      %td.contenido-form#duracion
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#    - elsif @duracion == 5
              -#      %td.contenido-form#duracion
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#    - elsif @duracion == 6
              -#      %td.contenido-form#duracion
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#    %td.contenido-form=objetivo.resultado
              -#    %td.contenido-form=objetivo.indicadores
              -#    %td.contenido-form=objetivo.indicadores
              -#    %td.contenido-form=objetivo.indicadores
              -#    -# if @acceso == :admin || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA)
              -#    %td.contenido-form.dos.iconos-acciones
              -#      = link_to edit_admin_user_path(objetivo), title: "Editar los datos del usuario" do
              -#        %i.fa.fa-edit
              -#      -if @acceso == :admin || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA)
              -#        = link_to admin_user_path(objetivo), method: :delete, data: { confirm: t(:está_seguro_que_desea_borrar?, item: t(:responsable)), remote: false }, title: "Eliminar al usuario" do
              -#          %i.fa.fa-trash 

              -#%tr{style: 'background-color: #E0EFF6;'}
              -#  %td{colspan: 5+@duracion, style: 'color: #5d759e; font-weight: bold;'}
              -#    %span ETAPA 5.Desarrollo, Socialización y Entrega de la Propuesta de APL
              -#  %td{colspan: 2, style: 'text-align: right;'}
              -#    %a{href: "#-1", onclick: "ventana_campo_13('fila=-1&amp;etapa=5')", style: 'color: #5d759e;'}
              -#      Agregar actividad etapa 5
              -#      %img{src: "/assets/agregar.gif", border: "0"}
              -#- @objetivos.each do |objetivo|
              -#  %tr
              -#    %td.contenido-form=objetivo.descripcion
              -#    %td.contenido-form=objetivo.metodologia
              -#    - if @duracion == 1
              -#      %td.contenido-form#duracion
              -#    - elsif @duracion == 2
              -#      %td.contenido-form#duracion
              -#      %td.contenido-form=""
              -#    - elsif @duracion == 3
              -#      %td.contenido-form#duracion
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#    - elsif @duracion == 4
              -#      %td.contenido-form#duracion
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#    - elsif @duracion == 5
              -#      %td.contenido-form#duracion
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#    - elsif @duracion == 6
              -#      %td.contenido-form#duracion
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#      %td.contenido-form=""
              -#    %td.contenido-form=objetivo.resultado
              -#    %td.contenido-form=objetivo.indicadores
              -#    %td.contenido-form=objetivo.indicadores
              -#    %td.contenido-form=objetivo.indicadores
              -#    -# if @acceso == :admin || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA)
              -#    %td.contenido-form.dos.iconos-acciones
              -#      = link_to edit_admin_user_path(objetivo), title: "Editar los datos del usuario" do
              -#        %i.fa.fa-edit
              -#      -if @acceso == :admin || current_user.posee_rol_ascc?(Rol::JEFE_DE_LINEA)
              -#        = link_to admin_user_path(objetivo), method: :delete, data: { confirm: t(:está_seguro_que_desea_borrar?, item: t(:responsable)), remote: false }, title: "Eliminar al usuario" do
              -#          %i.fa.fa-trash 
  #documentacion-legal.tab-pane.fade.disabled{"aria-expanded" => (tabs[:"documentacion-legal"] ? 'true' : 'false'), "aria-labelledby" => "documentacion-legal-tab", :role => "tabpanel", class: ("show active" if tabs[:"documentacion-legal"])}
    .card
      .card-body
        <h1>Antecedentes que se deben adjuntar</h1>
        .alert.alert-primary
          %small  
            %i.fa.fa-question-circle.fa-1-5x
            Recuerde que sólo puede subir un archivo por cada fila. Puede subir archivos comprimidos con .zip o .rar           
        %div.table-responsive
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr
                %th.encabezado-form{style: 'width: 25%;'} Documento
                -# %th{style: 'width: 25%;'} Detalles
                %th.encabezado-form{style: 'width: 25%;'} Descargar Formato
                %th.encabezado-form{style: 'width: 25%;'} Subir Documento
              %tbody
                - @descargables_tarea.each do |descargable|
                  %tr
                    %td.contenido-form{style: 'vertical-align: middle;'}= descargable.nombre
                    -# %td{style: 'border-right: 1px solid #999;'}
                    %td.contenido-form{style: 'vertical-align: middle;'}= __mostrar_descargable_simple_2(@tarea, "#{descargable.codigo}", "")
                    %td.contenido-form
                      = f.input :archivo_pertinencia_factibilidad, as: :file, input_html: {class: "form-control"}, label: false
  #costos.tab-pane.fade.disabled{"aria-expanded" => (tabs[:"costos"] ? 'true' : 'false'), "aria-labelledby" => "costos-tab", :role => "tabpanel", class: ("show active" if tabs[:"costos"])}
    .card
      .card-body
        <h1>Resumen</h1>
        .alert.alert-primary
          %small  
            %i.fa.fa-question-circle.fa-1-5x
            El costo total del proyecto no es válido, porque hay criterios que no cumplen con los límites de costos.
        %div.table-responsive 
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr{style: 'background-color: #5d759e;'}
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 40%;'}=t(:estructura_costos)
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 30%;'} $
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 30%;'}=t(:porcentaje_costo)
            %tbody
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Costo total de la propuesta
                %td.contenido-form 0
                %td.contenido-form 0,00%
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Aporte Propio Valorado
                %td.contenido-form 0
                %td.contenido-form 0,00%
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Aporte Propio Líquido
                %td.contenido-form 0
                %td.contenido-form 0,00%
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Aporte Propio Total
                %td.contenido-form 0
                %td.contenido-form 0,00%
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Aporte solicitado Fondo PL
                %td.contenido-form 0
                %td.contenido-form 0,00%
          %br        
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr{style: 'background-color: #5d759e;'}
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 40%;'}=t(:estructura_costos_partida)
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 30%;'} $
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 30%;'}=t(:porcentaje_costo)
            %tbody
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Recursos Humanos Propios
                %td.contenido-form 0
                %td.contenido-form 0,00%
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Recursos Humanos Externos
                %td.contenido-form 0
                %td.contenido-form 0,00%
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Gastos de Operación
                %td.contenido-form 0
                %td.contenido-form 0,00%
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Gastos de Administración
                %td.contenido-form 0
                %td.contenido-form 0,00%
          %br        
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr{style: 'background-color: #5d759e;'}
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 40%;', rowspan: 2}=t(:aporte_beneficiario_partida)
                %th.encabezado-form{colspan: 2, style: 'text-align: center; vertical-align: middle; width: 30%;'} Aporte Valorado
                %th.encabezado-form{colspan: 2, style: 'text-align: center; vertical-align: middle;width: 30%;'} Aporte líquido
              %tr{style: 'background-color: #5d759e;'}
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 15%;'} $
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 15%;'} %
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 15%;'} $
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 15%;'} %
            %tbody
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Recursos Humanos Propios
                %td.contenido-form 0
                %td.contenido-form 0,00%
                %td.contenido-form 0
                %td.contenido-form 0,00%
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Recursos Humanos Externos
                %td.contenido-form 0
                %td.contenido-form 0,00%
                %td.contenido-form 0
                %td.contenido-form 0,00%
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Gastos de Operación
                %td.contenido-form 0
                %td.contenido-form 0,00%
                %td.contenido-form 0
                %td.contenido-form 0,00%
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Gastos de Administración
                %td.contenido-form 0
                %td.contenido-form 0,00%   
                %td.contenido-form 0
                %td.contenido-form 0,00%  
          %br        
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr{style: 'background-color: #5d759e;'}
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 40%;'}=t(:aporte_fondo_partida)
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 30%;'} $
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 30%;'}=t(:porcentaje_costo)
            %tbody
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Recursos Humanos Externos
                %td.contenido-form 0
                %td.contenido-form 0,00%
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Gastos de Operación
                %td.contenido-form 0
                %td.contenido-form 0,00%
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Gastos de Administración
                %td.contenido-form 0
                %td.contenido-form 0,00%  
        %br
        <h1>Validación</h1>   
        %div.table-responsive 
          %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
            %thead
              %tr{style: 'background-color: #5d759e;'}
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 30%;'} Glosa
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 10%;'} Monto
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 40%;'} Criterio
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle; width: 10%;'} Límite
                %th.encabezado-form{style: 'text-align: center; vertical-align: middle;  width: 10%;'} Cumple?
            %tbody
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Aporte líquido del postulante
                %td.contenido-form $0
                %td.contenido-form Mayor o igual al 9% del total del proyecto
                %td.contenido-form $0
                %td.contenido-form Si
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Aporte del postulante
                %td.contenido-form $0
                %td.contenido-form Mayor o igual al 30,00% del total del proyecto
                %td.contenido-form $0
                %td.contenido-form Si
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Gastos de Administración
                %td.contenido-form $0
                %td.contenido-form Menor o igual al 10% del total del proyecto
                %td.contenido-form $0
                %td.contenido-form Si
              %tr
                %td.contenido-form(width="33%" class="tabla_grisC") Cofinanciamiento CPL
                %td.contenido-form $0
                %td.contenido-form Menor o igual a $25.000.000
                %td.contenido-form $0
                %td.contenido-form Si
          %br      

  #modal_objetivos-form.modal.fade{tabindex: -1, role: 'dialog', 'aria-labelledby' => 'exampleModalLabel', 'aria-hidden' => 'true'}
    .modal-dialog
      .modal-content
        .modal-body
          = form_with(model: @objetivo_especifico, url: new_objetivo_especificos_path, method: :get, remote: true, html: { class: 'ajax-form' }) do |f|
            .row
              .col-12
                .card
                  .card-header
                    %h5.no-margin
                      Crear nuevo objetivo
                  .card-body
                    %div.table-responsive
                      %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}

                        = hidden_field_tag 'flujo_id', @tarea_pendiente.id, id: 'flujo_id'
                        
                        %tr
                          %td.contenido-popup-form=t(:descripcion)
                          %td.contenido-popup-form 
                            -# = @objetivo_especifico.metodologia
                            -# = f.text_field :descripcion, class: 'required-field', id: 'descripcion', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;', value: @objetivo_especifico.descripcion
                            = f.text_field :descripcion, class: 'required-field', id: 'descripcion', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:metodologia)
                          %td.contenido-popup-form
                            = f.text_field :metodologia, required: true, id: 'metodologia', class: 'required-field', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                        %tr
                          %td.contenido-popup-form=t(:resultado)
                          %td.contenido-popup-form
                            = f.text_field :resultado, required: true, id: 'resultado' , class: 'required-field', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:indicadores)
                          %td.contenido-popup-form
                            = f.text_field :indicadores, class: 'required-field numero', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;', id: 'indicadores' 
          .modal-footer
            %button.btn.btn-secondary{"data-dismiss" => "modal"} Cerrar
            = button_to 'Guardar', '#', class: 'btn btn-primary', onclick: 'guardarObjetivo(); return false;'
            
  #modal_objetivos-edit-form.modal.fade{tabindex: -1, role: 'dialog', 'aria-labelledby' => 'exampleModalLabel', 'aria-hidden' => 'true'}
    .modal-dialog
      .modal-content
        .modal-body
          = form_with(model: @objetivo_especifico, url: objetivo_especificos_path, method: :post, remote: true, html: { class: 'ajax-form' }) do |f|
            .row
              .col-12
                .card
                  .card-header
                    %h5.no-margin
                      XXX nuevo objetivo
                  .card-body
                    %div.table-responsive
                      %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}

                        = hidden_field_tag 'flujo_id', @tarea_pendiente.id, id: 'flujo_id'
                        
                        %tr
                          %td.contenido-popup-form=t(:descripcion)
                          %td.contenido-popup-form 
                            -# = @objetivo_especifico.metodologia
                            -# = f.text_field :descripcion, class: 'required-field', id: 'descripcion', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;', value: @objetivo_especifico.descripcion
                            = f.text_field :descripcion, class: 'required-field', id: 'descripcion2', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:metodologia)
                          %td.contenido-popup-form
                            = f.text_field :metodologia, required: true, id: 'metodologia', class: 'required-field', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:resultado)
                          %td.contenido-popup-form
                            = f.text_field :resultado, required: true, id: 'resultado' , class: 'required-field', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:indicadores)
                          %td.contenido-popup-form
                            = f.text_field :indicadores, class: 'required-field numero', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;', id: 'indicadores'
          .modal-footer
            %button.btn.btn-secondary{"data-dismiss" => "modal"} Cerrar
            = button_to 'Guardar', '#', class: 'btn btn-primary', onclick: 'actualizarObjetivo(); return false;'

  -# POPUP EQUIPO DE TRABAJO POSTULANTE
  #modal_postulante_create-form.modal.fade{tabindex: -1, role: 'dialog', 'aria-labelledby' => 'exampleModalLabel', 'aria-hidden' => 'true'}
    .modal-dialog
      .modal-content
        .modal-body
          = form_with(model: @objetivo_especifico, url: new_objetivo_especificos_path, method: :get, remote: true, html: { class: 'ajax-form' }) do |f|
            .row
              .col-12
                .card
                  .card-header
                    %h5.no-margin
                      Crear nuevo postulante
                  .card-body
                    %div.table-responsive
                      %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
                        = hidden_field_tag 'flujo_id', @tarea_pendiente.id, id: 'flujo_id'
                        %tr
                          %td.contenido-popup-form=t(:nombre_completo_persona)
                          %td.contenido-popup-form 
                            = f.text_field :descripcion, class: 'required-field', id: 'descripcion', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:rut)
                          %td.contenido-popup-form
                            = f.text_field :metodologia, required: true, id: 'metodologia', class: 'required-field', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                        %tr
                          %td.contenido-popup-form=t(:teléfono)
                          %td.contenido-popup-form
                            -# = f.text_field :resultado, required: true, id: 'resultado' , class: 'required-field numero', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;', maxlength: 8
                            = f.text_field :resultado, required: true, id: 'resultado', class: 'required-field numero', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:email)
                          %td.contenido-popup-form
                            = f.text_field :email, class: 'required-field', id: 'indicadores' , style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                            -#= f.input :email, required: true, label: t(:email), placeholder: "Ingresar email", input_html: { class: 'required-field' }
                        %tr
                          %td.contenido-popup-form=t(:profesion)
                          %td.contenido-popup-form 
                            = f.text_field :descripcion, class: 'required-field', id: 'descripcion', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        -# %tr
                        -#   %td.contenido-popup-form=t(:cargo)
                        -#   %td.contenido-popup-form 
                        -#     = f.text_field :descripcion, class: 'required-field', id: 'descripcion', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:funciones_proyecto)
                          %td.contenido-popup-form
                            = f.text_field :metodologia, required: true, id: 'metodologia', class: 'required-field', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                        %tr
                          %td.contenido-popup-form=t(:valor_hh_)
                          %td.contenido-popup-form
                            = f.text_field :resultado, required: true, id: 'resultado' , class: 'required-field numero', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:copia_cédula_identidad)
                          %td.contenido-popup-form
                            = f.file_field :indicadores, class: 'form-control', label: false, placeholder: 'Seleccione un archivo', name: 'nombre_del_campo', 'data-placeholder' => 'Seleccione un archivo', 'data-btn-text' => 'Elegir archivo'
                        %tr
                          %td.contenido-popup-form=t(:curriculum_vitae)
                          %td.contenido-popup-form
                            = f.file_field :indicadores, class: 'form-control', label: false, placeholder: 'Seleccione un archivo', name: 'nombre_del_campo', 'data-placeholder' => 'Seleccione un archivo', 'data-btn-text' => 'Elegir archivo'
          .modal-footer
            %button.btn.btn-secondary{"data-dismiss" => "modal"} Cerrar
            = button_to 'Guardar', '#', class: 'btn btn-primary', onclick: 'guardarObjetivo(); return false;'

  #modal_postulante_edit-form.modal.fade{tabindex: -1, role: 'dialog', 'aria-labelledby' => 'exampleModalLabel', 'aria-hidden' => 'true'}
    .modal-dialog
      .modal-content
        .modal-body
          = form_with(model: @objetivo_especifico, url: new_objetivo_especificos_path, method: :get, remote: true, html: { class: 'ajax-form' }) do |f|
            .row
              .col-12
                .card
                  .card-header
                    %h5.no-margin
                      Crear nuevo postulante
                  .card-body
                    %div.table-responsive
                      %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
                        = hidden_field_tag 'flujo_id', @tarea_pendiente.id, id: 'flujo_id'
                        %tr
                          %td.contenido-popup-form=t(:nombre_completo_persona)
                          %td.contenido-popup-form 
                            = f.text_field :descripcion, class: 'required-field', id: 'descripcion', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:rut)
                          %td.contenido-popup-form
                            = f.text_field :metodologia, required: true, id: 'metodologia', class: 'required-field', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                        %tr
                          %td.contenido-popup-form=t(:teléfono)
                          %td.contenido-popup-form
                            -# = f.text_field :resultado, required: true, id: 'resultado' , class: 'required-field numero', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;', maxlength: 8
                            = f.text_field :resultado, required: true, id: 'resultado', class: 'required-field numero', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:email)
                          %td.contenido-popup-form
                            = f.text_field :email, class: 'required-field', id: 'indicadores' , style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                            -#= f.input :email, required: true, label: t(:email), placeholder: "Ingresar email", input_html: { class: 'required-field' }
                        %tr
                          %td.contenido-popup-form=t(:profesion)
                          %td.contenido-popup-form 
                            = f.text_field :descripcion, class: 'required-field', id: 'descripcion', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        -# %tr
                        -#   %td.contenido-popup-form=t(:cargo)
                        -#   %td.contenido-popup-form 
                        -#     = f.text_field :descripcion, class: 'required-field', id: 'descripcion', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:funciones_proyecto)
                          %td.contenido-popup-form
                            = f.text_field :metodologia, required: true, id: 'metodologia', class: 'required-field', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                        %tr
                          %td.contenido-popup-form=t(:valor_hh_)
                          %td.contenido-popup-form
                            = f.text_field :resultado, required: true, id: 'resultado' , class: 'required-field numero', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:copia_cédula_identidad)
                          %td.contenido-popup-form
                            = f.file_field :indicadores, class: 'form-control', label: false, placeholder: 'Seleccione un archivo', name: 'nombre_del_campo', 'data-placeholder' => 'Seleccione un archivo', 'data-btn-text' => 'Elegir archivo'
                        %tr
                          %td.contenido-popup-form=t(:curriculum_vitae)
                          %td.contenido-popup-form
                            = f.file_field :indicadores, class: 'form-control', label: false, placeholder: 'Seleccione un archivo', name: 'nombre_del_campo', 'data-placeholder' => 'Seleccione un archivo', 'data-btn-text' => 'Elegir archivo'
          .modal-footer
            %button.btn.btn-secondary{"data-dismiss" => "modal"} Cerrar
            = button_to 'Guardar', '#', class: 'btn btn-primary', onclick: 'guardarObjetivo(); return false;'
  -# POPUP EQUIPO DE TRABAJO CONSULTORES
  #modal_consultora_create-form.modal.fade{tabindex: -1, role: 'dialog', 'aria-labelledby' => 'exampleModalLabel', 'aria-hidden' => 'true'}
    .modal-dialog
      .modal-content
        .modal-body
          = form_with(model: @objetivo_especifico, url: new_objetivo_especificos_path, method: :get, remote: true, html: { class: 'ajax-form' }) do |f|
            .row
              .col-12
                .card
                  .card-header
                    %h5.no-margin
                      Crear nuevo consultora
                  .card-body
                    %div.table-responsive
                      %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
                        = hidden_field_tag 'flujo_id', @tarea_pendiente.id, id: 'flujo_id'
                        %tr
                          %td.contenido-popup-form=t(:nombre_completo_persona)
                          %td.contenido-popup-form 
                            = f.text_field :descripcion, class: 'required-field', id: 'descripcion', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:rut)
                          %td.contenido-popup-form
                            = f.text_field :metodologia, required: true, id: 'metodologia', class: 'required-field', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                        %tr
                          %td.contenido-popup-form=t(:teléfono)
                          %td.contenido-popup-form
                            -# = f.text_field :resultado, required: true, id: 'resultado' , class: 'required-field numero', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;', maxlength: 8
                            = f.text_field :resultado, required: true, id: 'resultado', class: 'required-field numero', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:email)
                          %td.contenido-popup-form
                            = f.text_field :email, class: 'required-field', id: 'indicadores' , style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                            -#= f.input :email, required: true, label: t(:email), placeholder: "Ingresar email", input_html: { class: 'required-field' }
                        %tr
                          %td.contenido-popup-form=t(:profesion)
                          %td.contenido-popup-form 
                            = f.text_field :descripcion, class: 'required-field', id: 'descripcion', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        -# %tr
                        -#   %td.contenido-popup-form=t(:cargo)
                        -#   %td.contenido-popup-form 
                        -#     = f.text_field :descripcion, class: 'required-field', id: 'descripcion', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:funciones_proyecto)
                          %td.contenido-popup-form
                            = f.text_field :metodologia, required: true, id: 'metodologia', class: 'required-field', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;' 
                        %tr
                          %td.contenido-popup-form=t(:valor_hh_)
                          %td.contenido-popup-form
                            = f.text_field :resultado, required: true, id: 'resultado' , class: 'required-field numero', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                        %tr
                          %td.contenido-popup-form=t(:copia_cédula_identidad)
                          %td.contenido-popup-form
                            = f.file_field :indicadores, class: 'form-control', label: false, placeholder: 'Seleccione un archivo', name: 'nombre_del_campo', 'data-placeholder' => 'Seleccione un archivo', 'data-btn-text' => 'Elegir archivo'
                        %tr
                          %td.contenido-popup-form=t(:curriculum_vitae)
                          %td.contenido-popup-form
                            = f.file_field :indicadores, class: 'form-control', label: false, placeholder: 'Seleccione un archivo', name: 'nombre_del_campo', 'data-placeholder' => 'Seleccione un archivo', 'data-btn-text' => 'Elegir archivo'
          .modal-footer
            %button.btn.btn-secondary{"data-dismiss" => "modal"} Cerrar
            = button_to 'Guardar', '#', class: 'btn btn-primary', onclick: 'guardarObjetivo(); return false;'
  -# POPUP PLAN DE ACTIVIDADES
  - if @plan_actividades.present?
    #modal_create_plan_actividades-form.modal.fade{tabindex: -1, role: 'dialog', 'aria-labelledby' => 'exampleModalLabel', 'aria-hidden' => 'true'}
      .modal-dialog
        .modal-content
          .modal-body
            = form_with(model: @objetivo_especifico, url: new_objetivo_especificos_path, method: :get, remote: true, html: { class: 'ajax-form' }) do |f|
              .row
                .col-12
                  .card
                    .card-header
                      %h5.no-margin
                        Actividades
                    .card-body
                      %div.table-responsive  
                        %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
                          = hidden_field_tag 'flujo_id', @tarea_pendiente.id, id: 'flujo_id'
                          = hidden_field_tag 'plan_id', id: 'plan_id'
                          %tr
                            %td.contenido-popup-form=t(:nombre_actividades)
                            %td.contenido-popup-form 
                              = f.text_field :descripcion, value: @nombre_actividad, class: 'required-field', id: 'nombre_actividad', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                          %tr
                            %td.contenido-popup-form=t(:objetivo_específico)
                            %td.contenido-popup-form 
                              -#= f.select :descripcion, options_for_select(@objetivos_options, @plan_actividades.objetivos_especifico_id), { include_blank: 'Selecciona una opción' }, class: 'required-field', id: 'objetivos_especifico_id', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                              = f.select :objetivos_especifico_id, options_for_select(@objetivos_options, @plan_actividades.objetivos_especifico_id), { include_blank: 'Selecciona una opción' }, class: 'required-field', id: 'objetivos_especifico_id', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                              -#= f.select :objetivos_especifico_id, options_for_select(@objetivos_options, @plan_actividades.objetivos_especifico_id), { include_blank: 'Selecciona una opción' }, { selected: @plan_actividades.objetivos_especifico_id.nil? }, class: 'required-field', id: 'objetivos_especifico_id', style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                              -#= f.select :objetivos_especifico_id, options_for_select(@objetivos_options, @plan_actividades.objetivos_especifico_id), { include_blank: 'Selecciona una opción', class: 'required-field' }, { selected: @plan_actividades.objetivos_especifico_id.nil? }
                          %tr
                            %td.contenido-popup-form{colspan: @duracion}
                              %div#div_duracion.table-responsive
                                %table.table.table-striped.usuarios.no-margin
                                  %thead
                                    %tr.contenido-popup-form{colspan: @duracion}=t(:duracion)
                                    %tr.contenido-popup-form{colspan: @duracion}
                                      - if @duracion.present? && @duracion.to_i > 0
                                        - (1..@duracion.to_i).each do |mes|
                                          %td.sub-contenido-popup-form= mes
                                      - else
                                        %td.sub-contenido-popup-form{:colspan => @duracion} No checkboxes
                                  %tbody
                                    -#%tr
                                    -#  - if @duracion.present? && @duracion.to_i > 0
                                    -#    - (1..@duracion.to_i).each do |mes|
                                    -#      %td.sub-contenido-form 
                                    -#        - checkbox_id = "mes#{mes}"
                                    -#        - if @plan_actividades.duracion.present?
                                    -#          = f.check_box :descripcion, { checked: true }, class: 'required-field', id: checkbox_id, style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                                    -#        - else
                                    -#          = f.check_box :descripcion, class: 'required-field', id: checkbox_id, style: 'border: 1px solid #ced4da; border-radius: 0.25rem;'
                                    -#  - else
                                    -#    %td.sub-contenido-form No checkboxes
                          %tr
                            %td.contenido-popup-form{colspan: 4}
                              %div.table-responsive  
                              %div#div_plan_recursos_propios.table-responsive  
                                %table.table.table-striped.usuarios.no-margin
                                  %thead
                                    %tr.contenido-popup-form{colspan: 4}= t(:recursos_humanos_propios)
                                    %tr.contenido-popup-form{colspan: 4}
                                      %td.sub-contenido-popup-form Nombre
                                      %td.sub-contenido-popup-form HH
                                      %td.sub-contenido-popup-form Valor HH
                                      %td.sub-contenido-popup-form Costo
                                  %tbody
                                %table
                                  %thead
                                    %tr.contenido-popup-form{colspan: 4}
                                      %td{style: 'text-align: left; background-color: #fff;'}
                                        %a{href: "#-1", onclick: "modalRrhhPropios(document.getElementById('plan_id').value); return false;", style: 'color: #5d759e;'} Editar
                                        %img{src: "/assets/agregar.gif", border: "0"}
                          %tr
                            %td.contenido-popup-form{colspan: 4}
                              %div.table-responsive  
                              %div#div_plan_recursos_externos.table-responsive  
                                %table.table.table-striped.usuarios.no-margin
                                  %thead
                                    %tr.contenido-popup-form{colspan: 4}= t(:recursos_humanos_externos)
                                    %tr.contenido-popup-form{colspan: 4}
                                      %td.sub-contenido-popup-form Nombre
                                      %td.sub-contenido-popup-form HH
                                      %td.sub-contenido-popup-form Valor HH
                                      %td.sub-contenido-popup-form Costo
                                  %tbody
                                %table
                                  %thead
                                    %tr.contenido-popup-form{colspan: 4}
                                      %td{style: 'text-align: left; background-color: #fff;'}
                                        %a{href: "#-1", onclick: "modalRrhhExternos(document.getElementById('plan_id').value); return false;", style: 'color: #5d759e;'} Editar
                                        %img{src: "/assets/agregar.gif", border: "0"}
                          %tr 
                            %td.contenido-popup-form{colspan: 6}
                              %div.table-responsive  
                                %table.table.table-striped.usuarios.no-margin
                                  %thead
                                    %tr.contenido-popup-form{colspan: 6}=t(:gasto_operacion)
                                    %tr.contenido-popup-form{colspan: 6}
                                      %td.sub-contenido-popup-form Ítem
                                      %td.sub-contenido-popup-form Valor Unitario
                                      %td.sub-contenido-popup-form Cantidad
                                      %td.sub-contenido-popup-form Unidad
                                      %td.sub-contenido-popup-form Total
                                      %td.sub-contenido-popup-form
                                  %tbody
                                    %tr.contenido-popup-form{colspan: 6}
                                      %td{colspan: 6,style: 'text-align: right; background-color: #fff;'}
                                        %a{href: "#-1", onclick: 'crearPlanActividades(1); return false;', style: 'color: #5d759e;'} Agregar Fila
                                        %img{src: "/assets/agregar.gif", border: "0"}
                          %tr 
                            %td.contenido-popup-form{colspan: 6}
                              %div.table-responsive  
                                %table.table.table-striped.usuarios.no-margin
                                  %thead
                                    %tr.contenido-popup-form{colspan: 6}=t(:gasto_administracion)
                                    %tr.contenido-popup-form{colspan: 6}
                                      %td.sub-contenido-popup-form Ítem
                                      %td.sub-contenido-popup-form Valor Unitario
                                      %td.sub-contenido-popup-form Cantidad
                                      %td.sub-contenido-popup-form Unidad
                                      %td.sub-contenido-popup-form Total
                                      %td.sub-contenido-popup-form
                                  %tbody
                                    %tr.contenido-popup-form{colspan: 6}
                                      %td{colspan: 6, style: 'text-align: right; background-color: #fff;'}
                                        %a{href: "#-1", onclick: 'crearPlanActividades(1); return false;', style: 'color: #5d759e;'} Agregar Fila
                                        %img{src: "/assets/agregar.gif", border: "0"}
                            
            .modal-footer
              %button.btn.btn-secondary{"data-dismiss" => "modal"} Cerrar
              = button_to 'Continuar', '#', class: 'btn btn-primary', onclick: 'guardarObjetivo(); return false;'

  -# POPUP RRHH PROPIOS
  #modal_rrhh_propios-form.modal.fade{tabindex: -1, role: 'dialog', 'aria-labelledby' => 'exampleModalLabel', 'aria-hidden' => 'true'}
    .modal-dialog
      .modal-content
        .modal-body
          = form_with(model: @objetivo_especifico, url: new_objetivo_especificos_path, method: :get, remote: true, html: { class: 'ajax-form' }) do |f|
            .row
              .col-12
                .card
                  .card-header
                    %h5.no-margin
                      Recursos Humanos Propios
                  .card-body
                    %div#div_postulantes_faltantes.table-responsive  
                      %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
                        = hidden_field_tag 'flujo_id', @tarea_pendiente.id, id: 'flujo_id'
                        %thead
                          %tr
                            %td.sub-contenido-popup-form Nombre
                            %td.sub-contenido-popup-form HH en la actividad Propios
                        %tbody
          .modal-footer
            %button.btn.btn-secondary{"data-dismiss" => "modal"} Cerrar
            = button_to 'Continuar', '#', class: 'btn btn-primary', onclick: 'guardarObjetivo(); return false;'
  -# POPUP RRHH EXTERNOS
  #modal_rrhh_externos-form.modal.fade{tabindex: -1, role: 'dialog', 'aria-labelledby' => 'exampleModalLabel', 'aria-hidden' => 'true'}
    .modal-dialog
      .modal-content
        .modal-body
          = form_with(model: @objetivo_especifico, url: new_objetivo_especificos_path, method: :get, remote: true, html: { class: 'ajax-form' }) do |f|
            .row
              .col-12
                .card
                  .card-header
                    %h5.no-margin
                      Recursos Humanos Externos
                  .card-body
                    %div#div_consultor_faltantes.table-responsive  
                      %table.table.table-striped.usuarios.no-margin{class: ('users' unless @objetivo.nil? || @objetivo.size <= 0)}
                        = hidden_field_tag 'flujo_id', @tarea_pendiente.id, id: 'flujo_id'
                        %thead
                          %tr
                            %td.sub-contenido-popup-form Nombre
                            %td.sub-contenido-popup-form HH en la actividad Propios
                        %tbody
          .modal-footer
            %button.btn.btn-secondary{"data-dismiss" => "modal"} Cerrar
            = button_to 'Continuar', '#', class: 'btn btn-primary', onclick: 'guardarObjetivo(); return false;'
            
-# POPUP BUSCAR CONTRIBUYENTE
- custom_id = custom_id.blank? ? nil : custom_id
- data_table = data_table.nil? ? true : data_table
- es_maquinaria = es_maquinaria.blank? ? false : es_maquinaria
- es_para_seleccion = es_para_seleccion.blank? ? false : es_para_seleccion
- seleccion_basica = seleccion_basica.nil? ? false : seleccion_basica
- buscar_por_actividad_economica = buscar_por_actividad_economica.blank? ? false : buscar_por_actividad_economica
- resultado_mostrados = resultado_mostrados.nil? ? 30 : resultado_mostrados
- tipo_instrumento = tipo_instrumento.nil? ? TipoInstrumento::PPP_EJECUTADOS_POR_TERCEROS : tipo_instrumento
- solo_tabla = solo_tabla.nil? ? false : solo_tabla
- lista_contribuyentes = lista_contribuyentes.nil? ? (@contribuyentes.nil? ? [] : @contribuyentes) : lista_contribuyentes
.modal.fade{id: :"buscar-contribuyente", tabindex: "-1", role: :dialog, "aria-labelledby": :buscarContribuyenteLabel, "aria-hidden": true}
  .modal-dialog.modal-dialog-centered.modal-lg.modal-lg-fix.animated{role: :document}
    .modal-content
      .modal-body
        .container-fluid{id: "body-contribuyente-buscador"}
          =render 'fondo_produccion_limpias/contribuyentes/buscador_form', custom_id: custom_id, data_table: data_table, es_maquinaria: es_maquinaria, es_para_seleccion: es_para_seleccion, seleccion_basica: seleccion_basica, buscar_por_actividad_economica: buscar_por_actividad_economica, resultado_mostrados: resultado_mostrados, tipo_instrumento: tipo_instrumento, solo_tabla: solo_tabla, lista_contribuyentes: lista_contribuyentes
      .modal-footer
        %button.btn.btn-secondary{type: :button, "data-dismiss"=>:modal}
          Cerrar
  =yield
- ue =  @manifestacion_de_interes.ubicacion_exacta.blank? ? [] : @manifestacion_de_interes.ubicacion_exacta.split(",")
:javascript  

  if(#{!solo_lectura}){
    function display_descarga(){
      selector = $("#manifestacion_de_interes_estandar_de_certificacion_id");
      if(selector.val() == ""){
        $(".estandar_de_homologacion_descarga").parent().children().attr("style","display: none");
      }else{
        $(".estandar_de_homologacion_descarga").parent().children().attr("style","display: block");
        $(".estandar_de_homologacion_descarga").attr("href","/manifestacion-de-interes/#{@tarea_pendiente.id}/#{@manifestacion_de_interes.id}/documentos-diagnosticos/descarga_estandar_acuerdo_informe?estandar_id="+selector.val());    
      };
    };

    display_descarga();
    $("#manifestacion_de_interes_estandar_de_certificacion_id").on('change', function(){
      display_descarga();
      if($(this).val()!=""){
        $(".estandar_de_homologacion_descarga").attr("href","/manifestacion-de-interes/#{@tarea_pendiente.id}/#{@manifestacion_de_interes.id}/documentos-diagnosticos/descarga_estandar_acuerdo_informe?estandar_id="+$(this).val());
      }
    });

    function display_descarga_diagnostico(){
      selector = $("#manifestacion_de_interes_diagnostico_id");
      if(selector.val() == ""){
        $(".diagnostico_id_descarga").parent().children().addClass("d-none");
      }else{
        $(".diagnostico_id_descarga").parent().children().removeClass("d-none");
        $(".diagnostico_id_descarga").attr("href","/manifestacion-de-interes/#{@tarea_pendiente.id}/#{@manifestacion_de_interes.id}/documentos-diagnosticos/descarga_estandar_acuerdo_informe?acuerdo_id="+selector.val());    
      };
    };

    display_descarga_diagnostico();
    $("#manifestacion_de_interes_diagnostico_id").on('change', function(){
      display_descarga_diagnostico();
      if($(this).val()!=""){
        $(".diagnostico_id_descarga").attr("href","/manifestacion-de-interes/#{@tarea_pendiente.id}/#{@manifestacion_de_interes.id}/documentos-diagnosticos/descarga_estandar_acuerdo_informe?acuerdo_id="+$(this).val());
      }
    });

    function display_descarga_informe_impacto(){
      selector = $("#manifestacion_de_interes_acuerdo_previo_con_informe_id");
      if(selector.val() == ""){
        $(".informe_impacto_id_descarga").parent().children().addClass("d-none");
      }else{
        $(".informe_impacto_id_descarga").parent().children().removeClass("d-none");  
        $(".informe_impacto_id_descarga").attr("href","/manifestacion-de-interes/#{@tarea_pendiente.id}/#{@manifestacion_de_interes.id}/documentos-diagnosticos/descarga_estandar_acuerdo_informe?informe_id="+selector.val());  
      };
    };

    display_descarga_informe_impacto();
    $("#manifestacion_de_interes_acuerdo_previo_con_informe_id").on('change', function(){
      display_descarga_informe_impacto();
      if($(this).val()!=""){
        $(".informe_impacto_id_descarga").attr("href","/manifestacion-de-interes/#{@tarea_pendiente.id}/#{@manifestacion_de_interes.id}/documentos-diagnosticos/descarga_estandar_acuerdo_informe?informe_id="+$(this).val());
      }
    });
  }else{}

  activa_validaciones();


  $(document).ready(function() {

    $('.acuerdo_alcance_nacional').change(function(){
      if(this.value == 'true'){
        $('#si_acuerdo_alcance').hide(1200);
      }else{
        $('#si_acuerdo_alcance').show(1200);
      }
    });

    $('.parent-checkbox').on('click', function() {
      ancestorBlock=$(this).parent();
      childControl=ancestorBlock.children('i[class^="fa"]');
      if((this).checked){
        childGroup=ancestorBlock.children('.group-hide');
      }else{
        childGroup=ancestorBlock.children('.group-show');
        $(this).siblings('ul').find("input[type='checkbox']").prop('checked', this.checked);
      }
      __show_hide_(childGroup,childControl);
    });

    $('.p-chevron').on('click', function(){
      ancestorBlock=$(this).parent().parent().parent();
      childGroup=ancestorBlock.children('.ae-subgroup');
      childControl=$(this).children('.fa');
        __show_hide_(childGroup,childControl);      
    });

    init_coordenadas_territorios();

    document_ready = true;
    if(typeof google != "undefined"){
      mapLoaded();
    }
  });

  //FUNCIONES MODAL BUSCAR USUARIO
  $(document).on('change','#tabla_usuarios_buscar-usuario .usuario-radio',function() {
    //alert("FUNCIONES MODAL BUSCAR USUARIO");
    $('#buscar-usuario .seleccionar-usuario-button').removeAttr('disabled');
    $('#buscar-usuario .seleccionar-y-actualizar-usuario-fpl-button').removeAttr('disabled');
  });

  $(document).on('click','#nuevo-usuario-fpl-button', function(e){
    e.preventDefault();
    var tipo_equipo = $('#tipo_equipo').val();
    //alert("nuevo-usuario-fpl-button "+ tipo_equipo);
    $.ajax({
      url: "#{insert_fondo_produccion_limpia_path}",
      type: "POST",
      data: {
        id: #{@tarea_pendiente.id},
        flujo_id: "#{@manifestacion_de_interes.nil? ? '' : @manifestacion_de_interes.flujo.id}",
        tipo_equipo: tipo_equipo,
        estado: 'new'
      }
    }).fail(function(a, b, c) {
      alert( "Error: Verifique su conexión a internet y vuelva a intentar" );
      $('.loading-data').hide();
    }).success(function(data){
      $('#buscar-usuario .body-usuario-buscador').html(data);
      $('.loading-data').hide();
    });
  });

  $(document).on('change keyup', '.form-temporal-boton-guardar-fpl-usuario', function(){
    nuevo_usuario_temporal_fpl_validaciones();
  });

  $(document).on('click', '.seleccionar-y-actualizar-usuario-fpl-button', function(){
    var radioSeleccionado = document.querySelector('input[name="usuario_buscar-usuario"]:checked');
    var valorSeleccionado = radioSeleccionado.value;
    data=JSON.parse(valorSeleccionado);
    var tipo_equipo = $('#tipo_equipo').val();
    $('.loading-data').show();
    $.ajax({
      url: "#{edit_modal_fondo_produccion_limpia_path}",
      type: "GET",
      data: {
        id: data.id,
        flujo_id: "#{@manifestacion_de_interes.nil? ? '' : @manifestacion_de_interes.flujo.id}",
        user_id: data.id,
        tipo_equipo: tipo_equipo,
        estado: 'update'
      }
    }).fail(function(a, b, c) {
      //alert( "Error: Verifique su conexión a internet y vuelva a intentar" );
      alert( "El usuario seleccionado ya se encuentra asociado al listado de consultores" );
      $('.loading-data').hide();
    }).success(function(data){
      //alert(data);
      $('#buscar-usuario .body-usuario-buscador').html(data);
      $('.loading-data').hide();
    });

    /*$.ajax({
      type: 'GET',
      url: '#{edit_modal_fondo_produccion_limpia_path}',
      data: {
        id: data.id,
        flujo_id: "#{@manifestacion_de_interes.nil? ? '' : @manifestacion_de_interes.flujo.id}",
        user_id: data.id,
        tipo_equipo: tipo_equipo
        },
      dataType: 'json',
      success: function(response) {
        //alert(response.success);
        if (response.success) {
          // Equipo guardado correctamente
          $('#buscar-usuario .body-usuario-buscador').html(data);
          $('.loading-data').hide();
        }
      },
      error: function(xhr, status, error) {
        alert( "Error" );
      }
    });*/
  });

  $(document).on('click','#deshacer-usuario-fpl-button', function(e){
    e.preventDefault();    
    $('#buscar-usuario .body-usuario-buscador').html("#{j render 'fondo_produccion_limpias/buscador_form'}");
  });

  function nuevo_usuario_temporal_fpl_validaciones(){
    //alert('nuevo_usuario_temporal_fpl_validaciones');
    var rut = $('#user_rut').val() != "";
    var nombre_completo = $('#user_nombre_completo').val() != "";
    var email = $('#user_email').val() != "";
    var telefono = $('#user_telefono').val() != "";
    //alert(rut);
    //alert(nombre_completo);
    //alert(email);
    //alert(telefono);
    if(rut && nombre_completo && email && telefono){
      $('.guarda-usuario-fpl-button').removeAttr("disabled");
    }else{
      $('.guarda-usuario-fpl-button').attr("disabled", true);
    }
  }

  $(document).on('change keyup', '.form-temporal-boton-equipo-trabajo-fpl-usuario', function(){
    nuevo_equipo_trabajo_fpl_validaciones();
  });

  function nuevo_equipo_trabajo_fpl_validaciones(){
    $('.guarda-equipo-fpl-button').removeAttr("disabled");
    /*var rut = $('#user_rut').val() != "";
    var nombre_completo = $('#user_nombre_completo').val() != "";
    var email = $('#user_email').val() != "";
    var telefono = $('#user_telefono').val() != "";
    if(rut && nombre_completo && email && telefono){
      $('.guarda-equipo-fpl-button').removeAttr("disabled");
    }else{
      $('.guarda-equipo-fpl-button').attr("disabled", true);
    }*/
  }

  $('body').on('change','.contribuyente-radio',function() {
    //alert('checkeado xxx');
    $('.seleccionar-contribuyente-fpl-button').removeAttr('disabled'); 
  });

  $('.seleccionar-contribuyente-fpl-button').click(function() {
    //alert('entro seleccionar-contribuyente-fpl-button');
    data=JSON.parse($('table.contribuyentes').DataTable().$('.contribuyente-radio:checked').val());
    //alert(data.id);

    //var radioSeleccionado = document.querySelector('input[name="usuario_buscar-usuario"]:checked');
    //var valorSeleccionado = radioSeleccionado.value;
    //data=JSON.parse(valorSeleccionado);
    $.ajax({
      url: "#{insert_modal_contribuyente_fondo_produccion_limpia_path}",
      type: "POST",
      data: {
        id: data.id,
        flujo_id: "#{@manifestacion_de_interes.nil? ? '' : @manifestacion_de_interes.flujo.id}"
      }
    }).fail(function(a, b, c) {
      alert( "El contribuyente seleccionado ya se encuentra asociado al proyecto" );
      $('.loading-data').hide();
    }).success(function(data){
      //alert(data);
      $('#buscar-contribuyente .body-contribuyente-buscador').html(data);
      $('#buscar-contribuyente').modal('hide');
      $('.loading-data').hide();
    });
  }); 

   $('#muestra_espera').click(function(){
    alert('entro espera');
    $('.loading-data').show();
  });